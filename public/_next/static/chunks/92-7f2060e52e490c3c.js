"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[92],{30092:function(e,t,n){n.d(t,{S:function(){return DeploymentList}});var a=n(59499),l=n(16835),i=n(48689),r=n(84213),o=n(78957),d=n(86738),u=n(73318),c=n(66309),s=n(83062),v=n(71471),m=n(44973),p=n(27484),f=n.n(p),g=n(96486),x=n(41664),h=n.n(x),y=n(67294),j=n(47859),b=n(11778),S=n(61123),w=n(90447),O=n(56832),k=n(3669),R=n(85893);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){(0,a.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var I=n(56176),Z=n(84110);f().extend(Z),f().extend(I);var DeploymentList=function(e){var t=(0,k.Jl)().responsive,n=(0,O.o)(),a=(0,l.Z)(n,2),p=a[0],x=a[1].setQuery;p.namespace,p.cluster;var I=(0,j.x7)(),Z=I.data;I.status;var C=(Z||{}).list,A=(0,y.useState)(0),P=A[0],_=A[1],D=(0,y.useState)(1),F=(D[0],D[1]),T=(0,b.wz)(["monitor-deployment","list"],"/api/v1/monitor/deployments",{filter:p}),N=T.data,E=T.status,M=N||{},z=M.list;void 0===(M.pagination||{}).total_items&&(null==z||z.length);var H=(0,b.TV)(["monitor-deployment","delete"],"/api/v1/monitor/deployments",void 0),K=(0,l.Z)(H,2),L=K[0];K[1];var onTableChange=function(e,t){var n,a,l=e.current;_(null!==(n=null===(a=t.currentDataSource)||void 0===a?void 0:a.length)&&void 0!==n?n:0),l&&F(l)};(0,y.useEffect)(function(){var e;return _(null!==(e=null==z?void 0:z.length)&&void 0!==e?e:0)},[z]);var V=(null==z?void 0:z.map(function(e,t){return _objectSpread(_objectSpread({},e),{},{key:"ns-".concat(t),actions:(0,R.jsx)(o.Z.Compact,{children:(0,R.jsx)(d.Z,{title:"Are you sure to delete this item?",description:(0,R.jsx)("span",{className:"text-red-500",children:"Caution: this is permanent and cannot be rolled back."}),onConfirm:function(){var t,n;return L({cluster:e.cluster,namespace:null===(t=e.metadata)||void 0===t?void 0:t.namespace,name:null===(n=e.metadata)||void 0===n?void 0:n.name})},okText:"Yes",cancelText:"No",children:(0,R.jsx)(u.ZP,{icon:(0,R.jsx)(i.Z,{})})})})})}))||[],q=null==z?void 0:z.map(function(e){var t,n;return{text:(null===(t=e.metadata)||void 0===t?void 0:t.name)||"",value:(null===(n=e.metadata)||void 0===n?void 0:n.name)||""}}).filter(function(e){return""!==e.value}).filter(function(e,t,n){return t===n.findIndex(function(t){return t.text===e.text})}),J=null==z?void 0:z.map(function(e){var t,n;return{text:(null===(t=e.metadata)||void 0===t?void 0:t.namespace)||"",value:(null===(n=e.metadata)||void 0===n?void 0:n.namespace)||""}}).filter(function(e){return""!==e.value}).filter(function(e,t,n){return t===n.findIndex(function(t){return t.text===e.text})}),Q=[{title:"Name",width:60,dataIndex:"name",key:"name",fixed:null!=t&&t.md?"left":void 0,filterSearch:!0,render:function(e,t){var n;return null===(n=t.metadata)||void 0===n?void 0:n.name},filters:q,onFilter:function(e,t){var n,a;return null===(n=t.metadata)||void 0===n||!n.name||(null===(a=t.metadata)||void 0===a?void 0:a.name.indexOf(e.toString()))>-1}},{title:"Pods",dataIndex:"pods",key:"pods",width:15,render:function(e,t){var n,a,l,i,r,o,d,u,s,v,m=null!==(n=null!==(a=null===(l=t.status)||void 0===l?void 0:l.availableReplicas)&&void 0!==a?a:null===(i=t.status)||void 0===i?void 0:i.readyReplicas)&&void 0!==n?n:(null!==(r=null===(o=t.status)||void 0===o?void 0:o.replicas)&&void 0!==r?r:0)-(null!==(d=null===(u=t.status)||void 0===u?void 0:u.unavailableReplicas)&&void 0!==d?d:0),p=null!==(s=null===(v=t.status)||void 0===v?void 0:v.replicas)&&void 0!==s?s:0;return(0,R.jsxs)(c.Z,{color:0===m?"error":m<p?"warning":"default",children:[m,"/",p]})},filterSearch:!0,filters:[{text:"Ready",value:"ready"},{text:"Partial",value:"partial"},{text:"Failed",value:"failed"}],onFilter:function(e,t){var n,a,l,i,r,o,d,u,c,s,v=null!==(n=null!==(a=null===(l=t.status)||void 0===l?void 0:l.availableReplicas)&&void 0!==a?a:null===(i=t.status)||void 0===i?void 0:i.readyReplicas)&&void 0!==n?n:(null!==(r=null===(o=t.status)||void 0===o?void 0:o.replicas)&&void 0!==r?r:0)-(null!==(d=null===(u=t.status)||void 0===u?void 0:u.unavailableReplicas)&&void 0!==d?d:0),m=null!==(c=null===(s=t.status)||void 0===s?void 0:s.replicas)&&void 0!==c?c:0;return"failed"===e?0===v:"partial"===e?v>0&&v<m:v===m},sorter:function(e,t){var n,a,l,i,r,o,d,u,c,s,v,m,p,f,g,x;return(null!==(n=null!==(a=null===(l=e.status)||void 0===l?void 0:l.availableReplicas)&&void 0!==a?a:null===(i=e.status)||void 0===i?void 0:i.readyReplicas)&&void 0!==n?n:(null!==(r=null===(o=e.status)||void 0===o?void 0:o.replicas)&&void 0!==r?r:0)-(null!==(d=null===(u=e.status)||void 0===u?void 0:u.unavailableReplicas)&&void 0!==d?d:0))-(null!==(c=null!==(s=null===(v=t.status)||void 0===v?void 0:v.availableReplicas)&&void 0!==s?s:null===(m=t.status)||void 0===m?void 0:m.readyReplicas)&&void 0!==c?c:(null!==(p=null===(f=t.status)||void 0===f?void 0:f.replicas)&&void 0!==p?p:0)-(null!==(g=null===(x=t.status)||void 0===x?void 0:x.unavailableReplicas)&&void 0!==g?g:0))}},{title:"CPU",dataIndex:"cpu",key:"cpu",width:17,render:function(e,t){var n,a,l=(0,g.toInteger)(null===(n=t.cpuAvg)||void 0===n?void 0:n.replace("m",""))||0,i=(0,g.toInteger)(null===(a=t.cpuCapacity)||void 0===a?void 0:a.replace("m",""))||0;return 0===i?(0,R.jsx)(s.Z,{overlay:(0,R.jsxs)(R.Fragment,{children:["Recommend: ",t.cpuRecommend]}),children:(0,R.jsx)(c.Z,{color:0===i?"default":l>.8*i?"warning":"success",children:t.cpuAvg})}):(0,R.jsx)(c.Z,{color:0===i?"default":l>.8*i?"warning":"success",children:t.cpuAvg})},sorter:function(e,t){var n,a;return(0,g.toInteger)(null===(n=e.cpuAvg)||void 0===n?void 0:n.replace("m",""))-(0,g.toInteger)(null===(a=t.cpuAvg)||void 0===a?void 0:a.replace("m",""))}},{title:"MEM",dataIndex:"memory",key:"memory",width:17,render:function(e,t){var n,a,l=(0,g.toInteger)(null===(n=t.memoryAvg)||void 0===n?void 0:n.replace("Mi",""))||0,i=(0,g.toInteger)(null===(a=t.memoryCapacity)||void 0===a?void 0:a.replace("Mi",""))||0;return 0===i?(0,R.jsx)(s.Z,{overlay:(0,R.jsxs)(R.Fragment,{children:["Recommend: ",t.memoryRecommend]}),children:(0,R.jsx)(c.Z,{color:0===i?"default":l>.8*i?"warning":"success",children:t.memoryAvg})}):(0,R.jsx)(c.Z,{color:0===i?"default":l>.8*i?"warning":"success",children:t.memoryAvg})},sorter:function(e,t){var n,a;return(0,g.toInteger)(null===(n=e.memoryAvg)||void 0===n?void 0:n.replace("Mi",""))-(0,g.toInteger)(null===(a=t.memoryAvg)||void 0===a?void 0:a.replace("Mi",""))}},{title:"Namespace",dataIndex:"namespace",key:"namespace",width:30,render:function(e,t){var n;return(0,R.jsx)(h(),{href:"#",onClick:function(e){var n;e.preventDefault(),x(_objectSpread(_objectSpread({},p),{},{namespace:null===(n=t.metadata)||void 0===n?void 0:n.namespace}))},children:null===(n=t.metadata)||void 0===n?void 0:n.namespace})},filterSearch:!0,filters:J,onFilter:function(e,t){var n,a;return null===(n=t.metadata)||void 0===n||!n.namespace||(null===(a=t.metadata)||void 0===a?void 0:a.namespace.indexOf(e.toString()))>-1}},{title:"Cluster",dataIndex:"clusterSlug",key:"clusterSlug",width:30,render:function(e){return(0,R.jsx)(h(),{href:"#",onClick:function(t){t.preventDefault(),x(_objectSpread(_objectSpread({},p),{},{cluster:e}))},children:e})},filterSearch:!0,filters:(void 0===C?[]:C).map(function(e){return{text:e.slug||"",value:e.slug||""}}),onFilter:function(e,t){return!t.clusterSlug||t.clusterSlug.indexOf(e.toString())>-1}},{title:"Created at",dataIndex:"createdAt",key:"createdAt",width:30,render:function(e,t){var n;return(0,R.jsx)(S.q,{date:null===(n=t.metadata)||void 0===n?void 0:n.creationTimestamp})},sorter:function(e,t){var n,a;return f()(null===(n=e.metadata)||void 0===n?void 0:n.creationTimestamp).diff(f()(null===(a=t.metadata)||void 0===a?void 0:a.creationTimestamp))}},{title:(0,R.jsx)(v.Z.Text,{className:"text-xs md:text-sm",children:"Action"}),key:"action",fixed:"right",width:(null!=t&&t.md,12),render:function(e,t){return t.actions}}],U=(0,y.useRef)(null),W=(0,r.Z)(U),Y=null!=e&&e.autoHeight?"flex-auto h-auto":"h-full flex-auto overflow-hidden",B=null!=e&&e.autoHeight?void 0:void 0!==(null==W?void 0:W.height)?W.height-140:void 0;return(0,R.jsxs)(R.Fragment,{children:[null!=e&&e.hideHeader?(0,R.jsx)(R.Fragment,{}):(0,R.jsx)(w.V,{title:"Deployments (".concat(P,")"),breadcrumbs:[{name:"Workspace"}],actions:[]}),(0,R.jsx)("div",{className:Y,ref:U,children:(0,R.jsx)(m.Z,{sticky:!0,loading:"loading"===E,size:"small",columns:Q,dataSource:V,scroll:{x:1e3,y:B},pagination:{pageSize:200,position:["bottomCenter"],hideOnSinglePage:!0},onChange:function(e,t,n,a){return onTableChange(e,a)}})})]})}}}]);