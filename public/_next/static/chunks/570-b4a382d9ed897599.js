(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[570],{10891:function(e,t,n){"use strict";n.d(t,{Bm:function(){return o},VD:function(){return s},XS:function(){return r},_M:function(){return l},im:function(){return i}});var a=n(83360);let s=e=>(0,a.wz)(["apps","list"],"/api/v1/app",e),i=(e,t)=>(0,a.AQ)(["apps",e],"/api/v1/app",e,t),l=()=>(0,a.TV)(["apps","delete"],"/api/v1/app"),r=e=>(0,a.FF)(["env_vars"],"/api/v1/app/environment/variables",e),o=e=>(0,a.TV)(["env_vars","delete"],"/api/v1/app/environment/variables",e)},66109:function(e,t,n){"use strict";n.d(t,{Wk:function(){return y},aC:function(){return j},x4:function(){return x}});var a=n(11527),s=n(31604),i=n(18116),l=n(19173),r=n(39502),o=n(33117),c=n(46998),u=n(32699),d=n(95954),m=n(50959),p=n(76780),g=n(32365),h=n(70038),v=n(74883);let x=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=null!==(e=t.redirectURL)&&void 0!==e?e:v.De.NEXT_PUBLIC_API_BASE_URL;window.location.href="".concat(v.De.NEXT_PUBLIC_API_BASE_URL,"/auth/google?redirect_url=").concat(n)},f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{access_token:t=(0,c.getCookie)("x-auth-cookie")}=e,n=(0,d.useRouter)();return(0,i.a)({staleTime:3e5,queryKey:["auth"],queryFn:async()=>{var e;let a=new URLSearchParams(n.asPath.split("?")[1]),s=Object.fromEntries(a),{access_token:i}=s,l=null!==(e=null!=t?t:(0,c.getCookie)("x-auth-cookie"))&&void 0!==e?e:i,{data:r}=await o.Z.get("".concat(v.De.NEXT_PUBLIC_API_BASE_URL,"/auth/profile"),{headers:l?{Authorization:"Bearer ".concat(l)}:{}});return r}})},j=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{redirectUrl:t}=e,n=(0,d.useRouter)(),[a]=(0,g.o)(),{access_token:s=(0,c.getCookie)("x-auth-cookie")}=a;s&&(0,c.setCookie)("x-auth-cookie",s);let{data:i,isError:r,isFetched:o,isLoading:u,isSuccess:p}=f({access_token:s}),{status:h,data:v}=i||{},x=(0,l.NL)(),j=async()=>{await x.invalidateQueries({queryKey:["auth"]})};return(0,m.useEffect)(()=>{void 0!==h&&!1!==o&&setTimeout(()=>{let e=(0,c.getCookie)("x-auth-cookie");e&&h?j():n.push(t?"/login?redirect_url=".concat(t):"/login")},200)},[h]),[v,{reload:j,isError:r,isLoading:u,isFetched:o,isSuccess:p,status:h}]},y=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{children:n}=t;(0,d.useRouter)();let[i,{isLoading:l,isFetched:o}]=j(),{workspaces:c=[]}=i||{},m=null===(e=c[0])||void 0===e?void 0:e.slug,g=(0,h.c)({name:m});return l?(0,a.jsxs)(p.Z,{children:[(0,a.jsx)(s.Z,{}),(0,a.jsx)("span",{className:"ml-2",children:"Loading..."})]}):o&&(0,u.isEmpty)(i)?(0,a.jsx)(a.Fragment,{}):g?(0,a.jsx)(a.Fragment,{children:n}):(0,a.jsx)(p.Z,{className:"text-center",children:(0,a.jsx)(r.Z,{message:"Error",description:"This workspace does not exists.",type:"error"})})}},46734:function(e,t,n){"use strict";n.d(t,{BY:function(){return s},fg:function(){return l},tx:function(){return i}});var a=n(83360);let s=e=>(0,a.wz)(["builds","list"],"/api/v1/build",e),i=(e,t)=>(0,a.AQ)(["builds",e],"/api/v1/build",e,t),l=e=>(0,a.yt)(["builds","stop"],"/api/v1/build/stop",e)},50939:function(e,t,n){"use strict";n.d(t,{nu:function(){return s}});var a=n(83360);let s=e=>(0,a.wz)(["providers","list"],"/api/v1/provider",e)},19723:function(e,t,n){"use strict";n.d(t,{An:function(){return o},CN:function(){return l},pD:function(){return i},ve:function(){return r},x7:function(){return s}});var a=n(83360);let s=e=>(0,a.wz)(["clusters","list"],"/api/v1/cluster",e),i=(e,t)=>(0,a.AQ)(["cluster",e],"/api/v1/cluster",e,t),l=()=>(0,a.FF)(["clusters","create"],"/api/v1/cluster"),r=e=>(0,a.yt)(["clusters","update"],"/api/v1/cluster",e),o=()=>(0,a.TV)(["clusters","delete"],"/api/v1/cluster")},73638:function(e,t,n){"use strict";n.d(t,{D$:function(){return l},Dh:function(){return s},FX:function(){return i},fR:function(){return r},mt:function(){return o}});var a=n(83360);let s=e=>(0,a.wz)(["frameworks","list"],"/api/v1/framework",e),i=(e,t)=>(0,a.AQ)(["frameworks",e],"/api/v1/framework",e,t),l=()=>(0,a.FF)(["frameworks"],"/api/v1/framework"),r=e=>(0,a.yt)(["frameworks"],"/api/v1/framework",e),o=()=>(0,a.TV)(["frameworks","delete"],"/api/v1/framework")},95019:function(e,t,n){"use strict";n.d(t,{CX:function(){return o},Ve:function(){return r},o0:function(){return i},xP:function(){return l},y3:function(){return s}});var a=n(83360);let s=e=>(0,a.wz)(["gits","list"],"/api/v1/git",e),i=(e,t)=>(0,a.AQ)(["gits",e],"/api/v1/git",e,t),l=e=>(0,a.FF)(["gits"],"/api/v1/git",e),r=e=>(0,a.yt)(["gits"],"/api/v1/git",e),o=()=>(0,a.TV)(["gits"],"/api/v1/git")},79515:function(e,t,n){"use strict";n.d(t,{Bl:function(){return l},EL:function(){return i},Xn:function(){return r},Y4:function(){return o},fy:function(){return s}});var a=n(83360);let s=e=>(0,a.wz)(["registries","list"],"/api/v1/registry",e),i=(e,t)=>(0,a.AQ)(["registries",e],"/api/v1/registry",e,t),l=e=>(0,a.FF)(["registries"],"/api/v1/registry",e),r=e=>(0,a.yt)(["registries"],"/api/v1/registry",e),o=()=>(0,a.TV)(["registries"],"/api/v1/registry")},66830:function(e,t,n){"use strict";n.d(t,{av:function(){return i},xh:function(){return s}});var a=n(83360);let s=(e,t)=>(0,a.AQ)(["workspaces",e],"/api/v1/workspace",e,t),i=e=>(0,a.FF)(["workspaces"],"/api/v1/workspace",e)},83360:function(e,t,n){"use strict";n.d(t,{AQ:function(){return g},FF:function(){return h},TV:function(){return x},wz:function(){return p},yt:function(){return v}});var a=n(19173),s=n(18116),i=n(37152),l=n(74186),r=n(33117),o=n(46998),c=n(32699),u=n(95954),d=n(74883);let{useApp:m}=l.Z,p=function(e,t){var n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=m(),p=(0,u.useRouter)(),g=null!==(n=p.query.access_token)&&void 0!==n?n:(0,o.getCookie)("x-auth-cookie"),h=g?{Authorization:"Bearer ".concat(g)}:{};h["Cache-Control"]="no-cache";let{pagination:v={page:1,size:20},populate:x,filter:f,sort:j="-updatedAt,-createdAt"}=i,y=new URLSearchParams(v).toString(),b=x?"populate=".concat(x):"",w=f?new URLSearchParams(f).toString():"",k="sort=".concat(j),Z=(0,a.NL)(),C=[...e];return C.push((0,c.isEmpty)(f)?{}:f),(0,c.isEmpty)(v)||C.push(v),(0,s.a)({refetchOnWindowFocus:!1,queryKey:C,staleTime:null==i?void 0:i.staleTime,queryFn:async()=>{var n,a;let{data:s}=await r.Z.get("".concat(d.De.NEXT_PUBLIC_API_BASE_URL).concat(t,"?").concat(w,"&").concat(k,"&").concat(b,"&").concat(y),{...i,headers:h});s.status||(0,c.isEmpty)(s.messages)||s.messages.map(e=>l.notification.error({message:e}));let{current_page:u,total_pages:m,total_items:p,page_size:g,next_page:v,prev_page:x,...f}=s;return(null===(n=s.token)||void 0===n?void 0:n.access_token)&&(0,o.setCookie)("x-auth-cookie",null===(a=s.token)||void 0===a?void 0:a.access_token),{list:s.data.map(t=>(Z.setQueryData([e[0],t._id],t),Z.setQueryData([e[0],t.slug],t),Z.setQueryData([e[0],{slug:t.slug}],t),{...t,key:t._id}))||[],pagination:{current_page:u,total_pages:m,total_items:p,page_size:g,next_page:v,prev_page:x},messages:s.messages,status:s.status}}})},g=function(e,t,n){var a;let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=m(),p=(0,u.useRouter)(),g=null!==(a=p.query.access_token)&&void 0!==a?a:(0,o.getCookie)("x-auth-cookie"),h=g?{Authorization:"Bearer ".concat(g)}:{};h["Cache-Control"]="no-cache";let{populate:v,filter:x={}}=i;x.slug=n;let f=v?"populate=".concat(v):"",j=new URLSearchParams(x).toString();return(0,s.a)({enabled:null!=n,queryKey:e,staleTime:null==i?void 0:i.staleTime,queryFn:async()=>{var e,n;let a="".concat(d.De.NEXT_PUBLIC_API_BASE_URL).concat(t,"?").concat(j,"&").concat(f),{data:s}=await r.Z.get(a,{...i,headers:h});return(s.status||(0,c.isEmpty)(s.messages)||s.messages.map(e=>l.notification.error({message:"Failed.",description:e})),(null===(e=s.token)||void 0===e?void 0:e.access_token)&&(0,o.setCookie)("x-auth-cookie",null===(n=s.token)||void 0===n?void 0:n.access_token),(0,c.isArray)(s.data))?s.data.map(e=>({...e,key:e._id}))[0]:(0,c.isString)(s.data)?{status:s.status,data:s.data,messages:s.messages}:{status:s.status,data:s.data[0],messages:s.messages}}})},h=function(e,t){var n;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=m(),p=(0,u.useRouter)(),g=(0,a.NL)(),h=null!==(n=p.query.access_token)&&void 0!==n?n:(0,o.getCookie)("x-auth-cookie"),v=h?{Authorization:"Bearer ".concat(h)}:{};v["Cache-Control"]="no-cache";let{populate:x,sort:f,pagination:j,filter:y}=s,b=y?"".concat(new URLSearchParams(y).toString(),"&"):"",w="".concat(d.De.NEXT_PUBLIC_API_BASE_URL).concat(t,"?").concat(b).concat(x?"populate=".concat(x):""),k=(0,i.D)({mutationFn:async e=>{let{data:t}=await r.Z.post(w,e,{...s,headers:v});return t.status||((0,c.isEmpty)(t.messages)?l.notification.error({message:"Something is wrong..."}):t.messages.map(e=>l.notification.error({message:"Failed.",description:e}))),t},onMutate:async t=>(await g.cancelQueries({queryKey:e}),t),onSuccess:(t,n,a)=>{g.invalidateQueries({queryKey:[e[0],"list"]}),g.invalidateQueries({queryKey:[e[0],null==t?void 0:t.slug]})}}),{mutateAsync:Z,status:C}=k;return[Z,C]},v=function(e,t){var n;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=m(),p=(0,u.useRouter)(),g=(0,a.NL)(),h=null!==(n=p.query.access_token)&&void 0!==n?n:(0,o.getCookie)("x-auth-cookie"),v=h?{Authorization:"Bearer ".concat(h)}:{};v["Cache-Control"]="no-cache";let{pagination:x={page:1,size:20},populate:f,sort:j="-createdAt",filter:y}=s,b=y?"".concat(new URLSearchParams(y).toString(),"&"):"",w=new URLSearchParams(x).toString(),k="".concat(d.De.NEXT_PUBLIC_API_BASE_URL).concat(t,"?").concat(b).concat("sort=".concat(j,"&")).concat(f?"populate=".concat(f,"&"):"").concat(w),Z=(0,i.D)({mutationFn:async e=>{let{data:t}=await r.Z.patch(k,e,{...s,headers:v});return t.status||((0,c.isEmpty)(t.messages)?l.notification.error({message:"Something is wrong..."}):t.messages.map(e=>l.notification.error({message:"Failed.",description:e}))),t},onSuccess:(t,n,a)=>{g.invalidateQueries({queryKey:[e[0],"list"]})}});return[Z.mutateAsync,Z.status]},x=function(e,t){var n;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=m(),p=(0,u.useRouter)(),g=(0,a.NL)(),h=null!==(n=p.query.access_token)&&void 0!==n?n:(0,o.getCookie)("x-auth-cookie"),v=h?{Authorization:"Bearer ".concat(h)}:{};v["Cache-Control"]="no-cache";let{filter:x}=s,f=x?"".concat(new URLSearchParams(x).toString()):"",j="".concat(d.De.NEXT_PUBLIC_API_BASE_URL).concat(t,"?").concat(f),y=(0,i.D)({mutationFn:async e=>{let{data:t}=await r.Z.delete(j,{...s,headers:v,data:e});return t.status||((0,c.isEmpty)(t.messages)?l.notification.error({message:"Something is wrong..."}):t.messages.map(e=>l.notification.error({message:"Failed.",description:e}))),t},onSuccess:t=>(g.invalidateQueries({queryKey:[e[0],"list"]}),t)}),{mutateAsync:b,status:w}=y;return[b,w]}},76780:function(e,t,n){"use strict";var a=n(11527);let s=e=>(0,a.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 ".concat(e.className),children:e.children});t.Z=s},1830:function(e,t,n){"use strict";n.d(t,{q:function(){return c}});var a=n(11527),s=n(14354),i=n(74637),l=n.n(i);n(50959);let r=n(64814),o=n(54498);l().extend(o),l().extend(r);let c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{date:t}=e;return(0,a.jsx)(s.Z,{title:l()(t).format("LLL"),children:(0,a.jsx)("span",{children:t?l()(t).fromNow():"-"})})}},3006:function(e,t,n){"use strict";n.d(t,{O:function(){return k}});var a=n(11527),s=n(31604),i=n(74761),l=n(515),r=n(76263),o=n(74637),c=n.n(o),u=n(14383),d=n(32699),m=n(50959),p=n(55282),g=n.n(p),h=n(15444),v=n.n(h),x=n(46734),f=n(32365);n(74883);let j=n(33939),y=n(64814),b=n(54498);c().extend(b),c().extend(y);let w=e=>g()("".concat(e).replace(/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/g,"")),k=e=>{let{slug:t}=e,[n]=(0,f.o)(),{build_slug:o}=n,{data:c}=(0,x.tx)(o),p=(null==c?void 0:c.logs)||"",g=w(p),h=g.split("\n").map((e,t)=>e.toString()),y=window.location.origin;console.log("SOCKET_URL :>> ",y);let[b,k]=(0,m.useState)(["Connecting..."]),[Z,C]=(0,m.useState)("in_progress"),[S,E]=(0,m.useState)(!1),{token:{colorText:P}}=l.Z.useToken();return(0,m.useEffect)(()=>{(0,d.isEmpty)(p)||k(h)},[h.length]),(0,m.useEffect)(()=>{if(null==p||p.toString().toLowerCase(),((null==c?void 0:c.status)==="failed"||(null==c?void 0:c.status)==="success")&&E(!0),(null==c?void 0:c.status)==="success"&&C("success"),(null==c?void 0:c.status)==="failed"&&C("failed"),!o)return()=>!1;console.log('[socket] connecting to "'.concat(o,'" room...'));let e=j(y,{transports:["websocket"]});return e.on("connect",()=>{console.log("[socket] connected:",e.connected,"(ROOM: ".concat(o,")")),e.emit("join",{room:o}),e.on("message",t=>{let{action:n,message:a}=t;console.log("[socket] message:",{action:n,message:a}),a&&(k(e=>[...e,w(a)]),((null==a?void 0:a.toLowerCase().indexOf("command failed with exit code 1"))>-1||(null==a?void 0:a.toLowerCase().indexOf("[error]"))>-1)&&(C("failed"),E(!0))),"failed"===n&&(C("failed"),E(!0)),"end"===n&&(e.disconnect(),E(!0),C("success"))})}),e.on("disconnect",()=>{console.log("[socket] disconnected !"),k(e=>[...e,"Disconnected with build server."])}),()=>{e.connected&&(console.log("[socket] disconnecting..."),e.disconnect()),k([])}},[null==c?void 0:c.status,p,o]),(0,a.jsxs)("div",{style:{color:P},children:["failed"===Z&&(0,a.jsxs)("h3",{className:"text-xl text-blue-600",children:[(0,a.jsx)(s.Z,{})," Building..."]}),"failed"===Z&&(0,a.jsx)("h2",{className:"text-xl text-red-600",children:"Build lỗi rồi m\xe1 ơi!"}),"success"===Z&&(0,a.jsx)("h2",{className:"text-xl text-green-600",children:"Build th\xe0nh c\xf4ng rồi, đỉnh qu\xe1 idol ơi!"}),(0,a.jsx)(r.Z,{items:b.filter(e=>""!==e).reverse().map((e,t)=>{let n="".concat(e);if(n.toLowerCase().indexOf("error")>-1)return{dot:(0,a.jsx)(i.Z,{className:"text-red-600"}),children:(0,a.jsx)("span",{className:"text-red-600",children:(0,u.ZP)("".concat(e))})};if(n.indexOf("http://")>-1||n.indexOf("https://")){let e=n.split(" "),t=e.map(e=>v()(e,{require_protocol:!0})?'<a href="'.concat(e,'" target="_blank" style="color: #008dff">').concat(e,"</a>"):e).join(" ");return{children:(0,u.ZP)(t)}}return{children:(0,u.ZP)("".concat(e))}})})]})}},32365:function(e,t,n){"use strict";n.d(t,{o:function(){return i}});var a=n(95954),s=n(50959);let i=()=>{let e=(0,a.useRouter)(),t=e.asPath,n=new URLSearchParams(e.asPath.split("?")[1]),i=Object.fromEntries(n),[l,r]=(0,s.useState)(i),o=t=>{let n={...l};return t.forEach(e=>{delete n[e]}),r(n),e.push(e.pathname,{query:n}),l},c=()=>{let e=Object.keys(l);return o(e)};return(0,s.useEffect)(()=>{if(e.isReady){if(-1===t.indexOf("?")){c();return}r(i)}},[e.asPath,e.isReady]),[l,{setQuery:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={...l,...t};return r(n),e.push("".concat(e.pathname),{query:n}),n},deleteQuery:o,deleteAllQueryKeys:c}]}},70038:function(e,t,n){"use strict";n.d(t,{c:function(){return l}});var a=n(66830),s=n(32365),i=n(50959);let l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,[t]=i.useState(()=>{try{var t,n;return null==window?void 0:null===(t=window.location)||void 0===t?void 0:null===(n=t.hostname)||void 0===n?void 0:n.split(".")[e]}catch(e){console.error(e.message);return}});return t}(),[{workspace:n}]=(0,s.o)(),l="app"===t||"localhost"===t||"diginext"===t?e.name:null!=n?n:t,{data:r}=(0,a.xh)(l,{staleTime:288e5});return r}},47954:function(e,t,n){"use strict";n.d(t,{o:function(){return to}});var a,s=n(11527),i=n(35301),l=n(515),r=n(74186),o=n(85276),c=n(32699),u=n.n(c),d=n(72602),m=n.n(d);let p=e=>{let{gaIds:t}=e;return(0,c.isEmpty)(t)?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m(),{src:"https://www.googletagmanager.com/gtag/js?id=".concat(t[0]),strategy:"afterInteractive"}),(0,s.jsx)(m(),{id:"google-analytics",strategy:"afterInteractive",children:"\n                window.dataLayer = window.dataLayer || [];\n                function gtag(){window.dataLayer.push(arguments);}\n                gtag('js', new Date());\n                \n                ".concat(t.map(e=>"gtag('config', '".concat(e,"');\n")),"\n                ")})]})};var g=n(18444),h=n(95954),v=n(50959),x=n(30211),f=n(49259),j=n(56967),y=n(10197),b=n(84954),w=n(44014),k=n(65099),Z=n(56076),C=n(49869),S=n(13755),E=n(4084),P=n(57167),N=n(7761),_=n(95752),A=n(91800),R=n(55786),F=n(94603),L=n.n(F);let I=(0,v.createContext)({sidebarCollapsed:!1}),T=()=>{let e=(0,v.useContext)(I);return e};var U=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,n]=(0,v.useState)(!1),a=e=>void 0!==e?n(e):n(e=>!e);return(0,s.jsx)(I.Provider,{value:{sidebarCollapsed:t,toggleSidebar:a},children:e.children})};let V=[{key:"menu/",icon:(0,s.jsx)(x.Z,{}),label:"Dashboard"},{key:"menu/project",icon:(0,s.jsx)(f.Z,{}),label:"Projects"},{key:"menu/framework",icon:(0,s.jsx)(j.Z,{}),label:"Frameworks"},{key:"menu/git",icon:(0,s.jsx)(y.Z,{}),label:"Git Providers"},{key:"menu/infrastructure",icon:(0,s.jsx)(b.Z,{}),label:"Infrastructure",children:[{key:"menu/infrastructure/cloud-provider",icon:(0,s.jsx)(w.Z,{}),label:"Cloud Providers"},{key:"menu/infrastructure/cluster",icon:(0,s.jsx)(k.Z,{}),label:"K8S Clusters"},{key:"menu/infrastructure/database",icon:(0,s.jsx)(Z.Z,{}),label:"Databases"},{key:"menu/infrastructure/registry",icon:(0,s.jsx)(C.Z,{}),label:"Container Registries"}]},{key:"menu/workspace",icon:(0,s.jsx)(S.Z,{}),label:"Workspace",children:[{key:"menu/workspace/users",icon:(0,s.jsx)(E.Z,{}),label:"Users"},{key:"menu/workspace/teams",icon:(0,s.jsx)(P.Z,{}),label:"Teams"},{key:"menu/workspace/roles",icon:(0,s.jsx)(N.Z,{}),label:"Roles"},{key:"menu/workspace/settings",icon:(0,s.jsx)(_.Z,{}),label:"Settings"}]}],B=()=>{let e=(0,h.useRouter)(),{sidebarCollapsed:t,toggleSidebar:n}=T(),{isDarkMode:a}=(0,o.vs)(),i="menu/".concat((0,c.trimStart)(e.pathname,"/").split("/")[0]),l="menu".concat((0,c.trimEnd)(e.pathname,"/")),r=t=>{let n=(0,c.trimStart)(t.key,"menu");e.push(n)};return(0,s.jsxs)(R.ZP,{theme:"light",collapsible:!0,collapsed:t,onCollapse:e=>n&&n(e),style:{overflow:"auto",height:"100vh",position:"fixed",left:0,top:0,bottom:0},children:[t?(0,s.jsx)("div",{className:"mx-auto my-5 w-[32px]",children:(0,s.jsx)(L(),{href:"/",children:(0,s.jsx)("img",{src:a?"".concat(e.basePath,"/assets/images/diginext-icon-white.svg"):"".concat(e.basePath,"/assets/images/diginext-icon-black.svg"),alt:"Diginext Logo"})})}):(0,s.jsx)("div",{className:"mx-auto my-5 w-36",children:(0,s.jsx)(L(),{href:"/",children:(0,s.jsx)("img",{src:a?"".concat(e.basePath,"/assets/images/diginext_logo_white.svg"):"".concat(e.basePath,"/assets/images/diginext_logo.svg"),alt:"Diginext Logo"})})}),(0,s.jsx)(A.Z,{mode:"inline",inlineCollapsed:t,defaultOpenKeys:[i],defaultSelectedKeys:[i,l],items:V,onSelect:r})]})};var D=n(50939),O=n(19723),z=n(31326),q=n(20193),X=n(82129),M=n(42741),Q=n(32365),K=n(41742);let H=(0,v.createContext)({drawerVisibility:{lv1:!1,lv2:!1},toggleDrawer:(e,t)=>{},showDrawer:(e,t)=>{},closeDrawer:e=>{}}),W=()=>{let e=(0,v.useContext)(H);return e};var Y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,n]=(0,v.useState)({lv1:!1,lv2:!1}),[a,i]=(0,v.useState)(),[l,r]=(0,v.useState)(),o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"lv1",t=arguments.length>1?arguments[1]:void 0;return void 0!==t?n(n=>{let a={...n};return a[e]=t,a}):n(t=>{let n={...t};return n[e]=!t[e],n})},c=e=>{e?o(e,!1):n({lv1:!1,lv2:!1})},u=()=>{n(e=>({...e,lv1:!1}))},d=()=>{n(e=>({...e,lv2:!1}))},m=(e,t)=>{switch(null==t?void 0:t.level){case 1:i(e),o("lv1",!0);break;case 2:r(e),o("lv2",!0)}};return(0,s.jsxs)(H.Provider,{value:{drawerVisibility:t,toggleDrawer:o,showDrawer:m,closeDrawer:c},children:[e.children,(0,s.jsxs)(K.Z,{title:null==a?void 0:a.title,placement:"right",onClose:u,open:t.lv1,size:"large",bodyStyle:{overflow:"hidden",padding:0},destroyOnClose:!0,children:[null==a?void 0:a.content,(0,s.jsx)(K.Z,{title:null==l?void 0:l.title,placement:"right",onClose:d,open:t.lv2,size:"large",destroyOnClose:!0,children:null==l?void 0:l.content})]})]})},G=n(98339),J=n(31604),$=n(73875),ee=n(45826),et=n(55324),en=n(44547),ea=n(71548),es=n(74761),ei=n(9734),el=n(4897),er=n(27422);let eo=e=>{let t;let{compact:n=!1,name:a,setValue:i,initialValue:l,apiStatus:r}=e,o=z.Z.useFormInstance(),c=()=>o.submit(),u=()=>{o.setFieldValue(a,l),i(l)},d=()=>{o.setFieldValue(a,""),i(void 0)};return r&&"loading"===r&&(t=(0,s.jsx)(J.Z,{})),r&&"error"===r&&(t=(0,s.jsx)(es.Z,{})),r&&"success"===r&&(t=(0,s.jsx)(ei.Z,{})),(0,s.jsxs)(q.Z,{size:n?4:8,children:[t,(0,s.jsx)(X.ZP,{type:"primary",icon:n&&(0,s.jsx)($.Z,{}),onClick:()=>c(),children:!n&&"Save"}),(0,s.jsx)(X.ZP,{icon:n&&(0,s.jsx)(el.Z,{}),onClick:()=>d(),children:!n&&"Clear"}),(0,s.jsx)(X.ZP,{danger:!0,icon:n&&(0,s.jsx)(er.Z,{}),onClick:()=>u(),children:!n&&"Reset"})]})},ec=e=>{let t;let{label:n,postLabel:a,name:i,required:l=!1,requiredMessage:r="Please input your ".concat(n),defaultValue:c,initialValue:u,value:d,status:m,autoSave:p=!1,isNew:g,lang:h=[],height:x="350px",disabled:f=!1}=e,j=z.Z.useFormInstance(),[y,b]=(0,v.useState)(null!=d?d:c),w=(0,o.Nr)(y,500),k=e=>{j.setFieldValue(i,e),b(e)},Z=()=>j.submit();return(0,v.useEffect)(()=>{j.setFieldValue(i,d),b(d)},[d]),(0,v.useEffect)(()=>{w!==d&&p&&!g&&Z()},[w]),m&&"error"===m[i]&&(t=(0,s.jsx)(G.Z,{})),m&&"loading"===m[i]&&(t=(0,s.jsx)(J.Z,{})),m&&"success"===m[i]&&(t=(0,s.jsx)($.Z,{color:"green"})),(0,s.jsx)(z.Z.Item,{label:(0,s.jsxs)(q.Z,{size:"small",children:[n,t]}),name:i,rules:[{required:l,message:r}],children:(0,s.jsxs)(q.Z,{direction:"vertical",className:"w-full",children:[(0,s.jsx)(ea.ZP,{height:x,theme:en.M_,extensions:[...h.map(e=>et.RI[e]()),(0,ee.X)({})],onChange:k,value:y,editable:!f}),a,!p&&!g&&(0,s.jsx)(eo,{initialValue:u,name:i,setValue:b})]})})};var eu=n(78007);let ed=e=>{let t;let{label:n,postLabel:a,name:i,required:l=!1,requiredMessage:r="Please input your ".concat(n),defaultValue:c,initialValue:u,value:d,status:m,autoSave:p=!0,isNew:g,placeholder:h,disabled:x=!1}=e,f=z.Z.useFormInstance(),[j,y]=(0,v.useState)(null!=d?d:c),b=(0,o.Nr)(j,500),w=e=>{let t=e.currentTarget.value;f.setFieldValue(i,t),y(t)},k=()=>f.submit();return(0,v.useEffect)(()=>{f.setFieldValue(i,d),y(d)},[d]),(0,v.useEffect)(()=>{b!==d&&p&&!g&&k()},[b]),m&&"error"===m[i]&&(t=(0,s.jsx)(G.Z,{})),m&&"loading"===m[i]&&(t=(0,s.jsx)(J.Z,{})),m&&"success"===m[i]&&(t=(0,s.jsx)($.Z,{color:"green"})),(0,s.jsx)(z.Z.Item,{label:(0,s.jsxs)(q.Z.Compact,{direction:"vertical",children:[(0,s.jsxs)(q.Z,{size:"small",children:[n,t]}),a]}),name:i,rules:[{required:l,message:r}],children:(0,s.jsxs)(q.Z,{direction:"vertical",className:"w-full",children:[(0,s.jsx)(eu.Z,{placeholder:h,onChange:w,value:j,disabled:x}),!p&&!g&&(0,s.jsx)(eo,{initialValue:u,name:i,setValue:y})]})})};var em=n(95568);let ep=e=>{let t;let{className:n,style:a,label:i,postLabel:l,name:r,required:c=!1,requiredMessage:u="Please input your ".concat(i),defaultValue:d,initialValue:m,value:p,status:g,autoSave:h=!0,isNew:x,options:f,disabled:j=!1}=e,y=z.Z.useFormInstance(),[b,w]=(0,v.useState)(null!=p?p:d),k=(0,o.Nr)(b,500);console.log("_value :>> ",b);let Z=e=>{y.setFieldValue(r,e),w(e)},C=()=>y.submit();return(0,v.useEffect)(()=>{console.log("value :>> ",p),y.setFieldValue(r,p),w(p)},[p]),(0,v.useEffect)(()=>{k!==p&&h&&!x&&C()},[k]),g&&"error"===g[r]&&(t=(0,s.jsx)(G.Z,{})),g&&"loading"===g[r]&&(t=(0,s.jsx)(J.Z,{})),g&&"success"===g[r]&&(t=(0,s.jsx)($.Z,{color:"green"})),(0,s.jsx)(z.Z.Item,{label:(0,s.jsxs)(q.Z,{size:"small",children:[i,t]}),name:r,rules:[{required:c,message:u}],children:(0,s.jsxs)(q.Z,{direction:"horizontal",className:"w-full",children:[(0,s.jsx)(em.Z,{className:n,style:a,value:b,onChange:Z,options:f,disabled:j}),l,!h&&!x&&(0,s.jsx)(eo,{initialValue:m,name:r,setValue:w})]})})},{TextArea:eg}=eu.Z,eh=e=>{let t;let{label:n,postLabel:a,name:i,required:l=!1,requiredMessage:r="Please input your ".concat(n),defaultValue:c,initialValue:u,value:d,status:m,autoSave:p=!0,isNew:g,disabled:h=!1}=e,x=z.Z.useFormInstance(),[f,j]=(0,v.useState)(null!=d?d:c),y=(0,o.Nr)(f,500),b=e=>{let t=e.currentTarget.value;x.setFieldValue(i,t),j(t)},w=()=>x.submit();return(0,v.useEffect)(()=>{x.setFieldValue(i,d),j(d)},[d]),(0,v.useEffect)(()=>{y!==d&&p&&!g&&w()},[y]),m&&"error"===m[i]&&(t=(0,s.jsx)(G.Z,{})),m&&"loading"===m[i]&&(t=(0,s.jsx)(J.Z,{})),m&&"success"===m[i]&&(t=(0,s.jsx)($.Z,{color:"green"})),(0,s.jsx)(z.Z.Item,{label:(0,s.jsxs)(q.Z,{size:"small",children:[n,t]}),name:i,rules:[{required:l,message:r}],children:(0,s.jsxs)(q.Z,{direction:"vertical",className:"w-full",children:[(0,s.jsx)(eg,{rows:3,onChange:b,value:f,disabled:h}),a,!p&&!g&&(0,s.jsx)(eo,{compact:!0,initialValue:u,name:i,setValue:j})]})})},{useApp:ev}=r.Z,ex=e=>{var t;let{name:n,configs:a=[]}=e,i=ev(),{data:r}=(null===(t=e.api)||void 0===t?void 0:t.useSlugApi)||{},{useCreateApi:o,useUpdateApi:d}=e.api||{},[m,p]=d||[],[g,h]=o||[],[x,{deleteAllQueryKeys:f}]=(0,Q.o)(),[j]=z.Z.useForm(),[y,b]=(0,v.useState)(),w=void 0===r,{token:{colorBgContainer:k}}=l.Z.useToken(),{closeDrawer:Z}=W(),C=async e=>{let t;console.log(w?"[NEW]":"[UPDATE]","Submit:",e);let n={...e};if(w)Object.entries(n).forEach(e=>{let[t,a]=e;t.indexOf(".")>-1&&(delete n[t],u().set(n,t,a))}),g&&(t=await g(n)),console.log("[NEW] result :>> ",t),(null==t?void 0:t.status)&&(i.notification.success({message:"Congrats!",description:"Item has been created successfully."}),Z());else{let e={};Object.entries(n).forEach(t=>{let[a,s]=t;r&&s!==r[a]?e[a]="loading":(delete e[a],delete n[a])}),console.log("statuses :>> ",e),b(e),(0,c.isEmpty)(e)?console.log("[UPDATE] Skipped, nothing new to update."):(m&&(t=await m(n)),console.log("[UPDATE] result :>> ",t),(null==t?void 0:t.status)&&Z())}},S=e=>{console.log("Failed:",e)};return(0,v.useEffect)(()=>{if(void 0===y)return;let e=Object.keys(y),t={};e.forEach(e=>{t[e]=p}),b(t)},[p]),(0,s.jsxs)(z.Z,{className:"h-full overflow-auto",layout:"vertical",form:j,onFinish:C,onFinishFailed:S,autoComplete:"off",children:[(0,s.jsx)("div",{className:"p-6 pb-16",children:a.map(e=>{switch(e.type){case"input":return(0,s.jsx)(ed,{...e,value:r&&u().get(r,e.name),status:y,isNew:w},"".concat(n,"-").concat(e.name));case"textarea":return(0,s.jsx)(eh,{...e,value:r&&u().get(r,e.name),status:y,isNew:w},"".concat(n,"-").concat(e.name));case"code-editor":return(0,s.jsx)(ec,{...e,value:r&&u().get(r,e.name),status:y,isNew:w},"".concat(n,"-").concat(e.name));case"select":{let{selectedKey:t}=e;return void 0===t&&(t="_id"),(0,s.jsx)(ep,{...e,style:{minWidth:300,...null==e?void 0:e.style},value:r&&u().get(r,""===t?e.name:"".concat(e.name,".").concat(t)),status:y,isNew:w},"".concat(n,"-").concat(e.name))}default:return null}})}),w&&(0,s.jsx)("div",{className:"fixed bottom-0 w-full px-6 py-3",style:{backgroundColor:k},children:(0,s.jsxs)(q.Z,{children:[(0,s.jsx)(z.Z.Item,{style:{marginBottom:0},children:(0,s.jsx)(X.ZP,{type:"primary",htmlType:"submit",children:"Submit"})}),(0,s.jsx)(M.Z,{title:"Are you sure?",onConfirm:()=>f(),okText:"Yes",cancelText:"No",children:(0,s.jsx)(X.ZP,{type:"primary",danger:!0,children:"Discard"})})]})})]})};var ef=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let[{cluster_slug:e}]=(0,Q.o)(),t=(0,O.pD)(e,{populate:"owner,provider"}),{data:n}=t,a=(0,O.ve)({filter:{id:null==n?void 0:n._id}}),i=(0,O.CN)(),{data:{list:l=[]}={}}=(0,D.nu)(),r=[{type:"input",label:"Name",name:"name",placeholder:"Cluster name"},{type:"input",label:"Short name",name:"shortName",placeholder:"Short name"},{type:"select",label:"Cloud Provider",name:"provider",placeholder:"Cloud Provider",options:l.map(e=>({label:e.name||"",value:e._id}))},{type:"input",label:"Primary IP",name:"primaryIP",placeholder:"192.168.10.50"},{type:"input",label:"Primary domain",name:"primaryDomain",placeholder:"example.com"},{type:"input",label:"Project ID (Google)",name:"projectID",placeholder:"my-project-id"},{type:"input",label:"Region (Google)",name:"region",placeholder:"asia-southeast1"},{type:"input",label:"Zone (Google)",name:"zone",placeholder:"asia-southeast1-a"},{type:"code-editor",lang:["yaml"],label:"KubeConfig (YAML)",name:"kubeConfig"},{type:"textarea",label:"API Access Token",name:"apiAccessToken"},{type:"code-editor",lang:["json"],label:"Service Account (JSON)",name:"serviceAccount"}];return(0,s.jsx)(ex,{name:"cluster",api:{useSlugApi:t,useUpdateApi:a,useCreateApi:i},configs:r})},ej=n(73638),ey=n(95019),eb=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let[{framework_slug:e}]=(0,Q.o)(),t=(0,ej.FX)(e,{populate:"owner,git"}),{data:n}=t,a=(0,ej.fR)({filter:{id:null==n?void 0:n._id}}),i=(0,ej.D$)(),{data:{list:l=[]}={}}=(0,ey.y3)(),r=[{type:"input",label:"Name",name:"name",placeholder:"My Starter Template"},{type:"select",label:"Git Provider",name:"git",style:{width:250},options:l.map(e=>({label:e.name||"",value:e._id}))},{type:"input",label:"Repository HTTPS URL",name:"repoURL",placeholder:"https://github.com/user/repo.git"},{type:"input",label:"Repository SSH URL",name:"repoSSH",placeholder:"git@github.com:user/repo.git"},{type:"input",label:"Main branch",name:"mainBranch",placeholder:"main"}];return(0,s.jsx)(ex,{name:"framework",api:{useSlugApi:t,useUpdateApi:a,useCreateApi:i},configs:r})},ew=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let[{git_provider_slug:e}]=(0,Q.o)(),t=(0,ey.o0)(e,{populate:"owner"}),{data:n}=t,a=(0,ey.Ve)({filter:{id:null==n?void 0:n._id}}),i=(0,ey.xP)();return(0,s.jsx)(ex,{name:"gitProvider",api:{useSlugApi:t,useUpdateApi:a,useCreateApi:i},configs:[{type:"input",label:"Name",name:"name",placeholder:"Github"},{type:"input",label:"Host",name:"host",placeholder:"github.com"},{type:"input",label:"Workspace name",name:"gitWorkspace",placeholder:"https://github.com/user/repo.git"},{type:"input",label:"Workspace URL",name:"repo.url",placeholder:"git@github.com:user/repo.git"},{type:"input",label:"Workspace SSH Prefix",name:"repo.sshPrefix",placeholder:"main"}]})},ek=n(79515),eZ=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let[{registry_slug:e}]=(0,Q.o)(),t=(0,ek.EL)(e,{populate:"owner"}),{data:n}=t,a=(0,ek.Xn)({filter:{id:null==n?void 0:n._id}}),i=(0,ek.Bl)(),{data:{list:l=[]}={}}=(0,D.nu)(),r=[{type:"input",label:"Name",name:"name",placeholder:"My Container Registry"},{type:"select",label:"Cloud Provider",name:"provider",style:{width:250},selectedKey:"",options:l.map(e=>({label:e.name||"",value:e.shortName}))},{type:"input",label:"Host",name:"host",placeholder:"asia.gcr.io"},{type:"input",label:"Docker Image URL Prefix",name:"imageBaseURL",placeholder:"asia.gcr.io/google-project-id"},{type:"input",label:"Image Pull Secret's Name",name:"imagePullingSecret.name",placeholder:"my-docker-secret-name"},{type:"textarea",label:"Image Pull Secret's Value",name:"imagePullingSecret.value",placeholder:"my-docker-secret-value"}];return(0,s.jsx)(ex,{name:"registry",api:{useSlugApi:t,useUpdateApi:a,useCreateApi:i},configs:r})};let eC=()=>{let e;let[{type:t}]=(0,Q.o)();switch(t){case"cluster":e=(0,s.jsx)(ef,{});break;case"framework":e=(0,s.jsx)(eb,{});break;case"git-provider":e=(0,s.jsx)(ew,{});break;case"registry":e=(0,s.jsx)(eZ,{})}return(0,s.jsx)("div",{className:"h-full",children:e})};var eS=n(74883);let eE=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.jsxs)("div",{children:[e.children,(0,s.jsxs)("div",{className:"border-t border-gray-300 py-8 text-center text-xs",children:["\xa9 Copyright ",new Date().getFullYear()," ",eS.XL.title,". Powered by ",(0,s.jsx)("a",{href:"https://wearetopgroup.com",children:"TOP GROUP"}),"."]})]})};var eP=n(58410),eN=n(82639),e_=n(28906),eA=n(29935),eR=n(76663),eF=n(89875),eL=n(16110),eI=n(66109);let{Header:eT}=g.Z,eU=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{onSidebarChange:t}=e,{isDarkMode:n,toggle:a}=(0,o.vs)(),[i]=(0,eI.aC)(),{token:{colorBgContainer:r}}=l.Z.useToken(),{sidebarCollapsed:c,toggleSidebar:u}=T();return(0,v.useEffect)(()=>t&&t(c),[c]),(0,s.jsx)(eT,{className:"w-full",style:{position:"sticky",top:0,paddingInline:24,lineHeight:"48px",height:48,zIndex:100,background:r},children:(0,s.jsxs)("div",{className:"flex ",children:[(0,s.jsx)("div",{className:"grow",children:v.createElement(c?eP.Z:eN.Z,{className:"trigger",onClick:()=>u&&u()})}),(0,s.jsxs)(q.Z,{size:4,children:[(0,s.jsx)(X.ZP,{type:"text",icon:(0,s.jsx)(e_.Z,{})}),(0,s.jsx)(X.ZP,{type:"text",icon:(0,s.jsx)(eA.Z,{})}),(0,s.jsx)(X.ZP,{type:"text",style:{fontSize:18,verticalAlign:"middle",paddingTop:0},onClick:a,icon:n?(0,s.jsx)("i",{className:"ri-sun-line inline-block"}):(0,s.jsx)("i",{className:"ri-moon-line inline-block"})}),(0,s.jsx)(eF.Z,{placement:"bottomRight",trigger:"click",content:(0,s.jsxs)(q.Z,{direction:"vertical",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"mb-0",children:(0,s.jsx)("strong",{children:null==i?void 0:i.name})}),(0,s.jsx)("p",{className:"mb-0",children:null==i?void 0:i.email})]}),(0,s.jsxs)(q.Z.Compact,{direction:"vertical",className:"w-full",children:[(0,s.jsx)(X.ZP,{children:"Profile"}),(0,s.jsx)(X.ZP,{href:"/logout",children:"Sign out"})]})]}),children:(0,s.jsxs)("div",{className:"cursor-pointer align-middle",children:[(0,s.jsx)(eL.C,{style:{lineHeight:"20px"},icon:(0,s.jsx)(E.Z,{style:{verticalAlign:"middle"}}),src:null==i?void 0:i.image,size:24}),(0,s.jsx)("span",{className:"ml-2 inline-block",children:null==i?void 0:i.name}),(0,s.jsx)(eR.Z,{className:"ml-2"})]})})]})]})})};var eV=n(48409),eB=n(85451),eD=n(39050),eO=n(59140),ez=n(23407),eq=n(3741),eX=n(14354),eM=n(32942),eQ=n(74637),eK=n.n(eQ),eH=n(46734),eW=n(83360);let eY=e=>(0,eW.wz)(["releases","list"],"/api/v1/release",e),eG=e=>(0,eW.yt)(["releases","rollout"],"/api/v1/release/rollout",e),eJ=e=>(0,eW.FF)(["releases","create"],"/api/v1/release/from-build",e),e$=e=>(0,eW.yt)(["releases","preview"],"/api/v1/release/preview",e);var e0=n(1830);let e1=n(64814),e3=n(54498);eK().extend(e3),eK().extend(e1);let{useApp:e4}=r.Z,e2=[{title:"Name",width:70,dataIndex:"name",key:"name",filterSearch:!0,filters:[{text:"goon",value:"goon"}],onFilter:(e,t)=>t.name&&t.name.indexOf(e.toString())>-1||!0,render:(e,t)=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:(0,s.jsx)(L(),{href:{pathname:"/build/[...slugs]",query:{slugs:[t.slug]}},children:(0,s.jsx)("strong",{children:e})})}),(0,s.jsxs)("p",{children:["Created ",(0,s.jsx)(e0.q,{date:t.createdAt})]})]})},{title:"Created by",dataIndex:"owner",key:"owner",width:40,filterSearch:!0,filters:[{text:"goon",value:"goon"}],onFilter:(e,t)=>t.owner&&(t.owner.slug||"").indexOf(e.toString())>-1||!0,render:e=>(0,s.jsx)(s.Fragment,{children:null==e?void 0:e.name})},{title:"Status",dataIndex:"status",key:"status",width:30,filters:[{text:"live",value:"live"}],render:e=>{let t="warning",n=(0,s.jsx)(eV.Z,{});switch(e){case"building":t="processing",n=(0,s.jsx)(J.Z,{className:"align-middle"});break;case"failed":t="error",n=(0,s.jsx)(es.Z,{className:"align-middle"});break;case"success":t="success",n=(0,s.jsx)(ei.Z,{className:"align-middle"});break;default:t="default",n=(0,s.jsx)(eV.Z,{})}return(0,s.jsx)(eq.Z,{color:t,icon:n,children:e})}},{title:"Action",key:"action",width:30,dataIndex:"action"}],e5=()=>{(0,h.useRouter)();let e=e4(),[t,{setQuery:n}]=(0,Q.o)(),{project:a,app:i,env:l}=t,r={};a&&(r.projectSlug=a),i&&(r.appSlug=i),l&&(r.env=l);let[o,u]=(0,v.useState)(1),[d,m]=(0,eH.fg)(),{data:p}=(0,eH.BY)({sort:"-createdAt",populate:"owner",pagination:{page:o,size:100},filter:r}),{list:g,pagination:x}=p||{},{total_items:f}=x||{},j=e=>{n({lv2:"build_logs",build_slug:e})},[y]=eJ(),b=async t=>{if((0,c.isEmpty)(t)){e.notification.error({message:"Failed to release the build.",description:"Build not found: ".concat(t),placement:"top"});return}try{let n=await y({build:t});if(null==n?void 0:n.status){let t=null==n?void 0:n.data;e.notification.success({message:"Congrats, the release has been created successfully!",description:(0,s.jsxs)(s.Fragment,{children:["You can now preview it on ",(0,s.jsx)("a",{href:"https://".concat(null==t?void 0:t.prereleaseUrl),children:"PRE-RELEASE"})," endpoint."]}),placement:"top"});return}}catch(t){console.error("Could not process releasing this build:",t),e.notification.error({message:"Failed to roll out.",description:"Could not process releasing this build: ".concat(t),placement:"top"})}},w=async t=>{let n=await d({slug:t});console.log("[BuildList] stopBuild :>> ",n),(null==n?void 0:n.status)||e.notification.error({message:"Failed to proceed.",description:"Could not stop this build due to server issue. Please try again later.",placement:"top"})},k=null==g?void 0:g.map(e=>({id:e._id,...e,action:(0,s.jsxs)(q.Z.Compact,{children:["building"===e.status&&(0,s.jsx)(eX.Z,{title:"Stop building",children:(0,s.jsx)(X.ZP,{danger:!0,icon:(0,s.jsx)(eB.Z,{}),onClick:()=>w(null==e?void 0:e.slug)})}),(0,s.jsx)(eX.Z,{title:"View logs",children:(0,s.jsx)(X.ZP,{icon:(0,s.jsx)(eD.Z,{}),onClick:()=>j(e.slug)})}),(0,s.jsx)(eX.Z,{title:"Open image URL",children:(0,s.jsx)(X.ZP,{icon:(0,s.jsx)(eO.Z,{}),href:"https://".concat(e.image),target:"_blank"})}),"prod"===e.env&&(0,s.jsx)(eX.Z,{title:"Roll out this build",children:(0,s.jsx)(X.ZP,{icon:(0,s.jsx)(ez.Z,{}),onClick:()=>{var t;return b(null===(t=e._id)||void 0===t?void 0:t.toString())}})})]})})),Z=e=>{let{current:t}=e;u(null!=t?t:1)};return(0,s.jsx)("div",{className:"h-full overflow-auto",children:(0,s.jsx)(eM.Z,{columns:e2,dataSource:k,scroll:{x:600},sticky:{offsetHeader:0},pagination:{current:o,pageSize:100,total:f},onChange:Z})})};var e6=n(3006),e9=n(17434),e8=n(53081),e7=n(10891);let te=()=>{var e;let[{env:t,project:n,app:a}]=(0,Q.o)(),{closeDrawer:i}=W(),[l,r]=(0,e7.XS)(),{data:o={}}=(0,e7.im)(a,{populate:"project,owner,workspace"}),u=(0,c.isEmpty)(o)?[]:(null===(e=(o.deployEnvironment||{})[t])||void 0===e?void 0:e.envVars)||[],[d,m]=(0,v.useState)(u),[p]=z.Z.useForm(),g=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return m([...e])};(0,v.useEffect)(()=>g(u),[JSON.stringify(u)]);let h=e=>m(t=>(t.splice(e,1),[...t])),x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{name:"",value:""};return m(t=>[...t,e])},f=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";m(n=>n.map((n,a)=>a===e?{name:t,value:n.value||""}:n))},j=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";m(n=>n.map((n,a)=>a===e?{name:n.name||"",value:t}:n))},y=async e=>{let n;let s={envVars:JSON.stringify(d),slug:a,env:t};l&&(n=await l(s)),console.log("[CREATE_ENV_VARS] result :>> ",n),(null==n?void 0:n.status)&&g(null==n?void 0:n.data)},b=e=>{console.log("Failed:",e)};return(0,s.jsxs)(z.Z,{className:"h-full overflow-auto p-6",layout:"vertical",name:"deployEnvironment.".concat(t,".envVars"),form:p,onFinish:y,onFinishFailed:b,autoComplete:"off",children:[(0,s.jsxs)(q.Z,{className:"w-full",direction:"vertical",size:"small",children:[(0,s.jsxs)(q.Z.Compact,{block:!0,children:[(0,s.jsx)(e9.Z.Text,{className:"w-1/2",children:"Name"}),(0,s.jsx)(e9.Z.Text,{className:"w-1/2",children:"Value"}),(0,s.jsx)("span",{className:"w-[32px]"})]}),(0,c.isEmpty)(d)&&(0,s.jsx)(e8.Z,{}),(d||[]).map((e,t)=>(0,s.jsxs)(q.Z.Compact,{block:!0,children:[(0,s.jsx)(z.Z.Item,{className:"mb-0 w-1/2",name:["envVars[".concat(t,"]"),"name"],rules:[{required:!0,message:"Variable name is required"},{validator:(e,t)=>-1===t.indexOf(" ")?Promise.resolve():Promise.reject(Error("Variable name should not contain spacing."))},{validator:(e,t)=>!1===/[`!@#$%^&*()+\-=\[\]{};':"\\|,.<>\/?~]/g.test(t)?Promise.resolve():Promise.reject(Error("Variable name should not contain special character."))}],initialValue:e.name,children:(0,s.jsx)(eu.Z,{className:"!flex-auto",placeholder:"NAME",value:e.name,onChange:e=>f(t,e.currentTarget.value)})}),(0,s.jsx)(z.Z.Item,{className:"mb-0 w-1/2",name:["envVars[".concat(t,"]"),"value"],rules:[{required:!0,message:"Variable value is required"}],initialValue:e.value,children:(0,s.jsx)(eu.Z,{className:"!flex-auto",placeholder:"VALUE",value:e.value,onChange:e=>j(t,e.currentTarget.value)})}),(0,s.jsx)(X.ZP,{tabIndex:-1,icon:(0,s.jsx)(G.Z,{}),onClick:()=>h(t)})]},"env-var-".concat(t)))]}),(0,s.jsx)("div",{className:"py-6",children:(0,s.jsx)(X.ZP,{onClick:()=>x(),children:"+ Add variable"})}),(0,s.jsx)(eo,{name:"envVars",apiStatus:r,initialValue:u,setValue:g})]})},tt=n(64814),tn=n(54498);eK().extend(tn),eK().extend(tt);let{useApp:ta}=r.Z,ts=[{title:"Name",width:70,dataIndex:"name",key:"name",filterSearch:!0,filters:[{text:"goon",value:"goon"}],onFilter:(e,t)=>t.name&&t.name.indexOf(e.toString())>-1||!0,render:(e,t)=>{var n;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:(0,s.jsx)("strong",{children:e})}),(0,s.jsxs)("p",{children:["Author: ",null!==(a=null===(n=t.owner)||void 0===n?void 0:n.name)&&void 0!==a?a:"-",(0,s.jsx)("br",{}),"Created ",(0,s.jsx)(e0.q,{date:t.createdAt})]})]})}},{title:"Build status",dataIndex:"buildStatus",key:"buildStatus",width:30,filters:[{text:"start",value:"start"},{text:"failed",value:"failed"},{text:"success",value:"success"},{text:"building",value:"building"}],render:e=>{let t="warning",n=(0,s.jsx)(eV.Z,{});switch(e){case"building":t="processing",n=(0,s.jsx)(J.Z,{className:"align-middle"});break;case"failed":t="error",n=(0,s.jsx)(es.Z,{className:"align-middle"});break;case"success":t="success",n=(0,s.jsx)(ei.Z,{className:"align-middle"});break;default:t="default",n=(0,s.jsx)(eV.Z,{})}return(0,s.jsx)(eq.Z,{color:t,icon:n,children:e})}},{title:"Active",dataIndex:"active",key:"active",width:20,filters:[{text:"active",value:!0}],onFilter:(e,t)=>t.active===e,render:e=>!0===e?(0,s.jsx)(eq.Z,{color:"blue",icon:(0,s.jsx)(ei.Z,{}),children:"active"}):"-"},{title:"Action",key:"action",width:30,dataIndex:"action",render:e=>e}],ti=()=>{(0,h.useRouter)();let e=ta(),[t]=(0,Q.o)(),{project:n,app:a,offsetHeader:i=0,env:l="prod"}=t,r={};n&&(r.projectSlug=n),a&&(r.appSlug=a),l&&(r.env=l);let[o,u]=(0,v.useState)(1),{data:d}=eY({populate:"owner",pagination:{page:o,size:100},filter:r}),{list:m=[],pagination:p}=d||{},{total_items:g}=p||{},[x,f]=eG();console.log("rolloutApiStatus :>> ",f);let[j,y]=(0,v.useState)(""),[b]=e$(),w=async t=>{if((0,c.isEmpty)(t)){e.notification.error({message:"Failed to roll out.",description:"Release not found: ".concat(t),placement:"top"});return}y(t);try{let n=await x({id:t}),a=null==n?void 0:n.data;(null==n?void 0:n.status)&&e.notification.success({message:"Congrats, the release has been rolled out successfully!",description:(0,s.jsxs)(s.Fragment,{children:["Your website is ready to access on PRODUCTION environment:"," ",(0,s.jsx)("a",{href:"https://".concat(null==a?void 0:a.productionUrl),target:"_blank",rel:"noreferrer",children:null==a?void 0:a.productionUrl})]}),placement:"top"})}catch(t){console.error("Could not process rolling out this release:",t),e.notification.error({message:"Failed to roll out.",description:"Could not process rolling out this release: ".concat(t),placement:"top"})}y("")},k=async t=>{if((0,c.isEmpty)(t)){e.notification.error({message:"Failed to preview.",description:"Release not found: ".concat(t),placement:"top"});return}try{let n=await b({id:t}),a=null==n?void 0:n.data;(null==n?void 0:n.status)&&e.notification.success({message:"Congrats!",description:(0,s.jsxs)(s.Fragment,{children:["The PRE-RELEASE environment has been setup successfully at:"," ",(0,s.jsx)("a",{href:"https://".concat(null==a?void 0:a.prereleaseUrl),target:"_blank",rel:"noreferrer",children:null==a?void 0:a.prereleaseUrl})]}),placement:"top"})}catch(t){e.notification.error({message:"Failed to start preview.",description:"Could not set up the pre-release environment of this release: ".concat(t),placement:"top"})}},Z=m.map(e=>({...e,id:e._id,state:""!==j?f:!0===e.active?"success":"none",action:(0,s.jsxs)(q.Z.Compact,{children:[(0,s.jsx)(eX.Z,{title:"Roll out",children:(0,s.jsx)(X.ZP,{icon:""!==j&&"loading"===f?(0,s.jsx)(J.Z,{}):(0,s.jsx)(ez.Z,{}),onClick:()=>w(e._id)})}),(0,s.jsx)(eX.Z,{title:"Preview",children:(0,s.jsx)(X.ZP,{icon:(0,s.jsx)(eO.Z,{}),onClick:()=>k(e._id),target:"_blank"})})]})}));console.log({displayedReleases:Z});let C=e=>{let{current:t}=e;u(null!=t?t:1)};return(0,s.jsx)("div",{children:(0,s.jsx)(eM.Z,{columns:ts,dataSource:Z,scroll:{x:600},sticky:{offsetHeader:i},pagination:{current:o,pageSize:100,total:g},onChange:C})})},tl=e=>{let{useSidebar:t}=e;(0,h.useRouter)();let{sidebarCollapsed:n}=T(),a="auto";t&&(a=n?80:200);let i=W(),{drawerVisibility:r,showDrawer:o,closeDrawer:c}=i,[u,{setQuery:d,deleteQuery:m,deleteAllQueryKeys:p}]=(0,Q.o)(),{lv1:x,lv2:f,type:j,slug:y,project:b,app:w,env:k}=u,{token:{colorText:Z}}=l.Z.useToken(),C=()=>{o&&o({title:"Builds",content:(0,s.jsx)(e5,{})},{level:1})},S=()=>{o&&o({title:"Releases",content:(0,s.jsx)(ti,{})},{level:1})},E=()=>{o&&o({title:"Build Logs",content:(0,s.jsx)(e6.O,{})},{level:2})},P=()=>{o&&o({title:"Environment Variables",content:(0,s.jsx)(te,{})},{level:1})},N=()=>{o&&o({title:"Edit",content:(0,s.jsx)(eC,{})},{level:1})},_=()=>{o&&o({title:"Create",content:(0,s.jsx)(eC,{})},{level:1})};return(0,v.useEffect)(()=>{switch(x){case"build":C();break;case"release":S();break;case"new":_();break;case"edit":N();break;case"env_vars":P();break;default:c&&c("lv1")}"build_logs"===f?E():c&&c("lv2")},[x,f,b,w,k]),(0,v.useEffect)(()=>{(null==r?void 0:r.lv1)===!1&&m(["lv1","project","app","env","release","type","cluster_slug","framework_slug","git_provider_slug","registry_slug"])},[null==r?void 0:r.lv1]),(0,v.useEffect)(()=>{(null==r?void 0:r.lv2)===!1&&m(["lv2","build_slug"])},[null==r?void 0:r.lv2]),(0,s.jsxs)(g.Z,{hasSider:!0,children:[e.meta,t&&(0,s.jsx)(B,{}),(0,s.jsxs)(g.Z,{className:"min-h-screen transition-all",style:{marginLeft:a},children:[t&&(0,s.jsx)(eU,{}),(0,s.jsx)("div",{className:"grow px-2",children:e.children}),(0,s.jsx)(eE,{})]})]})};function tr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{components:t=[],children:n,...a}=e;return(0,s.jsx)(s.Fragment,{children:t.reduceRight((t,n)=>(0,v.createElement)(n,{...a,key:e.key},t),n)})}let to=e=>{let{isDarkMode:t}=(0,o.vs)(),{useSidebar:n=!0}=e;return(0,s.jsxs)(i.ZP,{theme:{hashed:!1,algorithm:t?l.Z.darkAlgorithm:l.Z.defaultAlgorithm},children:[(0,s.jsx)(r.Z,{children:(0,s.jsx)(tr,{components:[U,Y],children:(0,s.jsx)(tl,{meta:e.meta,useSidebar:n,children:e.children})})}),(0,s.jsx)(p,{gaIds:["G-QC4124805Q"]})]})}},74883:function(e,t,n){"use strict";n.d(t,{De:function(){return r},XL:function(){return l},r8:function(){return o}});var a=n(64543);n(32699);var s=n(79462);let i={DEVELOPMENT:"development",STAGING:"staging",CANARY:"canary",PRODUCTION:"production"},l={site_name:"Diginext Admin",title:"Diginext Admin",description:"Welcome to an Admin Panel of Diginext.",locale:"en",tableConfig:{defaultPageSize:50}};class r{static get ENV(){return this.grab("NODE_ENV","development").toUpperCase()}static get NEXT_PUBLIC_BASE_PATH(){return""}static getBasePath(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{NEXT_PUBLIC_BASE_PATH:t}=this;return(""===t?t:"/".concat(t))+e}static path(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.getBasePath(e)}static get NEXT_PUBLIC_ENV(){return"development"}static get NEXT_PUBLIC_API_BASE_URL(){return window.location.origin.indexOf("localhost")>-1?"http://api.localhost:6969":window.location.origin}static get NEXT_PUBLIC_DOMAIN(){return"diginext.site"}static get NEXT_PUBLIC_BASE_URL(){return window.location.origin}static get DISABLE_INPECT_MEMORY(){return(0,a.AM)(this.grab("DISABLE_INPECT_MEMORY"))}static get SECONDS_INPECT_MEMORY(){return(0,a.Hq)(this.grab("SECONDS_INPECT_MEMORY"))}static get CORS_WHITELIST(){return s.env.CORS_WHITELIST?s.env.CORS_WHITELIST.split(";"):["localhost","192.168","127.0","digitop.vn","diginext.site","diginext.vn"]}}r.grab=function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a={...s.env};return null!==(t=a[e])&&void 0!==t?t:n};let o=()=>r.NEXT_PUBLIC_ENV===i.DEVELOPMENT},72610:function(){},61596:function(){},89858:function(){},36431:function(){}}]);