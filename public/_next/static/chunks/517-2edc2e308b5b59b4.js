(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[517],{88977:function(e,t,n){"use strict";n.d(t,{Wk:function(){return y},aC:function(){return j},x4:function(){return v}});var i=n(11527),l=n(38988),a=n(39831),r=n(26941),s=n(54550),o=n(33117),c=n(46998),u=n(32699),d=n(85072),p=n(50959),m=n(40028),g=n(65143),h=n(78608),x=n(65088);let v=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=null!==(e=t.redirectURL)&&void 0!==e?e:x.De.NEXT_PUBLIC_API_BASE_URL;window.location.href="".concat(x.De.NEXT_PUBLIC_API_BASE_URL,"/auth/google?redirect_url=").concat(n)},f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{access_token:t=(0,c.getCookie)("x-auth-cookie")}=e,n=(0,d.useRouter)();return(0,a.a)({staleTime:12e4,queryKey:["auth"],queryFn:async()=>{var e;let i=new URLSearchParams(n.asPath.split("?")[1]),l=Object.fromEntries(i),{access_token:a}=l,r=null!==(e=null!=t?t:(0,c.getCookie)("x-auth-cookie"))&&void 0!==e?e:a,{data:s}=await o.Z.get("".concat(x.De.NEXT_PUBLIC_API_BASE_URL,"/auth/profile"),{headers:r?{Authorization:"Bearer ".concat(r)}:{}});return s}})},j=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{redirectUrl:t}=e,n=(0,d.useRouter)(),[i]=(0,g.o)(),{access_token:l=(0,c.getCookie)("x-auth-cookie")}=i;l&&(0,c.setCookie)("x-auth-cookie",l);let{data:a,isError:s,isFetched:o,isLoading:u,isSuccess:m}=f({access_token:l}),{status:h,data:x}=a||{},v=(0,r.NL)(),j=async()=>{await v.invalidateQueries({queryKey:["auth"]})};return(0,p.useEffect)(()=>{void 0!==h&&!1!==o&&setTimeout(()=>{let e=(0,c.getCookie)("x-auth-cookie");e&&h?j():n.push(t?"/login?redirect_url=".concat(t):"/login")},200)},[h]),[x,{reload:j,isError:s,isLoading:u,isFetched:o,isSuccess:m,status:h}]},y=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{children:n}=t;(0,d.useRouter)();let[a,{isLoading:r,isFetched:o}]=j(),{workspaces:c=[]}=a||{},p=null===(e=c[0])||void 0===e?void 0:e.slug,g=(0,h.c)({name:p});return r?(0,i.jsxs)(m.Z,{children:[(0,i.jsx)(l.Z,{}),(0,i.jsx)("span",{className:"ml-2",children:"Loading..."})]}):o&&(0,u.isEmpty)(a)?(0,i.jsx)(i.Fragment,{}):g?(0,i.jsx)(i.Fragment,{children:n}):(0,i.jsx)(m.Z,{className:"text-center",children:(0,i.jsx)(s.Z,{message:"Error",description:"This workspace does not exists.",type:"error"})})}},19021:function(e,t,n){"use strict";n.d(t,{BY:function(){return l},fg:function(){return r},wl:function(){return a}});var i=n(15811);let l=e=>(0,i.wz)(["builds","list"],"/api/v1/build",e),a=(e,t)=>(0,i.AQ)(["builds","logs",e],"/api/v1/build/logs",e,t),r=e=>(0,i.yt)(["builds","stop"],"/api/v1/build/stop",e)},92455:function(e,t,n){"use strict";n.d(t,{nu:function(){return l}});var i=n(15811);let l=e=>(0,i.wz)(["providers","list"],"/api/v1/provider",e)},54712:function(e,t,n){"use strict";n.d(t,{An:function(){return o},CN:function(){return r},pD:function(){return a},ve:function(){return s},x7:function(){return l}});var i=n(15811);let l=e=>(0,i.wz)(["clusters","list"],"/api/v1/cluster",e),a=(e,t)=>(0,i.AQ)(["cluster",e],"/api/v1/cluster",e,t),r=()=>(0,i.FF)(["clusters","create"],"/api/v1/cluster"),s=e=>(0,i.yt)(["clusters","update"],"/api/v1/cluster",e),o=()=>(0,i.TV)(["clusters","delete"],"/api/v1/cluster")},18934:function(e,t,n){"use strict";n.d(t,{D$:function(){return r},Dh:function(){return l},FX:function(){return a},fR:function(){return s},mt:function(){return o}});var i=n(15811);let l=e=>(0,i.wz)(["frameworks","list"],"/api/v1/framework",e),a=(e,t)=>(0,i.AQ)(["frameworks",e],"/api/v1/framework",e,t),r=()=>(0,i.FF)(["frameworks"],"/api/v1/framework"),s=e=>(0,i.yt)(["frameworks"],"/api/v1/framework",e),o=()=>(0,i.TV)(["frameworks","delete"],"/api/v1/framework")},15098:function(e,t,n){"use strict";n.d(t,{CX:function(){return o},Ve:function(){return s},o0:function(){return a},xP:function(){return r},y3:function(){return l}});var i=n(15811);let l=e=>(0,i.wz)(["gits","list"],"/api/v1/git",e),a=(e,t)=>(0,i.AQ)(["gits",e],"/api/v1/git",e,t),r=e=>(0,i.FF)(["gits"],"/api/v1/git",e),s=e=>(0,i.yt)(["gits"],"/api/v1/git",e),o=()=>(0,i.TV)(["gits"],"/api/v1/git")},55591:function(e,t,n){"use strict";n.d(t,{Bl:function(){return r},EL:function(){return a},Xn:function(){return s},Y4:function(){return o},fy:function(){return l}});var i=n(15811);let l=e=>(0,i.wz)(["registries","list"],"/api/v1/registry",e),a=(e,t)=>(0,i.AQ)(["registries",e],"/api/v1/registry",e,t),r=e=>(0,i.FF)(["registries"],"/api/v1/registry",e),s=e=>(0,i.yt)(["registries"],"/api/v1/registry",e),o=()=>(0,i.TV)(["registries"],"/api/v1/registry")},864:function(e,t,n){"use strict";n.d(t,{av:function(){return a},xh:function(){return l}});var i=n(15811);let l=(e,t)=>(0,i.AQ)(["workspaces",e],"/api/v1/workspace",e,t),a=e=>(0,i.FF)(["workspaces"],"/api/v1/workspace",e)},15811:function(e,t,n){"use strict";n.d(t,{AQ:function(){return p},FF:function(){return m},TV:function(){return h},wz:function(){return d},yt:function(){return g}});var i=n(26941),l=n(39831),a=n(87115),r=n(33117),s=n(46998),o=n(32699),c=n(85072),u=n(65088);let d=function(e,t){var n;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},d=(0,c.useRouter)(),p=null!==(n=d.query.access_token)&&void 0!==n?n:(0,s.getCookie)("x-auth-cookie"),m=p?{Authorization:"Bearer ".concat(p)}:{};m["Cache-Control"]="no-cache";let{pagination:g={page:1,size:20},populate:h,filter:x,sort:v="-updatedAt,-createdAt"}=a,f=new URLSearchParams(g).toString(),j=h?"populate=".concat(h):"",y=x?new URLSearchParams(x).toString():"",b="sort=".concat(v),k=(0,i.NL)(),Z=[...e];return Z.push((0,o.isEmpty)(x)?{}:x),(0,o.isEmpty)(g)||Z.push(g),(0,l.a)({refetchOnWindowFocus:!1,queryKey:Z,queryFn:async()=>{let{data:n}=await r.Z.get("".concat(u.De.NEXT_PUBLIC_API_BASE_URL).concat(t,"?").concat(y,"&").concat(b,"&").concat(j,"&").concat(f),{...a,headers:m}),{current_page:i,total_pages:l,total_items:o,page_size:c,next_page:d,prev_page:p,...g}=n,{token:h={}}=g;return h.access_token&&(0,s.setCookie)("x-auth-cookie",h.access_token),{list:n.data.map(t=>(k.setQueryData([e[0],t._id],t),k.setQueryData([e[0],t.slug],t),k.setQueryData([e[0],{slug:t.slug}],t),{...t,key:t._id}))||[],pagination:{current_page:i,total_pages:l,total_items:o,page_size:c,next_page:d,prev_page:p}}}})},p=function(e,t,n){var i;let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},d=(0,c.useRouter)(),p=null!==(i=d.query.access_token)&&void 0!==i?i:(0,s.getCookie)("x-auth-cookie"),m=p?{Authorization:"Bearer ".concat(p)}:{};m["Cache-Control"]="no-cache";let{populate:g,filter:h={}}=a;h.slug=n;let x=g?"populate=".concat(g):"",v=new URLSearchParams(h).toString();return(0,l.a)({enabled:null!=n,queryKey:e,queryFn:async()=>{let e="".concat(u.De.NEXT_PUBLIC_API_BASE_URL).concat(t,"?").concat(v,"&").concat(x),{data:n}=await r.Z.get(e,{...a,headers:m}),{token:i={}}=n;return(i.access_token&&(0,s.setCookie)("x-auth-cookie",i.access_token),(0,o.isArray)(n.data))?n.data.map(e=>({...e,key:e._id}))[0]:(0,o.isString)(n.data)?n.data:n.data[0]}})},m=function(e,t){var n;let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=(0,c.useRouter)(),d=(0,i.NL)(),p=null!==(n=o.query.access_token)&&void 0!==n?n:(0,s.getCookie)("x-auth-cookie"),m=p?{Authorization:"Bearer ".concat(p)}:{};m["Cache-Control"]="no-cache";let g=(0,a.D)({mutationFn:async e=>{let n="".concat(u.De.NEXT_PUBLIC_API_BASE_URL).concat(t),{data:i}=await r.Z.post(n,e,{...l,headers:m});return i.data},onMutate:async t=>(await d.cancelQueries({queryKey:e}),t),onSuccess:(t,n,i)=>{d.invalidateQueries({queryKey:[e[0],"list"]})}}),{mutateAsync:h,status:x}=g;return[h,x]},g=function(e,t){var n;let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=(0,c.useRouter)(),d=(0,i.NL)(),p=null!==(n=o.query.access_token)&&void 0!==n?n:(0,s.getCookie)("x-auth-cookie"),m=p?{Authorization:"Bearer ".concat(p)}:{};m["Cache-Control"]="no-cache";let{pagination:g={page:1,size:20},populate:h,sort:x="-createdAt",filter:v}=l,f=new URLSearchParams(g).toString(),j=v?new URLSearchParams(v).toString():"",y="".concat(u.De.NEXT_PUBLIC_API_BASE_URL).concat(t,"?").concat(j,"&").concat("sort=".concat(x),"&").concat(h?"populate=".concat(h):"","&").concat(f),b=(0,a.D)({mutationFn:async e=>{let{data:t}=await r.Z.patch(y,e,{...l,headers:m});return t.data},onSuccess:(t,n,i)=>{d.invalidateQueries({queryKey:[e[0],"list"]})},onSettled:(e,t,n,i)=>{}});return[b.mutateAsync,b.status]},h=function(e,t){var n;let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=(0,c.useRouter)(),d=(0,i.NL)(),p=null!==(n=o.query.access_token)&&void 0!==n?n:(0,s.getCookie)("x-auth-cookie"),m=p?{Authorization:"Bearer ".concat(p)}:{};m["Cache-Control"]="no-cache";let g=(0,a.D)({mutationFn:async e=>{let n=new URLSearchParams(e).toString(),i="".concat(u.De.NEXT_PUBLIC_API_BASE_URL).concat(t,"?").concat(n),{data:a}=await r.Z.delete(i,{...l,headers:m});return a},onSuccess:t=>(d.invalidateQueries({queryKey:[e[0],"list"]}),t)}),{mutateAsync:h,status:x}=g;return[h,x]}},40028:function(e,t,n){"use strict";var i=n(11527);let l=e=>(0,i.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 ".concat(e.className),children:e.children});t.Z=l},40223:function(e,t,n){"use strict";n.d(t,{q:function(){return c}});var i=n(11527),l=n(84686),a=n(74637),r=n.n(a);n(50959);let s=n(64814),o=n(54498);r().extend(o),r().extend(s);let c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{date:t}=e;return(0,i.jsx)(l.Z,{title:r()(t).format("LLL"),children:(0,i.jsx)("span",{children:t?r()(t).fromNow():"-"})})}},67756:function(e,t,n){"use strict";n.d(t,{O:function(){return k}});var i=n(11527),l=n(38988),a=n(86051),r=n(13150),s=n(74637),o=n.n(s),c=n(14383),u=n(32699),d=n(50959),p=n(55282),m=n.n(p),g=n(19021),h=n(65143),x=n(65088);let v=n(33939),f=n(64814),j=n(54498);o().extend(j),o().extend(f);let y="command failed with exit code 1",b=e=>m()("".concat(e).replace(/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/g,"")),k=e=>{let{slug:t}=e,[n]=(0,h.o)(),{build_slug:s}=n,{data:o="",isLoading:p}=(0,g.wl)(null!=t?t:s),m=b(o),f=m.split("\n").map((e,t)=>e.toString()),j=x.De.NEXT_PUBLIC_API_BASE_URL,[k,Z]=(0,d.useState)(["Connecting..."]),[w,C]=(0,d.useState)("in_progress"),[S,_]=(0,d.useState)(!1),{token:{colorText:P}}=a.Z.useToken();return(0,d.useEffect)(()=>{(0,u.isEmpty)(o)||Z(f)},[f.length]),(0,d.useEffect)(()=>{let e=o.toString().toLowerCase();if((e.indexOf("finished deploying")>-1||e.indexOf(y)>-1||e.indexOf("[error]")>-1)&&_(!0),e.indexOf("finished deploying")>-1&&C("success"),(e.indexOf(y)>-1||e.indexOf("[error]")>-1)&&C("failed"),!s)return()=>!1;console.log('[socket] connecting to "'.concat(s,'" room...'));let t=v(j,{transports:["websocket"]});return t.on("connect",()=>{console.log("[socket] connected:",t.connected,"(ROOM: ".concat(s,")")),t.emit("join",{room:s}),t.on("message",e=>{let{action:n,message:i}=e;console.log("[socket] message:",{action:n,message:i}),i&&(Z(e=>[...e,b(i)]),((null==i?void 0:i.toLowerCase().indexOf(y))>-1||(null==i?void 0:i.toLowerCase().indexOf("[error]"))>-1)&&(C("failed"),_(!0))),"end"===n&&(t.disconnect(),_(!0),C("success"))})}),t.on("disconnect",()=>{console.log("[socket] disconnected !"),Z(e=>[...e,"Disconnected with build server."])}),()=>{t.connected&&(console.log("[socket] disconnecting..."),t.disconnect()),Z([])}},[o,s]),(0,i.jsxs)("div",{style:{color:P},children:["failed"===w&&(0,i.jsx)("h2",{className:"text-xl text-red-600",children:"Build lỗi rồi m\xe1 ơi!"}),"success"===w&&(0,i.jsx)("h2",{className:"text-xl text-green-600",children:"Build th\xe0nh c\xf4ng rồi, đỉnh qu\xe1 idol ơi!"}),(0,i.jsxs)(r.Z,{children:["in_progress"===w&&(0,i.jsx)(r.Z.Item,{dot:(0,i.jsx)(l.Z,{}),children:"Building..."},"message-spin"),k.filter(e=>""!==e).reverse().map((e,t)=>"".concat(e).toLowerCase().indexOf("error")>-1?(0,i.jsx)(r.Z.Item,{className:"text-red-600",children:(0,c.ZP)("".concat(e))},"message-".concat(t)):(0,i.jsx)(r.Z.Item,{children:(0,c.ZP)("".concat(e))},"message-".concat(t)))]})]})}},65143:function(e,t,n){"use strict";n.d(t,{o:function(){return a}});var i=n(85072),l=n(50959);let a=()=>{let e=(0,i.useRouter)(),t=e.asPath,n=new URLSearchParams(e.asPath.split("?")[1]),a=Object.fromEntries(n),[r,s]=(0,l.useState)(a),o=t=>{let n={...r};return t.forEach(e=>{delete n[e]}),s(n),e.push(e.pathname,{query:n}),r},c=()=>{let e=Object.keys(r);return o(e)};return(0,l.useEffect)(()=>{if(e.isReady){if(-1===t.indexOf("?")){c();return}s(a)}},[e.asPath,e.isReady]),[r,{setQuery:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={...r,...t};return s(n),e.push("".concat(e.pathname),{query:n}),n},deleteQuery:o,deleteAllQueryKeys:c}]}},78608:function(e,t,n){"use strict";n.d(t,{c:function(){return r}});var i=n(864),l=n(65143),a=n(50959);let r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,[t]=a.useState(()=>{try{var t,n;return null==window?void 0:null===(t=window.location)||void 0===t?void 0:null===(n=t.hostname)||void 0===n?void 0:n.split(".")[e]}catch(e){console.error(e.message);return}});return t}(),[{workspace:n}]=(0,l.o)(),r="app"===t||"localhost"===t||"diginext"===t?e.name:null!=n?n:t,{data:s}=(0,i.xh)(r);return s}},15953:function(e,t,n){"use strict";n.d(t,{o:function(){return te}});var i,l=n(11527),a=n(56658),r=n(86051),s=n(76663),o=n(75164),c=n(43536),u=n(85072),d=n(50959),p=n(44649),m=n(95382),g=n(26417),h=n(50630),x=n(76057),v=n(75202),f=n(10502),j=n(57034),y=n(24712),b=n(20305),k=n(40267),Z=n(463),w=n(22064),C=n(33158),S=n(15190),_=n(61984),P=n(32699),E=n.n(P),N=n(73235),A=n.n(N);let R=(0,d.createContext)({sidebarCollapsed:!1}),I=()=>{let e=(0,d.useContext)(R);return e};var L=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,n]=(0,d.useState)(!1),i=e=>void 0!==e?n(e):n(e=>!e);return(0,l.jsx)(R.Provider,{value:{sidebarCollapsed:t,toggleSidebar:i},children:e.children})};let F=[{key:"menu/",icon:(0,l.jsx)(p.Z,{}),label:"Dashboard"},{key:"menu/project",icon:(0,l.jsx)(m.Z,{}),label:"Projects"},{key:"menu/framework",icon:(0,l.jsx)(g.Z,{}),label:"Frameworks"},{key:"menu/git",icon:(0,l.jsx)(h.Z,{}),label:"Git Providers"},{key:"menu/infrastructure",icon:(0,l.jsx)(x.Z,{}),label:"Infrastructure",children:[{key:"menu/infrastructure/cloud-provider",icon:(0,l.jsx)(v.Z,{}),label:"Cloud Providers"},{key:"menu/infrastructure/cluster",icon:(0,l.jsx)(f.Z,{}),label:"K8S Clusters"},{key:"menu/infrastructure/database",icon:(0,l.jsx)(j.Z,{}),label:"Databases"},{key:"menu/infrastructure/registry",icon:(0,l.jsx)(y.Z,{}),label:"Container Registries"}]},{key:"menu/workspace",icon:(0,l.jsx)(b.Z,{}),label:"Workspace",children:[{key:"menu/workspace/users",icon:(0,l.jsx)(k.Z,{}),label:"Users"},{key:"menu/workspace/teams",icon:(0,l.jsx)(Z.Z,{}),label:"Teams"},{key:"menu/workspace/roles",icon:(0,l.jsx)(w.Z,{}),label:"Roles"},{key:"menu/workspace/settings",icon:(0,l.jsx)(C.Z,{}),label:"Settings"}]}],T=()=>{let e=(0,u.useRouter)(),{sidebarCollapsed:t,toggleSidebar:n}=I(),{isDarkMode:i}=(0,o.vs)(),a="menu/".concat((0,P.trimStart)(e.pathname,"/").split("/")[0]),r="menu".concat((0,P.trimEnd)(e.pathname,"/")),s=t=>{let n=(0,P.trimStart)(t.key,"menu");e.push(n)};return(0,l.jsxs)(_.ZP,{theme:"light",collapsible:!0,collapsed:t,onCollapse:e=>n&&n(e),style:{overflow:"auto",height:"100vh",position:"fixed",left:0,top:0,bottom:0},children:[t?(0,l.jsx)("div",{className:"mx-auto my-5 w-[32px]",children:(0,l.jsx)(A(),{href:"/",children:(0,l.jsx)("img",{src:i?"".concat(e.basePath,"/assets/images/diginext-icon-white.svg"):"".concat(e.basePath,"/assets/images/diginext-icon-black.svg"),alt:"Diginext Logo"})})}):(0,l.jsx)("div",{className:"mx-auto my-5 w-36",children:(0,l.jsx)(A(),{href:"/",children:(0,l.jsx)("img",{src:i?"".concat(e.basePath,"/assets/images/diginext_logo_white.svg"):"".concat(e.basePath,"/assets/images/diginext_logo.svg"),alt:"Diginext Logo"})})}),(0,l.jsx)(S.Z,{mode:"inline",inlineCollapsed:t,defaultOpenKeys:[a],defaultSelectedKeys:[a,r],items:F,onSelect:s})]})};var U=n(92455),B=n(54712),D=n(31388),O=n(70892),z=n(64394),V=n(47605),q=n(65143),X=n(22134);let M=(0,d.createContext)({drawerVisibility:{lv1:!1,lv2:!1},toggleDrawer:(e,t)=>{},showDrawer:(e,t)=>{},closeDrawer:e=>{}}),Q=()=>{let e=(0,d.useContext)(M);return e};var H=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,n]=(0,d.useState)({lv1:!1,lv2:!1}),[i,a]=(0,d.useState)(),[r,s]=(0,d.useState)(),o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"lv1",t=arguments.length>1?arguments[1]:void 0;return void 0!==t?n(n=>{let i={...n};return i[e]=t,i}):n(t=>{let n={...t};return n[e]=!t[e],n})},c=e=>{e?o(e,!1):n({lv1:!1,lv2:!1})},u=()=>{n(e=>({...e,lv1:!1}))},p=()=>{n(e=>({...e,lv2:!1}))},m=(e,t)=>{switch(null==t?void 0:t.level){case 1:a(e),o("lv1",!0);break;case 2:s(e),o("lv2",!0)}};return(0,l.jsxs)(M.Provider,{value:{drawerVisibility:t,toggleDrawer:o,showDrawer:m,closeDrawer:c},children:[e.children,(0,l.jsxs)(X.Z,{title:null==i?void 0:i.title,placement:"right",onClose:u,open:t.lv1,size:"large",bodyStyle:{overflow:"hidden",padding:0},destroyOnClose:!0,children:[null==i?void 0:i.content,(0,l.jsx)(X.Z,{title:null==r?void 0:r.title,placement:"right",onClose:p,open:t.lv2,size:"large",destroyOnClose:!0,children:null==r?void 0:r.content})]})]})},W=n(1090),K=n(38988),Y=n(21160),G=n(8983),$=n(21303),J=n(48761),ee=n(70304),et=n(91330),en=n(57399);let ei=e=>{let{compact:t=!1,icon:n,name:i,setValue:a,initialValue:r}=e,s=D.Z.useFormInstance(),o=()=>s.submit(),c=()=>{s.setFieldValue(i,r),a(r)},u=()=>{s.setFieldValue(i,""),a("")};return(0,l.jsxs)(O.Z,{size:t?4:8,children:[(0,l.jsx)(z.ZP,{type:"primary",icon:t&&(0,l.jsx)(Y.Z,{}),onClick:()=>o(),children:!t&&"Save"}),(0,l.jsx)(z.ZP,{icon:t&&(0,l.jsx)(et.Z,{}),onClick:()=>u(),children:!t&&"Clear"}),(0,l.jsx)(z.ZP,{danger:!0,icon:t&&(0,l.jsx)(en.Z,{}),onClick:()=>c(),children:!t&&"Reset"})]})},el=e=>{let t;let{label:n,postLabel:i,name:a,required:r=!1,requiredMessage:s="Please input your ".concat(n),defaultValue:c,initialValue:u,value:p,status:m,autoSave:g=!1,isNew:h,lang:x=[],height:v="350px",disabled:f=!1}=e,j=D.Z.useFormInstance(),[y,b]=(0,d.useState)(null!=p?p:c),k=(0,o.Nr)(y,500),Z=e=>{j.setFieldValue(a,e),b(e)},w=()=>j.submit();return(0,d.useEffect)(()=>{j.setFieldValue(a,p),b(p)},[p]),(0,d.useEffect)(()=>{k!==p&&g&&!h&&w()},[k]),m&&"error"===m[a]&&(t=(0,l.jsx)(W.Z,{})),m&&"loading"===m[a]&&(t=(0,l.jsx)(K.Z,{})),m&&"success"===m[a]&&(t=(0,l.jsx)(Y.Z,{color:"green"})),(0,l.jsx)(D.Z.Item,{label:(0,l.jsxs)(O.Z,{size:"small",children:[n,t]}),name:a,rules:[{required:r,message:s}],children:(0,l.jsxs)(O.Z,{direction:"vertical",className:"w-full",children:[(0,l.jsx)(ee.ZP,{height:v,theme:J.M_,extensions:[...x.map(e=>$.RI[e]()),(0,G.X)({})],onChange:Z,value:y,editable:!f}),i,!g&&!h&&(0,l.jsx)(ei,{initialValue:u,name:a,setValue:b,icon:t})]})})};var ea=n(75873);let er=e=>{let t;let{label:n,postLabel:i,name:a,required:r=!1,requiredMessage:s="Please input your ".concat(n),defaultValue:c,initialValue:u,value:p,status:m,autoSave:g=!0,isNew:h,placeholder:x,disabled:v=!1}=e,f=D.Z.useFormInstance(),[j,y]=(0,d.useState)(null!=p?p:c),b=(0,o.Nr)(j,500),k=e=>{let t=e.currentTarget.value;f.setFieldValue(a,t),y(t)},Z=()=>f.submit();return(0,d.useEffect)(()=>{f.setFieldValue(a,p),y(p)},[p]),(0,d.useEffect)(()=>{b!==p&&g&&!h&&Z()},[b]),m&&"error"===m[a]&&(t=(0,l.jsx)(W.Z,{})),m&&"loading"===m[a]&&(t=(0,l.jsx)(K.Z,{})),m&&"success"===m[a]&&(t=(0,l.jsx)(Y.Z,{color:"green"})),(0,l.jsx)(D.Z.Item,{label:(0,l.jsxs)(O.Z.Compact,{direction:"vertical",children:[(0,l.jsxs)(O.Z,{size:"small",children:[n,t]}),i]}),name:a,rules:[{required:r,message:s}],children:(0,l.jsxs)(O.Z,{direction:"vertical",className:"w-full",children:[(0,l.jsx)(ea.Z,{placeholder:x,onChange:k,value:j,disabled:v}),!g&&!h&&(0,l.jsx)(ei,{initialValue:u,name:a,setValue:y,icon:t})]})})};var es=n(63965);let eo=e=>{let t;let{className:n,style:i,label:a,postLabel:r,name:s,required:c=!1,requiredMessage:u="Please input your ".concat(a),defaultValue:p,initialValue:m,value:g,status:h,autoSave:x=!0,isNew:v,options:f,disabled:j=!1}=e,y=D.Z.useFormInstance(),[b,k]=(0,d.useState)(null!=g?g:p),Z=(0,o.Nr)(b,500);console.log("_value :>> ",b);let w=e=>{y.setFieldValue(s,e),k(e)},C=()=>y.submit();return(0,d.useEffect)(()=>{console.log("value :>> ",g),y.setFieldValue(s,g),k(g)},[g]),(0,d.useEffect)(()=>{Z!==g&&x&&!v&&C()},[Z]),h&&"error"===h[s]&&(t=(0,l.jsx)(W.Z,{})),h&&"loading"===h[s]&&(t=(0,l.jsx)(K.Z,{})),h&&"success"===h[s]&&(t=(0,l.jsx)(Y.Z,{color:"green"})),(0,l.jsx)(D.Z.Item,{label:(0,l.jsxs)(O.Z,{size:"small",children:[a,t]}),name:s,rules:[{required:c,message:u}],children:(0,l.jsxs)(O.Z,{direction:"horizontal",className:"w-full",children:[(0,l.jsx)(es.Z,{className:n,style:i,value:b,onChange:w,options:f,disabled:j}),r,!x&&!v&&(0,l.jsx)(ei,{initialValue:m,name:s,setValue:k,icon:t})]})})},{TextArea:ec}=ea.Z,eu=e=>{let t;let{label:n,postLabel:i,name:a,required:r=!1,requiredMessage:s="Please input your ".concat(n),defaultValue:c,initialValue:u,value:p,status:m,autoSave:g=!0,isNew:h,disabled:x=!1}=e,v=D.Z.useFormInstance(),[f,j]=(0,d.useState)(null!=p?p:c),y=(0,o.Nr)(f,500),b=e=>{let t=e.currentTarget.value;v.setFieldValue(a,t),j(t)},k=()=>v.submit();return(0,d.useEffect)(()=>{v.setFieldValue(a,p),j(p)},[p]),(0,d.useEffect)(()=>{y!==p&&g&&!h&&k()},[y]),m&&"error"===m[a]&&(t=(0,l.jsx)(W.Z,{})),m&&"loading"===m[a]&&(t=(0,l.jsx)(K.Z,{})),m&&"success"===m[a]&&(t=(0,l.jsx)(Y.Z,{color:"green"})),(0,l.jsx)(D.Z.Item,{label:(0,l.jsxs)(O.Z,{size:"small",children:[n,t]}),name:a,rules:[{required:r,message:s}],children:(0,l.jsxs)(O.Z,{direction:"vertical",className:"w-full",children:[(0,l.jsx)(ec,{rows:3,onChange:b,value:f,disabled:x}),i,!g&&!h&&(0,l.jsx)(ei,{compact:!0,initialValue:u,name:a,setValue:j,icon:t})]})})},ed=e=>{var t;let{name:n,configs:i=[]}=e,{data:a}=(null===(t=e.api)||void 0===t?void 0:t.useSlugApi)||{},{useCreateApi:s,useUpdateApi:o}=e.api||{},[c,u]=o||[],[p,m]=s||[],[g,{deleteAllQueryKeys:h}]=(0,q.o)(),[x]=D.Z.useForm(),[v,f]=(0,d.useState)(),j=void 0===a,{token:{colorBgContainer:y}}=r.Z.useToken(),{closeDrawer:b}=Q(),k=async e=>{let t;console.log(j?"[NEW]":"[UPDATE]","Submit:",e);let n={...e};if(j)Object.entries(n).forEach(e=>{let[t,i]=e;t.indexOf(".")>-1&&(delete n[t],E().set(n,t,i))}),p&&(t=await p(n)),console.log("[NEW] result :>> ",t),b();else{let e={};Object.entries(n).forEach(t=>{let[i,l]=t;a&&l!==a[i]?e[i]="loading":(delete e[i],delete n[i])}),console.log("statuses :>> ",e),f(e),(0,P.isEmpty)(e)?console.log("[UPDATE] Skipped, nothing new to update."):(c&&(t=await c(n)),console.log("[UPDATE] result :>> ",t))}},Z=e=>{console.log("Failed:",e)};return(0,d.useEffect)(()=>{if(void 0===v)return;let e=Object.keys(v),t={};e.forEach(e=>{t[e]=u}),f(t)},[u]),(0,l.jsxs)(D.Z,{className:"h-full overflow-auto",layout:"vertical",form:x,onFinish:k,onFinishFailed:Z,autoComplete:"off",children:[(0,l.jsx)("div",{className:"p-6 pb-16",children:i.map(e=>{switch(e.type){case"input":return(0,l.jsx)(er,{...e,value:a&&E().get(a,e.name),status:v,isNew:j},"".concat(n,"-").concat(e.name));case"textarea":return(0,l.jsx)(eu,{...e,value:a&&E().get(a,e.name),status:v,isNew:j},"".concat(n,"-").concat(e.name));case"code-editor":return(0,l.jsx)(el,{...e,value:a&&E().get(a,e.name),status:v,isNew:j},"".concat(n,"-").concat(e.name));case"select":{let{selectedKey:t}=e;return void 0===t&&(t="_id"),(0,l.jsx)(eo,{...e,style:{minWidth:300,...null==e?void 0:e.style},value:a&&E().get(a,""===t?e.name:"".concat(e.name,".").concat(t)),status:v,isNew:j},"".concat(n,"-").concat(e.name))}default:return null}})}),j&&(0,l.jsx)("div",{className:"fixed bottom-0 w-full px-6 py-3",style:{backgroundColor:y},children:(0,l.jsxs)(O.Z,{children:[(0,l.jsx)(D.Z.Item,{style:{marginBottom:0},children:(0,l.jsx)(z.ZP,{type:"primary",htmlType:"submit",children:"Submit"})}),(0,l.jsx)(V.Z,{title:"Are you sure?",onConfirm:()=>h(),okText:"Yes",cancelText:"No",children:(0,l.jsx)(z.ZP,{type:"primary",danger:!0,children:"Discard"})})]})})]})};var ep=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let[{cluster_slug:e}]=(0,q.o)(),t=(0,B.pD)(e,{populate:"owner,provider"}),{data:n}=t,i=(0,B.ve)({filter:{id:null==n?void 0:n._id}}),a=(0,B.CN)(),{data:{list:r=[]}={}}=(0,U.nu)(),s=[{type:"input",label:"Name",name:"name",placeholder:"Cluster name"},{type:"input",label:"Short name",name:"shortName",placeholder:"Short name"},{type:"select",label:"Cloud Provider",name:"provider",placeholder:"Cloud Provider",options:r.map(e=>({label:e.name||"",value:e._id}))},{type:"input",label:"Primary IP",name:"primaryIP",placeholder:"192.168.10.50"},{type:"input",label:"Primary domain",name:"primaryDomain",placeholder:"example.com"},{type:"input",label:"Project ID (Google)",name:"projectID",placeholder:"my-project-id"},{type:"input",label:"Region (Google)",name:"region",placeholder:"asia-southeast1"},{type:"input",label:"Zone (Google)",name:"zone",placeholder:"asia-southeast1-a"},{type:"code-editor",lang:["yaml"],label:"KubeConfig (YAML)",name:"kubeConfig"},{type:"textarea",label:"API Access Token",name:"apiAccessToken"},{type:"code-editor",lang:["json"],label:"Service Account (JSON)",name:"serviceAccount"}];return(0,l.jsx)(ed,{name:"cluster",api:{useSlugApi:t,useUpdateApi:i,useCreateApi:a},configs:s})},em=n(18934),eg=n(15098),eh=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let[{framework_slug:e}]=(0,q.o)(),t=(0,em.FX)(e,{populate:"owner,git"}),{data:n}=t,i=(0,em.fR)({filter:{id:null==n?void 0:n._id}}),a=(0,em.D$)(),{data:{list:r=[]}={}}=(0,eg.y3)(),s=[{type:"input",label:"Name",name:"name",placeholder:"My Starter Template"},{type:"select",label:"Git Provider",name:"git",style:{width:250},options:r.map(e=>({label:e.name||"",value:e._id}))},{type:"input",label:"Repository HTTPS URL",name:"repoURL",placeholder:"https://github.com/user/repo.git"},{type:"input",label:"Repository SSH URL",name:"repoSSH",placeholder:"git@github.com:user/repo.git"},{type:"input",label:"Main branch",name:"mainBranch",placeholder:"main"}];return(0,l.jsx)(ed,{name:"framework",api:{useSlugApi:t,useUpdateApi:i,useCreateApi:a},configs:s})},ex=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let[{git_provider_slug:e}]=(0,q.o)(),t=(0,eg.o0)(e,{populate:"owner"}),{data:n}=t,i=(0,eg.Ve)({filter:{id:null==n?void 0:n._id}}),a=(0,eg.xP)();return(0,l.jsx)(ed,{name:"gitProvider",api:{useSlugApi:t,useUpdateApi:i,useCreateApi:a},configs:[{type:"input",label:"Name",name:"name",placeholder:"Github"},{type:"input",label:"Host",name:"host",placeholder:"github.com"},{type:"input",label:"Workspace name",name:"gitWorkspace",placeholder:"https://github.com/user/repo.git"},{type:"input",label:"Workspace URL",name:"repo.url",placeholder:"git@github.com:user/repo.git"},{type:"input",label:"Workspace SSH Prefix",name:"repo.sshPrefix",placeholder:"main"}]})},ev=n(55591),ef=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];let[{registry_slug:e}]=(0,q.o)(),t=(0,ev.EL)(e,{populate:"owner"}),{data:n}=t,i=(0,ev.Xn)({filter:{id:null==n?void 0:n._id}}),a=(0,ev.Bl)(),{data:{list:r=[]}={}}=(0,U.nu)(),s=[{type:"input",label:"Name",name:"name",placeholder:"My Container Registry"},{type:"select",label:"Cloud Provider",name:"provider",style:{width:250},selectedKey:"",options:r.map(e=>({label:e.name||"",value:e.shortName}))},{type:"input",label:"Host",name:"host",placeholder:"asia.gcr.io"},{type:"input",label:"Docker Image URL Prefix",name:"imageBaseURL",placeholder:"asia.gcr.io/google-project-id"},{type:"input",label:"Image Pull Secret's Name",name:"imagePullingSecret.name",placeholder:"my-docker-secret-name"},{type:"textarea",label:"Image Pull Secret's Value",name:"imagePullingSecret.value",placeholder:"my-docker-secret-value"}];return(0,l.jsx)(ed,{name:"registry",api:{useSlugApi:t,useUpdateApi:i,useCreateApi:a},configs:s})};let ej=()=>{let e;let[{type:t}]=(0,q.o)();switch(t){case"cluster":e=(0,l.jsx)(ep,{});break;case"framework":e=(0,l.jsx)(eh,{});break;case"git-provider":e=(0,l.jsx)(ex,{});break;case"registry":e=(0,l.jsx)(ef,{})}return(0,l.jsx)("div",{className:"h-full",children:e})};var ey=n(65088);let eb=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,l.jsxs)("div",{children:[e.children,(0,l.jsxs)("div",{className:"border-t border-gray-300 py-8 text-center text-xs",children:["\xa9 Copyright ",new Date().getFullYear()," ",ey.XL.title,". Powered by ",(0,l.jsx)("a",{href:"https://wearetopgroup.com",children:"TOP GROUP"}),"."]})]})};var ek=n(70813),eZ=n(94647),ew=n(92768),eC=n(51485),eS=n(38085),e_=n(4471),eP=n(14584),eE=n(88977);let{Header:eN}=c.Z,eA=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{onSidebarChange:t}=e,{isDarkMode:n,toggle:i}=(0,o.vs)(),[a]=(0,eE.aC)(),{token:{colorBgContainer:s}}=r.Z.useToken(),{sidebarCollapsed:c,toggleSidebar:u}=I();return(0,d.useEffect)(()=>t&&t(c),[c]),(0,l.jsx)(eN,{className:"w-full",style:{position:"sticky",top:0,paddingInline:24,lineHeight:"48px",height:48,zIndex:100,background:s},children:(0,l.jsxs)("div",{className:"flex ",children:[(0,l.jsx)("div",{className:"grow",children:d.createElement(c?ek.Z:eZ.Z,{className:"trigger",onClick:()=>u&&u()})}),(0,l.jsxs)(O.Z,{size:4,children:[(0,l.jsx)(z.ZP,{type:"text",icon:(0,l.jsx)(ew.Z,{})}),(0,l.jsx)(z.ZP,{type:"text",icon:(0,l.jsx)(eC.Z,{})}),(0,l.jsx)(z.ZP,{type:"text",style:{fontSize:18,verticalAlign:"middle",paddingTop:0},onClick:i,icon:n?(0,l.jsx)("i",{className:"ri-sun-line inline-block"}):(0,l.jsx)("i",{className:"ri-moon-line inline-block"})}),(0,l.jsx)(e_.Z,{placement:"bottomRight",trigger:"click",content:(0,l.jsxs)(O.Z,{direction:"vertical",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("p",{className:"mb-0",children:(0,l.jsx)("strong",{children:null==a?void 0:a.name})}),(0,l.jsx)("p",{className:"mb-0",children:null==a?void 0:a.email})]}),(0,l.jsxs)(O.Z.Compact,{direction:"vertical",className:"w-full",children:[(0,l.jsx)(z.ZP,{children:"Profile"}),(0,l.jsx)(z.ZP,{href:"/logout",children:"Sign out"})]})]}),children:(0,l.jsxs)("div",{className:"cursor-pointer align-middle",children:[(0,l.jsx)(eP.C,{style:{lineHeight:"20px"},icon:(0,l.jsx)(k.Z,{style:{verticalAlign:"middle"}}),src:null==a?void 0:a.image,size:24}),(0,l.jsx)("span",{className:"ml-2 inline-block",children:null==a?void 0:a.name}),(0,l.jsx)(eS.Z,{className:"ml-2"})]})})]})]})})};var eR=n(82006),eI=n(38631),eL=n(50290),eF=n(75784),eT=n(45285),eU=n(78730),eB=n(23951),eD=n(56174),eO=n(84686),ez=n(94034),eV=n(74637),eq=n.n(eV),eX=n(19021),eM=n(15811);let eQ=e=>(0,eM.wz)(["releases","list"],"/api/v1/release",e),eH=e=>(0,eM.yt)(["releases","rollout"],"/api/v1/release/rollout",e),eW=e=>(0,eM.FF)(["releases","create"],"/api/v1/release/from-build",e),eK=e=>(0,eM.yt)(["releases","preview"],"/api/v1/release/preview",e);var eY=n(40223);let eG=n(64814),e$=n(54498);eq().extend(e$),eq().extend(eG);let{useApp:eJ}=s.Z,e0=[{title:"Name",width:70,dataIndex:"name",key:"name",filterSearch:!0,filters:[{text:"goon",value:"goon"}],onFilter:(e,t)=>t.name&&t.name.indexOf(e.toString())>-1||!0,render:(e,t)=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{children:(0,l.jsx)(A(),{href:{pathname:"/build/[...slugs]",query:{slugs:[t.slug]}},children:(0,l.jsx)("strong",{children:e})})}),(0,l.jsxs)("p",{children:["Created ",(0,l.jsx)(eY.q,{date:t.createdAt})]})]})},{title:"Created by",dataIndex:"owner",key:"owner",width:40,filterSearch:!0,filters:[{text:"goon",value:"goon"}],onFilter:(e,t)=>t.owner&&(t.owner.slug||"").indexOf(e.toString())>-1||!0,render:e=>(0,l.jsx)(l.Fragment,{children:null==e?void 0:e.name})},{title:"Status",dataIndex:"status",key:"status",width:30,filters:[{text:"live",value:"live"}],render:e=>{let t="warning",n=(0,l.jsx)(eR.Z,{});switch(e){case"building":t="processing",n=(0,l.jsx)(K.Z,{className:"align-middle"});break;case"failed":t="error",n=(0,l.jsx)(eI.Z,{className:"align-middle"});break;case"success":t="success",n=(0,l.jsx)(eL.Z,{className:"align-middle"});break;default:t="default",n=(0,l.jsx)(eR.Z,{})}return(0,l.jsx)(eD.Z,{color:t,icon:n,children:e})}},{title:"Action",key:"action",width:30,dataIndex:"action"}],e1=()=>{(0,u.useRouter)();let e=eJ(),[t,{setQuery:n}]=(0,q.o)(),{project:i,app:a,env:r}=t,s={};i&&(s.projectSlug=i),a&&(s.appSlug=a),r&&(s.env=r);let[o,c]=(0,d.useState)(1),[p,m]=(0,eX.fg)(),{data:g}=(0,eX.BY)({populate:"owner",pagination:{page:o,size:100},filter:s}),{list:h,pagination:x}=g||{},{total_items:v}=x||{},f=e=>{n({lv2:"build_logs",build_slug:e})},[j]=eW(),y=async t=>{if((0,P.isEmpty)(t)){e.notification.error({message:"Failed to release the build.",description:"Build not found: ".concat(t),placement:"top"});return}try{let n=await j({build:t});e.notification.success({message:"Congrats, the release has been created successfully!",description:(0,l.jsxs)(l.Fragment,{children:["You can now preview it on ",(0,l.jsx)("a",{href:"https://".concat(null==n?void 0:n.prereleaseUrl),children:"PRE-RELEASE"})," endpoint."]}),placement:"top"})}catch(t){console.error("Could not process releasing this build:",t),e.notification.error({message:"Failed to roll out.",description:"Could not process releasing this build: ".concat(t),placement:"top"})}},b=async t=>{let n=await p({slug:t});console.log("[BuildList] stopBuild :>> ",n),n.status||e.notification.error({message:"Failed to proceed.",description:"Could not stop this build due to server issue. Please try again later.",placement:"top"})},k=null==h?void 0:h.map(e=>({id:e._id,...e,action:(0,l.jsxs)(O.Z.Compact,{children:["building"===e.status&&(0,l.jsx)(eO.Z,{title:"Stop building",children:(0,l.jsx)(z.ZP,{danger:!0,icon:(0,l.jsx)(eF.Z,{}),onClick:()=>b(null==e?void 0:e.slug)})}),(0,l.jsx)(eO.Z,{title:"View logs",children:(0,l.jsx)(z.ZP,{icon:(0,l.jsx)(eT.Z,{}),onClick:()=>f(e.slug)})}),(0,l.jsx)(eO.Z,{title:"Open image URL",children:(0,l.jsx)(z.ZP,{icon:(0,l.jsx)(eU.Z,{}),href:"https://".concat(e.image),target:"_blank"})}),"prod"===e.env&&(0,l.jsx)(eO.Z,{title:"Roll out this build",children:(0,l.jsx)(z.ZP,{icon:(0,l.jsx)(eB.Z,{}),onClick:()=>{var t;return y(null===(t=e._id)||void 0===t?void 0:t.toString())}})})]})})),Z=e=>{let{current:t}=e;c(null!=t?t:1)};return(0,l.jsx)("div",{className:"h-full overflow-auto",children:(0,l.jsx)(ez.Z,{columns:e0,dataSource:k,scroll:{x:600},sticky:{offsetHeader:0},pagination:{current:o,pageSize:100,total:v},onChange:Z})})};var e5=n(67756);let e2=n(64814),e8=n(54498);eq().extend(e8),eq().extend(e2);let{useApp:e4}=s.Z,e3=[{title:"Name",width:70,dataIndex:"name",key:"name",filterSearch:!0,filters:[{text:"goon",value:"goon"}],onFilter:(e,t)=>t.name&&t.name.indexOf(e.toString())>-1||!0,render:(e,t)=>{var n;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("p",{children:(0,l.jsx)("strong",{children:e})}),(0,l.jsxs)("p",{children:["Author: ",null!==(i=null===(n=t.owner)||void 0===n?void 0:n.name)&&void 0!==i?i:"-",(0,l.jsx)("br",{}),"Created ",(0,l.jsx)(eY.q,{date:t.createdAt})]})]})}},{title:"Build status",dataIndex:"buildStatus",key:"buildStatus",width:30,filters:[{text:"start",value:"start"},{text:"failed",value:"failed"},{text:"success",value:"success"},{text:"building",value:"building"}],render:e=>{let t="warning",n=(0,l.jsx)(eR.Z,{});switch(e){case"building":t="processing",n=(0,l.jsx)(K.Z,{className:"align-middle"});break;case"failed":t="error",n=(0,l.jsx)(eI.Z,{className:"align-middle"});break;case"success":t="success",n=(0,l.jsx)(eL.Z,{className:"align-middle"});break;default:t="default",n=(0,l.jsx)(eR.Z,{})}return(0,l.jsx)(eD.Z,{color:t,icon:n,children:e})}},{title:"Active",dataIndex:"active",key:"active",width:20,filters:[{text:"active",value:!0}],onFilter:(e,t)=>t.active===e,render:e=>!0===e?(0,l.jsx)(eD.Z,{color:"blue",icon:(0,l.jsx)(eL.Z,{}),children:"active"}):"-"},{title:"Action",key:"action",width:30,dataIndex:"action",render:e=>e}],e6=()=>{(0,u.useRouter)();let e=e4(),[t]=(0,q.o)(),{project:n,app:i,offsetHeader:a=0,env:r="prod"}=t,s={};n&&(s.projectSlug=n),i&&(s.appSlug=i),r&&(s.env=r);let[o,c]=(0,d.useState)(1),{data:p}=eQ({populate:"owner",pagination:{page:o,size:100},filter:s}),{list:m=[],pagination:g}=p||{},{total_items:h}=g||{},[x,v]=eH();console.log("rolloutApiStatus :>> ",v);let[f,j]=(0,d.useState)(""),[y]=eK(),b=async t=>{if((0,P.isEmpty)(t)){e.notification.error({message:"Failed to roll out.",description:"Release not found: ".concat(t),placement:"top"});return}j(t);try{let n=await x({id:t});e.notification.success({message:"Congrats, the release has been rolled out successfully!",description:(0,l.jsxs)(l.Fragment,{children:["Your website is ready to access on PRODUCTION environment:"," ",(0,l.jsx)("a",{href:"https://".concat(null==n?void 0:n.productionUrl),target:"_blank",rel:"noreferrer",children:null==n?void 0:n.productionUrl})]}),placement:"top"})}catch(t){console.error("Could not process rolling out this release:",t),e.notification.error({message:"Failed to roll out.",description:"Could not process rolling out this release: ".concat(t),placement:"top"})}j("")},k=async t=>{if((0,P.isEmpty)(t)){e.notification.error({message:"Failed to preview.",description:"Release not found: ".concat(t),placement:"top"});return}try{let n=await y({id:t});e.notification.success({message:"Congrats!",description:(0,l.jsxs)(l.Fragment,{children:["The PRE-RELEASE environment has been setup successfully at:"," ",(0,l.jsx)("a",{href:"https://".concat(null==n?void 0:n.prereleaseUrl),target:"_blank",rel:"noreferrer",children:null==n?void 0:n.prereleaseUrl})]}),placement:"top"})}catch(t){e.notification.error({message:"Failed to start preview.",description:"Could not set up the pre-release environment of this release: ".concat(t),placement:"top"})}},Z=m.map(e=>({...e,id:e._id,state:""!==f?v:!0===e.active?"success":"none",action:(0,l.jsxs)(O.Z.Compact,{children:[(0,l.jsx)(eO.Z,{title:"Roll out",children:(0,l.jsx)(z.ZP,{icon:""!==f&&"loading"===v?(0,l.jsx)(K.Z,{}):(0,l.jsx)(eB.Z,{}),onClick:()=>b(e._id)})}),(0,l.jsx)(eO.Z,{title:"Preview",children:(0,l.jsx)(z.ZP,{icon:(0,l.jsx)(eU.Z,{}),onClick:()=>k(e._id),target:"_blank"})})]})}));console.log({displayedReleases:Z});let w=e=>{let{current:t}=e;c(null!=t?t:1)};return(0,l.jsx)("div",{children:(0,l.jsx)(ez.Z,{columns:e3,dataSource:Z,scroll:{x:600},sticky:{offsetHeader:a},pagination:{current:o,pageSize:100,total:h},onChange:w})})},e9=e=>{let{useSidebar:t}=e;(0,u.useRouter)();let{sidebarCollapsed:n}=I(),i="auto";t&&(i=n?80:200);let a=Q(),{drawerVisibility:s,showDrawer:o,closeDrawer:p}=a,[m,{setQuery:g,deleteQuery:h,deleteAllQueryKeys:x}]=(0,q.o)(),{lv1:v,lv2:f,type:j,slug:y,project:b,app:k,env:Z}=m,{token:{colorText:w}}=r.Z.useToken(),C=()=>{o&&o({title:"Builds",content:(0,l.jsx)(e1,{})},{level:1})},S=()=>{o&&o({title:"Releases",content:(0,l.jsx)(e6,{})},{level:1})},_=()=>{o&&o({title:"Build Logs",content:(0,l.jsx)(e5.O,{})},{level:2})},P=()=>{o&&o({title:"Edit",content:(0,l.jsx)(ej,{})},{level:1})},E=()=>{o&&o({title:"Create",content:(0,l.jsx)(ej,{})},{level:1})};return(0,d.useEffect)(()=>{switch(v){case"build":C();break;case"release":S();break;case"new":E();break;case"edit":P();break;default:p&&p("lv1")}"build_logs"===f?_():p&&p("lv2")},[v,f,b,k,Z]),(0,d.useEffect)(()=>{(null==s?void 0:s.lv1)===!1&&h(["lv1","project","app","release","type","cluster_slug","framework_slug","git_provider_slug","registry_slug"])},[null==s?void 0:s.lv1]),(0,d.useEffect)(()=>{(null==s?void 0:s.lv2)===!1&&h(["lv2","build_slug"])},[null==s?void 0:s.lv2]),(0,l.jsxs)(c.Z,{hasSider:!0,children:[e.meta,t&&(0,l.jsx)(T,{}),(0,l.jsxs)(c.Z,{className:"min-h-screen transition-all",style:{marginLeft:i},children:[t&&(0,l.jsx)(eA,{}),(0,l.jsx)("div",{className:"grow px-2",children:e.children}),(0,l.jsx)(eb,{})]})]})};function e7(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{components:t=[],children:n,...i}=e;return(0,l.jsx)(l.Fragment,{children:t.reduceRight((t,n)=>(0,d.createElement)(n,{...i,key:e.key},t),n)})}let te=e=>{let{isDarkMode:t}=(0,o.vs)(),{useSidebar:n=!0}=e;return(0,l.jsx)(a.ZP,{theme:{hashed:!1,algorithm:t?r.Z.darkAlgorithm:r.Z.defaultAlgorithm},children:(0,l.jsx)(s.Z,{children:(0,l.jsx)(e7,{components:[L,H],children:(0,l.jsx)(e9,{meta:e.meta,useSidebar:n,children:e.children})})})})}},65088:function(e,t,n){"use strict";n.d(t,{De:function(){return o},XL:function(){return s},r8:function(){return c}});var i=n(64543),l=n(32699),a=n(74576);let r={DEVELOPMENT:"development",STAGING:"staging",CANARY:"canary",PRODUCTION:"production"},s={site_name:"Diginext Admin",title:"Diginext Admin",description:"Welcome to an Admin Panel of Diginext.",locale:"en",tableConfig:{defaultPageSize:50}};class o{static get ENV(){return this.grab("NODE_ENV","development").toUpperCase()}static get NEXT_PUBLIC_BASE_PATH(){return""}static getBasePath(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{NEXT_PUBLIC_BASE_PATH:t}=this;return(""===t?t:"/".concat(t))+e}static path(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.getBasePath(e)}static get NEXT_PUBLIC_ENV(){return"production"}static get NEXT_PUBLIC_API_BASE_URL(){return(0,l.trimEnd)("https://api.diginext.site","/")||"/"}static get NEXT_PUBLIC_DOMAIN(){return"diginext.site"}static get NEXT_PUBLIC_BASE_URL(){return(0,l.trimEnd)("https://app.diginext.site","/")||"/"}static get DISABLE_INPECT_MEMORY(){return(0,i.AM)(this.grab("DISABLE_INPECT_MEMORY"))}static get SECONDS_INPECT_MEMORY(){return(0,i.Hq)(this.grab("SECONDS_INPECT_MEMORY"))}static get CORS_WHITELIST(){return a.env.CORS_WHITELIST?a.env.CORS_WHITELIST.split(";"):["localhost","192.168","127.0","digitop.vn","diginext.site","diginext.vn"]}}o.grab=function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i={...a.env};return null!==(t=i[e])&&void 0!==t?t:n};let c=()=>o.NEXT_PUBLIC_ENV===r.DEVELOPMENT},72610:function(){},61596:function(){},89858:function(){},36431:function(){}}]);