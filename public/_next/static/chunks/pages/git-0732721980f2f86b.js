(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[155],{18094:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/git",function(){return s(78545)}])},78545:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return es}});var n,l=s(11527),a=s(71369),i=s(44053),r=s(78177),o=s(34153),c=s(58699),d=s(99104),u=s(50959),x=s(77665),g=s(44064),p=s(70861),h=s(32105),m=s(38101),j=s(3513),v=s(17671),Z=s(31620),f=s(97088),k=s(50267),b=s(48747),y=s(88758),w=s(5433),C=s(88571),S=s(32699),_=s(95420),N=s(91003),P=s(83103),F=s(95065),T=s(87175);let I=e=>{let{next:t}=e,[s]=(0,_.xP)(),n=async e=>{console.log("Success:",e);let n=await s({type:"bitbucket",bitbucket_oauth:e});n&&t&&n.data.slug&&t(n.data.slug)},a=e=>{console.log("Failed:",e)};return(0,l.jsxs)(F.Z,{name:"app-password",labelCol:{span:6},wrapperCol:{span:18},style:{maxWidth:600},onFinish:n,onFinishFailed:a,autoComplete:"off",children:[(0,l.jsx)(F.Z.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"}],children:(0,l.jsx)(T.Z,{prefix:(0,l.jsx)(j.Z,{}),placeholder:"Username"})}),(0,l.jsx)(F.Z.Item,{label:"App password",name:"app_password",rules:[{required:!0,message:"Please input app password!"}],children:(0,l.jsx)(T.Z.Password,{prefix:(0,l.jsx)(N.Z,{})})}),(0,l.jsx)(F.Z.Item,{wrapperCol:{offset:6,span:18},children:(0,l.jsx)(c.ZP,{type:"primary",htmlType:"submit",icon:(0,l.jsx)(P.Z,{}),children:"Connect"})})]})},W=e=>{let{next:t}=e,[s]=(0,_.xP)(),n=async e=>{console.log("Success:",e);let n=await s({type:"github",github_oauth:{personal_access_token:e.access_token}});n&&t&&n.data.slug&&t(n.data.slug)},a=e=>{console.log("Failed:",e)};return(0,l.jsxs)(F.Z,{name:"personal-access-token",style:{maxWidth:600},onFinish:n,onFinishFailed:a,autoComplete:"off",children:[(0,l.jsx)(F.Z.Item,{style:{width:"100%",display:"block"},name:"access_token",rules:[{required:!0,message:"Please input your personal access token."}],children:(0,l.jsx)(T.Z.Password,{style:{flex:1,marginRight:6},size:"large",prefix:(0,l.jsx)(N.Z,{}),placeholder:"Your personal access token",autoComplete:"off"})}),(0,l.jsx)(F.Z.Item,{children:(0,l.jsx)(c.ZP,{size:"large",type:"primary",htmlType:"submit",icon:(0,l.jsx)(P.Z,{}),children:"Connect"})})]})},A=()=>{var e,t,s,n;let[a,i]=(0,u.useState)(0),[r,o]=(0,u.useState)(),c=(0,_.oR)({filter:{slug:r},enabled:void 0!==r}),[d]=(0,_.Ve)({filter:{slug:r}});return(0,l.jsxs)(l.Fragment,{children:[0===a&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Z.Z.Title,{level:2,className:"text-center",children:"Bitbucket Connect"}),(0,l.jsxs)(f.Z,{children:["WITH APP PASSWORD"," ",(0,l.jsx)(Z.Z.Link,{href:"https://support.atlassian.com/bitbucket-cloud/docs/app-passwords/",target:"_blank",children:(0,l.jsx)(p.Z,{})})]}),(0,l.jsx)(k.Z,{className:"app-password",children:(0,l.jsx)(I,{next:e=>{console.log("providerSlug :>> ",e),o(e),i(1)}})})]}),1===a&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Z.Z.Title,{level:2,className:"text-center",children:"Select bitbucket workspace"}),(0,l.jsxs)(k.Z,{className:"org-select",children:["loading"===c.status&&(0,l.jsx)(h.Z,{}),"error"===c.status&&(0,l.jsx)(b.Z,{type:"error",message:(0,l.jsx)(l.Fragment,{children:(null===(e=c.data)||void 0===e?void 0:e.messages)||"Authenticated failed."})}),"success"===c.status&&(0,l.jsx)(y.Z,{style:{display:"block"},value:null===(t=null===(s=c.data)||void 0===s?void 0:s.list[0])||void 0===t?void 0:t.name,onSelect:e=>{var t;console.log("org :>> ",e),null===(t=d({gitWorkspace:e}))||void 0===t||t.then(e=>{if((0,S.isEmpty)(e.data))return;let t=e.data[0]||e.data;if(console.log("gitProvider :>> ",t),!t){w.Z.error({message:"Oops...",description:"Can't update git provider."});return}i(2)})},options:(null===(n=c.data)||void 0===n?void 0:n.list.map(e=>({value:e.name,label:e.name})))||[]})]})]}),2===a&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(Z.Z.Title,{level:2,className:"text-center",children:[(0,l.jsx)(m.Z,{})," Congrats!"]}),(0,l.jsx)(k.Z,{className:"org-select text-center",children:"You've connected your Bitbucket workspace successfully."})]}),(0,l.jsx)("br",{}),(0,l.jsx)(C.Z,{current:a,items:[{title:"Login",icon:(0,l.jsx)(j.Z,{})},{title:"Select org.",icon:(0,l.jsx)(v.Z,{})},{title:"Done",icon:(0,l.jsx)(m.Z,{})}]})]})},O=()=>{var e,t,s;let[n,a]=(0,u.useState)(0),[i,r]=(0,u.useState)(),o=(0,_.oR)({filter:{slug:i},enabled:void 0!==i});console.log("orgs.data :>> ",o.data);let[c]=(0,_.Ve)({filter:{slug:i}});return(0,l.jsxs)(l.Fragment,{children:[0===n&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Z.Z.Title,{level:2,className:"text-center",children:"Github Connect"}),(0,l.jsxs)(f.Z,{children:["WITH PERSONAL ACCESS TOKEN"," ",(0,l.jsx)(Z.Z.Link,{href:"https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token",target:"_blank",children:(0,l.jsx)(p.Z,{})})]}),(0,l.jsx)(k.Z,{className:"personal-access-token",children:(0,l.jsx)(W,{next:e=>{console.log("providerSlug :>> ",e),r(e),a(1)}})})]}),1===n&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Z.Z.Title,{level:2,className:"text-center",children:"Select github organization"}),(0,l.jsx)(k.Z,{className:"org-select",children:(0,l.jsx)(y.Z,{style:{display:"block"},value:null===(e=null===(t=o.data)||void 0===t?void 0:t.list[0])||void 0===e?void 0:e.name,onSelect:e=>{var t;console.log("org :>> ",e),null===(t=c({gitWorkspace:e}))||void 0===t||t.then(e=>{if((0,S.isEmpty)(e.data))return;let t=e.data[0]||e.data;if(console.log("gitProvider :>> ",t),!t){w.Z.error({message:"Oops...",description:"Can't update git provider."});return}a(2)})},options:(null===(s=o.data)||void 0===s?void 0:s.list.map(e=>({value:e.name,label:e.name})))||[]})})]}),2===n&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(Z.Z.Title,{level:2,className:"text-center",children:[(0,l.jsx)(m.Z,{})," Congrats!"]}),(0,l.jsx)(k.Z,{className:"org-select text-center",children:"You've connected your Github organization successfully."})]}),(0,l.jsx)("br",{}),(0,l.jsx)(C.Z,{current:n,items:[{title:"Login",icon:(0,l.jsx)(j.Z,{})},{title:"Select org.",icon:(0,l.jsx)(v.Z,{})},{title:"Done",icon:(0,l.jsx)(m.Z,{})}]})]})},E=e=>{let{provider:t}=e;return"bitbucket"===t?(0,l.jsx)(A,{}):(0,l.jsx)(O,{})};var z=s(35396),L=s(13740),R=s(67918),G=s(36865),q=s(61663),X=s(40083),Y=s(74637),B=s.n(Y),D=s(59823),H=s(10340),V=s(14198);let U=s(64814),K=s(54498);B().extend(K),B().extend(U);let J=[{title:"Name",width:70,dataIndex:"name",key:"name",fixed:"left",filterSearch:!0,filters:[{text:"goon",value:"goon"}],onFilter:(e,t)=>!t.name||t.name.indexOf(e.toString())>-1},{title:"Host",dataIndex:"host",key:"host",width:50},{title:"Namespace",width:50,dataIndex:"gitWorkspace",key:"gitWorkspace",render:(e,t)=>{var s;return(0,l.jsx)(c.ZP,{type:"link",style:{padding:0},href:null===(s=t.repo)||void 0===s?void 0:s.url,target:"_blank",children:e})},filterSearch:!0,filters:[{text:"goon",value:"goon"}],onFilter:(e,t)=>!t.gitWorkspace||t.gitWorkspace.indexOf(e.toString())>-1},{title:"Created by",dataIndex:"owner",key:"owner",width:50,filterSearch:!0,filters:[{text:"goon",value:"goon"}],onFilter:(e,t)=>!t.owner||(t.owner.name||"").toLowerCase().indexOf(e.toString())>-1,render:(e,t)=>(0,l.jsx)(l.Fragment,{children:t.owner.name})},{title:"Created at",dataIndex:"createdAt",key:"createdAt",width:50,render:e=>(0,l.jsx)(D.q,{date:e}),sorter:(e,t)=>B()(e.createdAt).diff(B()(t.createdAt))},{title:"Action",key:"action",width:50,fixed:"right",render:(e,t)=>t.actions}],M=null!==(n=V.XL.tableConfig.defaultPageSize)&&void 0!==n?n:20,Q=()=>{let[e,t]=(0,u.useState)(1),{data:s,status:n}=(0,_.y3)({filter:{verified:!0},populate:"owner",pagination:{page:e,size:M}}),{list:a,pagination:i}=s||{},{total_items:r}=i||{},[o]=(0,_.CX)(),[d,{setQuery:x}]=(0,H.o)(),g=async e=>{let t=await o({_id:e});(null==t?void 0:t.status)&&w.Z.success({message:"Item deleted successfully."})},p=(null==a?void 0:a.map(e=>({...e,actions:(0,l.jsxs)(G.Z.Compact,{children:[(0,l.jsx)(c.ZP,{icon:(0,l.jsx)(z.Z,{}),onClick:()=>x({lv1:"edit",type:"git-provider",git_provider_slug:e.slug})}),(0,l.jsx)(q.Z,{title:"Are you sure to delete this git provider?",description:(0,l.jsx)("span",{className:"text-red-500",children:"Caution: this is permanent and cannot be rolled back."}),onConfirm:()=>g(e._id),okText:"Yes",cancelText:"No",children:(0,l.jsx)(c.ZP,{icon:(0,l.jsx)(L.Z,{})})})]})})))||[],h=e=>{let{current:s}=e;s&&t(s)},m=(0,u.useRef)(null),j=(0,R.Z)(m);return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"h-full flex-auto overflow-hidden",ref:m,children:(0,l.jsx)(X.Z,{sticky:!0,size:"small",loading:"loading"===n,columns:J,dataSource:p,scroll:{x:1200,y:void 0!==(null==j?void 0:j.height)?j.height-100:void 0},pagination:{pageSize:M,total:r,position:["bottomCenter"]},onChange:h})})})};var $=s(42789),ee=s(13179);let et=()=>{let[e,t]=(0,u.useState)(),[s,n]=(0,u.useState)(!1),p=e=>{t(e),n(!0)},h=()=>{n(!1)},m=[{key:"1",icon:(0,l.jsx)(a.Z,{}),onClick:()=>p("bitbucket"),label:(0,l.jsx)(l.Fragment,{children:"Bitbucket"})},{key:"2",icon:(0,l.jsx)(i.Z,{}),onClick:()=>p("github"),label:(0,l.jsx)(l.Fragment,{children:"Github"})}];return(0,l.jsx)(x.Wk,{children:(0,l.jsxs)($.o,{meta:(0,l.jsx)(ee.h,{title:"Git Providers",description:"The collection of GIT Providers for your team."}),children:[(0,l.jsx)(g.V,{title:"Git Providers",breadcrumbs:[{name:"Workspace"}],actions:[(0,l.jsx)(o.Z,{menu:{items:m},placement:"bottomRight",arrow:!0,children:(0,l.jsx)(c.ZP,{type:"default",icon:(0,l.jsx)(r.Z,{className:"align-middle"}),children:"Connect"})},"git-connect-btn")]}),(0,l.jsx)(Q,{}),(0,l.jsx)(d.Z,{open:s,onCancel:h,footer:null,destroyOnClose:!0,children:e&&(0,l.jsx)(E,{provider:e})})]})})};var es=et}},function(e){e.O(0,[201,967,422,169,494,160,774,888,179],function(){return e(e.s=18094)}),_N_E=e.O()}]);