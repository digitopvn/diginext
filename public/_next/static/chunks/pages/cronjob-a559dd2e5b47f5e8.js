(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[979],{92810:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(30001),s=n(50959),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M536.1 273H488c-4.4 0-8 3.6-8 8v275.3c0 2.6 1.2 5 3.3 6.5l165.3 120.7c3.6 2.6 8.6 1.9 11.2-1.7l28.6-39c2.7-3.7 1.9-8.7-1.7-11.2L544.1 528.5V281c0-4.4-3.6-8-8-8zm219.8 75.2l156.8 38.3c5 1.2 9.9-2.6 9.9-7.7l.8-161.5c0-6.7-7.7-10.5-12.9-6.3L752.9 334.1a8 8 0 003 14.1zm167.7 301.1l-56.7-19.5a8 8 0 00-10.1 4.8c-1.9 5.1-3.9 10.1-6 15.1-17.8 42.1-43.3 80-75.9 112.5a353 353 0 01-112.5 75.9 352.18 352.18 0 01-137.7 27.8c-47.8 0-94.1-9.3-137.7-27.8a353 353 0 01-112.5-75.9c-32.5-32.5-58-70.4-75.9-112.5A353.44 353.44 0 01171 512c0-47.8 9.3-94.2 27.8-137.8 17.8-42.1 43.3-80 75.9-112.5a353 353 0 01112.5-75.9C430.6 167.3 477 158 524.8 158s94.1 9.3 137.7 27.8A353 353 0 01775 261.7c10.2 10.3 19.8 21 28.6 32.3l59.8-46.8C784.7 146.6 662.2 81.9 524.6 82 285 82.1 92.6 276.7 95 516.4 97.4 751.9 288.9 942 524.8 942c185.5 0 343.5-117.6 403.7-282.3 1.5-4.2-.7-8.9-4.9-10.4z"}}]},name:"history",theme:"outlined"},a=n(94590),l=function(e,t){return s.createElement(a.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:t,icon:i}))};l.displayName="HistoryOutlined";var o=s.forwardRef(l)},5433:function(e,t,n){"use strict";var r=n(2734),s=n(50959),i=n(72096),a=n(19589),l=n(89107);let o=null,c=e=>e(),d=[],u={},f=s.forwardRef((e,t)=>{let[n,r]=s.useState(),[a,o]=s.useState(),[c,d]=s.useState(),[f,h]=s.useState(),[x,p]=s.useState(),[j,m]=s.useState(),[g,v]=(0,l.k)({prefixCls:n,getContainer:()=>a,maxCount:c,rtl:f,top:x,bottom:j}),y=(0,i.w6)(),b=y.getRootPrefixCls(),Z=y.getIconPrefixCls(),w=()=>{let{prefixCls:e,container:t,maxCount:n,rtl:s,top:a,bottom:l}=function(){let{prefixCls:e,getContainer:t,rtl:n,maxCount:r,top:s,bottom:a}=u,l=null!=e?e:(0,i.w6)().getPrefixCls("notification"),o=(null==t?void 0:t())||document.body;return{prefixCls:l,container:o,rtl:n,maxCount:r,top:s,bottom:a}}();r(e),o(t),d(n),h(s),p(a),m(l)};return s.useEffect(w,[]),s.useImperativeHandle(t,()=>{let e=Object.assign({},g);return Object.keys(e).forEach(t=>{e[t]=function(){return w(),g[t].apply(g,arguments)}}),{instance:e,sync:w}}),s.createElement(i.ZP,{prefixCls:b,iconPrefixCls:Z},v)});function h(){if(!o){let e=document.createDocumentFragment(),t={fragment:e};o=t,c(()=>{(0,r.s)(s.createElement(f,{ref(e){let{instance:n,sync:r}=e||{};Promise.resolve().then(()=>{!t.instance&&n&&(t.instance=n,t.sync=r,h())})}}),e)});return}o.instance&&(d.forEach(e=>{switch(e.type){case"open":c(()=>{o.instance.open(Object.assign(Object.assign({},u),e.config))});break;case"destroy":c(()=>{null==o||o.instance.destroy(e.key)})}}),d=[])}function x(e){d.push({type:"open",config:e}),h()}let p={open:x,destroy:function(e){d.push({type:"destroy",key:e}),h()},config:function(e){u=Object.assign(Object.assign({},u),e),c(()=>{var e;null===(e=null==o?void 0:o.sync)||void 0===e||e.call(o)})},useNotification:l.Z,_InternalPanelDoNotUseOrYouWillBeFired:a.ZP},j=p;["success","info","warning","error"].forEach(e=>{j[e]=t=>x(Object.assign(Object.assign({},t),{type:e}))}),t.Z=j},73371:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cronjob",function(){return n(18815)}])},18815:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return W}});var r,s=n(11527),i=n(2154),a=n(30001),l=n(50959),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M354 671h58.9c4.7 0 9.2-2.1 12.3-5.7L512 561.8l86.8 103.5c3 3.6 7.5 5.7 12.3 5.7H670c6.8 0 10.5-7.9 6.1-13.1L553.8 512l122.4-145.9c4.4-5.2.7-13.1-6.1-13.1h-58.9c-4.7 0-9.2 2.1-12.3 5.7L512 462.2l-86.8-103.5c-3-3.6-7.5-5.7-12.3-5.7H354c-6.8 0-10.5 7.9-6.1 13.1L470.2 512 347.9 657.9A7.95 7.95 0 00354 671z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"close-square",theme:"outlined"},c=n(94590),d=function(e,t){return l.createElement(c.Z,(0,a.Z)((0,a.Z)({},e),{},{ref:t,icon:o}))};d.displayName="CloseSquareOutlined";var u=l.forwardRef(d),f=n(92810),h=n(13740),x=n(67918),p=n(58699),j=n(85273),m=n(88158),g=n(87078),v=n(2401),y=n(46457),b=n(5433),Z=n(36865),w=n(61663),C=n(75921),k=n(74637),_=n.n(k),N=n(19005);let O=e=>(0,N.wz)(["cronjobs","list"],"/api/v1/cronjob",e),P=()=>(0,N.TV)(["cronjobs"],"/api/v1/cronjob"),E=e=>(0,N.TV)(["cronjobs"],"/api/v1/cronjob/cancel",e);var S=n(58012),A=n(97591),T=n(49309),I=n(90400),z=n(13557);let R=n(64814),H=n(54498);_().extend(H),_().extend(R);let L=null!==(r=z.XL.tableConfig.defaultPageSize)&&void 0!==r?r:20,F=()=>{let{responsive:e}=(0,I.Jl)(),[t,n]=(0,l.useState)(1),{data:r,status:i}=O({populate:"owner",pagination:{page:t,size:L}}),{list:a,pagination:o}=r||{},{total_items:c}=o||{};console.log("[CRONJOB] list :>> ",a);let[d]=P(),[k]=E(),[N,{setQuery:z}]=(0,T.o)(),R=[{title:"Name",width:50,dataIndex:"name",key:"name",render:(e,t)=>(0,s.jsx)(p.ZP,{type:"link",onClick:()=>z({lv1:"edit",type:"cronjob",cronjob:t.slug}),style:{overflowWrap:"break-word",whiteSpace:"pre-wrap",textAlign:"left"},children:e}),fixed:(null==e?void 0:e.md)?"left":void 0,filterSearch:!0,filters:[{text:"goon",value:"goon"}],onFilter:(e,t)=>!t.name||t.name.indexOf(e.toString())>-1},{title:"Type",dataIndex:"type",key:"type",width:20,render:(e,t)=>t.repeat&&t.repeat.range?(0,s.jsx)(j.Z,{color:"blue",children:"recurrent"}):(0,s.jsx)(j.Z,{color:"green",children:"once"})},{title:"Repeat",dataIndex:"repeat",key:"repeat",width:30,render:(e,t)=>t.repeat&&t.repeat.range?(0,s.jsx)(m.Z,{overlay:(0,s.jsxs)(s.Fragment,{children:["Next run at: ",_()(t.nextRunAt).format("llll")]}),children:(0,s.jsxs)(j.Z,{children:["Every ",t.repeat.range," ",t.repeat.unit]})}):(0,s.jsx)(s.Fragment,{children:"-"})},{title:"Status",dataIndex:"status",key:"status",width:20,render:(e,t)=>t.nextRunAt?(0,s.jsx)(j.Z,{color:"processing",children:"waiting"}):t.active?(0,s.jsx)(j.Z,{color:"success",children:"finished"}):(0,s.jsx)(j.Z,{color:"error",children:"cancelled"})},{title:"HTTP Request",dataIndex:"request",key:"request",width:44,render:(e,t)=>(0,s.jsxs)(g.Z,{children:[(0,s.jsx)(v.Z,{children:(0,s.jsx)(j.Z,{children:null==t?void 0:t.method})}),(0,s.jsx)(v.Z,{span:16,children:(0,s.jsx)(y.Z.Text,{ellipsis:!0,children:null==t?void 0:t.url})})]})},{title:"Created by",dataIndex:"owner",key:"owner",width:30,render:(e,t)=>(0,s.jsx)(s.Fragment,{children:null==t?void 0:t.owner.name})},{title:"Created at",dataIndex:"createdAt",key:"createdAt",width:25,render:e=>(0,s.jsx)(S.q,{date:e}),sorter:(e,t)=>_()(e.createdAt).diff(_()(t.createdAt))},{title:(0,s.jsx)(y.Z.Text,{className:"text-xs md:text-sm",children:"Action"}),key:"action",fixed:"right",width:(null==e?void 0:e.md)?30:26,render:(e,t)=>t.actions}],H=async e=>{e||b.Z.error({message:"Unable to cancel this job."});let t=await k({_id:e});(null==t?void 0:t.status)&&b.Z.success({message:"Cronjob has been cancelled successfully."})},F=async e=>{e||b.Z.error({message:"Unable to cancel this job."});let t=await d({_id:e});(null==t?void 0:t.status)&&b.Z.success({message:"Item deleted successfully."})},V=e=>{let{current:t}=e;t&&n(t)},q=(null==a?void 0:a.map((e,t)=>({...e,actions:(0,s.jsxs)(Z.Z.Compact,{children:[(0,s.jsx)(m.Z,{overlay:"Cancel cronjob",children:(0,s.jsx)(p.ZP,{icon:(0,s.jsx)(u,{}),onClick:()=>H(null==e?void 0:e._id)})}),(0,s.jsx)(m.Z,{overlay:"View history",children:(0,s.jsx)(p.ZP,{icon:(0,s.jsx)(f.Z,{}),onClick:()=>b.Z.warning({message:"This feature is under development."})})}),(0,s.jsx)(w.Z,{title:"Are you sure to delete this item?",description:(0,s.jsx)("span",{className:"text-red-500",children:"Caution: this is permanent and cannot be rolled back."}),onConfirm:()=>F(e._id),okText:"Yes",cancelText:"No",children:(0,s.jsx)(p.ZP,{icon:(0,s.jsx)(h.Z,{})})})]})})))||[],B=(0,l.useRef)(null),W=(0,x.Z)(B);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(A.V,{title:"Cronjobs (".concat(null!=c?c:"-",")"),breadcrumbs:[{name:"Workspace"}],actions:[]}),(0,s.jsx)("div",{className:"h-full flex-auto overflow-hidden",ref:B,children:(0,s.jsx)(C.Z,{sticky:!0,size:"small",loading:"loading"===i,columns:R,dataSource:q,scroll:{x:1e3,y:void 0!==(null==W?void 0:W.height)?W.height-100:void 0},pagination:{pageSize:L,total:c,position:["bottomCenter"]},onChange:V})})]})};var V=n(7021),q=n(24810);let B=()=>(0,s.jsx)(i.Wk,{children:(0,s.jsx)(V.o,{meta:(0,s.jsx)(q.h,{title:"Cronjobs",description:"List of cronjobs."}),children:(0,s.jsx)(F,{})})});var W=B}},function(e){e.O(0,[8201,2967,5775,9780,9774,2888,179],function(){return e(e.s=73371)}),_N_E=e.O()}]);