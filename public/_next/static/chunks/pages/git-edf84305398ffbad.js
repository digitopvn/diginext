(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5155],{86516:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return git}});var r,s=n(64082),i=n(1210),o=n(73318),a=n(85576),l=n(67294),c=n(22598),u=n(90447),d=n(16835),p=n(63783),x=n(79090),g=n(8751),f=n(87547),h=n(80638),m=n(71471),j=n(96074),v=n(51423),b=n(40056),Z=n(65217),y=n(26855),k=n(42119),w=n(96486),C=n(74040),P=n(50029),_=n(87794),S=n.n(_),O=n(94149),F=n(87603),N=n(8232),A=n(39249),T=n(85893),gits_BitbucketAppPasswordForm=function(e){var t,n=e.next,r=(0,C.xP)(),s=(0,d.Z)(r,1)[0],i=(t=(0,P.Z)(S().mark(function _callee(e){var t,r;return S().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log("Success:",e),i.next=3,s({type:"bitbucket",bitbucket_oauth:e});case 3:(r=i.sent)&&n&&null!==(t=r.data)&&void 0!==t&&t.slug&&n(r.data.slug);case 5:case"end":return i.stop()}},_callee)})),function(e){return t.apply(this,arguments)});return(0,T.jsxs)(N.Z,{name:"app-password",labelCol:{span:6},wrapperCol:{span:18},style:{maxWidth:600},onFinish:i,onFinishFailed:function(e){console.log("Failed:",e)},autoComplete:"off",children:[(0,T.jsx)(N.Z.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"}],children:(0,T.jsx)(A.Z,{prefix:(0,T.jsx)(f.Z,{}),placeholder:"Username"})}),(0,T.jsx)(N.Z.Item,{label:"App password",name:"app_password",rules:[{required:!0,message:"Please input app password!"}],children:(0,T.jsx)(A.Z.Password,{prefix:(0,T.jsx)(O.Z,{})})}),(0,T.jsx)(N.Z.Item,{wrapperCol:{offset:6,span:18},children:(0,T.jsx)(o.ZP,{type:"primary",htmlType:"submit",icon:(0,T.jsx)(F.Z,{}),children:"Connect"})})]})},BitbucketConnectModal=function(){var e,t,n=(0,l.useState)(0),r=n[0],s=n[1],i=(0,l.useState)(),o=i[0],a=i[1],c=(0,C.oR)({filter:{slug:o},enabled:void 0!==o}),u=(0,C.Ve)({filter:{slug:o}}),P=(0,d.Z)(u,1)[0];return(0,T.jsxs)(T.Fragment,{children:[0===r&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(m.Z.Title,{level:2,className:"text-center",children:"Bitbucket Connect"}),(0,T.jsxs)(j.Z,{children:["WITH APP PASSWORD"," ",(0,T.jsx)(m.Z.Link,{href:"https://support.atlassian.com/bitbucket-cloud/docs/app-passwords/",target:"_blank",children:(0,T.jsx)(p.Z,{})})]}),(0,T.jsx)(v.Z,{className:"app-password",children:(0,T.jsx)(gits_BitbucketAppPasswordForm,{next:function(e){console.log("providerSlug :>> ",e),a(e),s(1)}})})]}),1===r&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(m.Z.Title,{level:2,className:"text-center",children:"Select bitbucket workspace"}),(0,T.jsxs)(v.Z,{className:"org-select",children:["loading"===c.status&&(0,T.jsx)(x.Z,{}),"error"===c.status&&(0,T.jsx)(b.Z,{type:"error",message:(0,T.jsx)(T.Fragment,{children:(null===(e=c.data)||void 0===e?void 0:e.messages)||"Authenticated failed."})}),"success"===c.status&&(0,T.jsx)(Z.Z,{style:{display:"block"},onSelect:function(e,t){var n,r,i=null===(n=c.data)||void 0===n?void 0:n.list.find(function(e){return e.id===t.value});null===(r=P({name:"".concat(null==i?void 0:i.name.toUpperCase()," Github"),org:null==i?void 0:i.name,gitWorkspace:null==i?void 0:i.name,isOrg:null==i?void 0:i.is_org}))||void 0===r||r.then(function(e){if(!(0,w.isEmpty)(e.data)){var t=(0,w.isArray)(e.data)?e.data[0]:e.data;if(console.log("gitProvider :>> ",t),!t){y.ZP.error({message:"Oops...",description:"Unable to update Bitbucket git provider."});return}s(2)}})},options:(null===(t=c.data)||void 0===t?void 0:t.list.map(function(e){return{value:e.id,label:e.name}}))||[]})]})]}),2===r&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(m.Z.Title,{level:2,className:"text-center",children:[(0,T.jsx)(g.Z,{})," Congrats!"]}),(0,T.jsx)(v.Z,{className:"org-select text-center",children:"You've connected your Bitbucket workspace successfully."})]}),(0,T.jsx)("br",{}),(0,T.jsx)(k.Z,{current:r,items:[{title:"Login",icon:(0,T.jsx)(f.Z,{})},{title:"Select org.",icon:(0,T.jsx)(h.Z,{})},{title:"Done",icon:(0,T.jsx)(g.Z,{})}]})]})},gits_GithubPersonalAccessTokenForm=function(e){var t,n=e.next,r=(0,C.xP)(),s=(0,d.Z)(r,1)[0],i=(t=(0,P.Z)(S().mark(function _callee(e){var t,r;return S().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log("Success:",e),i.next=3,s({type:"github",github_oauth:{personal_access_token:e.access_token}});case 3:(r=i.sent)&&n&&null!==(t=r.data)&&void 0!==t&&t.slug&&n(r.data.slug);case 5:case"end":return i.stop()}},_callee)})),function(e){return t.apply(this,arguments)});return(0,T.jsxs)(N.Z,{name:"personal-access-token",style:{maxWidth:600},onFinish:i,onFinishFailed:function(e){console.log("Failed:",e)},autoComplete:"off",children:[(0,T.jsx)(N.Z.Item,{style:{width:"100%",display:"block"},name:"access_token",rules:[{required:!0,message:"Please input your personal access token."}],children:(0,T.jsx)(A.Z.Password,{style:{flex:1,marginRight:6},size:"large",prefix:(0,T.jsx)(O.Z,{}),placeholder:"Your personal access token",autoComplete:"off"})}),(0,T.jsx)(N.Z.Item,{children:(0,T.jsx)(o.ZP,{size:"large",type:"primary",htmlType:"submit",icon:(0,T.jsx)(F.Z,{}),children:"Connect"})})]})},GithubConnectModal=function(){var e,t,n=(0,l.useState)(0),r=n[0],s=n[1],i=(0,l.useState)(),o=i[0],a=i[1],c=(0,C.oR)({filter:{slug:o},enabled:void 0!==o});console.log("orgs.data :>> ",c.data);var u=(0,C.Ve)({filter:{slug:o}}),P=(0,d.Z)(u,1)[0];return(0,T.jsxs)(T.Fragment,{children:[0===r&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(m.Z.Title,{level:2,className:"text-center",children:"Github Connect"}),(0,T.jsxs)(j.Z,{children:["WITH PERSONAL ACCESS TOKEN"," ",(0,T.jsx)(m.Z.Link,{href:"https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token",target:"_blank",children:(0,T.jsx)(p.Z,{})})]}),(0,T.jsx)(v.Z,{className:"personal-access-token",children:(0,T.jsx)(gits_GithubPersonalAccessTokenForm,{next:function(e){console.log("providerSlug :>> ",e),a(e),s(1)}})})]}),1===r&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(m.Z.Title,{level:2,className:"text-center",children:"Select github organization"}),(0,T.jsxs)(v.Z,{className:"org-select",children:["loading"===c.status&&(0,T.jsx)(x.Z,{}),"error"===c.status&&(0,T.jsx)(b.Z,{type:"error",message:(0,T.jsx)(T.Fragment,{children:(null===(e=c.data)||void 0===e?void 0:e.messages)||"Authenticated failed."})}),"success"===c.status&&(0,T.jsx)(Z.Z,{style:{display:"block"},onSelect:function(e,t){var n,r,i=null===(n=c.data)||void 0===n?void 0:n.list.find(function(e){return e.id===t.value});null===(r=P({name:"".concat(null==i?void 0:i.name.toUpperCase()," Github"),org:null==i?void 0:i.name,gitWorkspace:null==i?void 0:i.name,isOrg:null==i?void 0:i.is_org}))||void 0===r||r.then(function(e){if(!(0,w.isEmpty)(e.data)){var t=(0,w.isArray)(e.data)?e.data[0]:e.data;if(console.log("gitProvider :>> ",t),!t){y.ZP.error({message:"Oops...",description:"Can't update git provider."});return}s(2)}})},options:(null===(t=c.data)||void 0===t?void 0:t.list.map(function(e){return{value:e.id,label:e.name}}))||[]})]})]}),2===r&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)(m.Z.Title,{level:2,className:"text-center",children:[(0,T.jsx)(g.Z,{})," Congrats!"]}),(0,T.jsx)(v.Z,{className:"org-select text-center",children:"You've connected your Github organization successfully."})]}),(0,T.jsx)("br",{}),(0,T.jsx)(k.Z,{current:r,items:[{title:"Login",icon:(0,T.jsx)(f.Z,{})},{title:"Select org.",icon:(0,T.jsx)(h.Z,{})},{title:"Done",icon:(0,T.jsx)(g.Z,{})}]})]})},gits_GitProviderConnect=function(e){return"bitbucket"===e.provider?(0,T.jsx)(BitbucketConnectModal,{}):(0,T.jsx)(GithubConnectModal,{})},G=n(59499),I=n(47389),W=n(48689),E=n(84213),L=n(78957),z=n(86738),B=n(44973),D=n(27484),M=n.n(D),R=n(61123),U=n(56832),q=n(55611);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){(0,G.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var K=n(56176),X=n(84110);M().extend(X),M().extend(K);var Y=[{title:"Name",width:70,dataIndex:"name",key:"name",fixed:"left",filterSearch:!0,filters:[{text:"goon",value:"goon"}],onFilter:function(e,t){return!t.name||t.name.indexOf(e.toString())>-1}},{title:"Host",dataIndex:"host",key:"host",width:50},{title:"Namespace",width:50,dataIndex:"gitWorkspace",key:"gitWorkspace",render:function(e,t){var n;return(0,T.jsx)(o.ZP,{type:"link",style:{padding:0},href:null===(n=t.repo)||void 0===n?void 0:n.url,target:"_blank",children:e})},filterSearch:!0,filters:[{text:"goon",value:"goon"}],onFilter:function(e,t){return!t.gitWorkspace||t.gitWorkspace.indexOf(e.toString())>-1}},{title:"Created by",dataIndex:"owner",key:"owner",width:50,filterSearch:!0,filters:[{text:"goon",value:"goon"}],onFilter:function(e,t){return!t.owner||(t.owner.name||"").toLowerCase().indexOf(e.toString())>-1},render:function(e,t){return(0,T.jsx)(T.Fragment,{children:t.owner.name})}},{title:"Created at",dataIndex:"createdAt",key:"createdAt",width:50,render:function(e){return(0,T.jsx)(R.q,{date:e})},sorter:function(e,t){return M()(e.createdAt).diff(M()(t.createdAt))}},{title:"Action",key:"action",width:50,fixed:"right",render:function(e,t){return t.actions}}],H=null!==(r=q.XL.tableConfig.defaultPageSize)&&void 0!==r?r:20,GitProviderList=function(){var e,t=(0,l.useState)(1),n=t[0],r=t[1],s=(0,C.y3)({filter:{verified:!0},populate:"owner",pagination:{page:n,size:H}}),i=s.data,a=s.status,c=i||{},u=c.list,p=(c.pagination||{}).total_items,x=(0,C.CX)(),g=(0,d.Z)(x,1)[0],f=(0,U.o)(),h=(0,d.Z)(f,2),m=(h[0],h[1].setQuery),j=(e=(0,P.Z)(S().mark(function _callee(e){var t;return S().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g({_id:e});case 2:null!=(t=n.sent)&&t.status&&y.ZP.success({message:"Item deleted successfully."});case 4:case"end":return n.stop()}},_callee)})),function(t){return e.apply(this,arguments)}),v=(null==u?void 0:u.map(function(e){return _objectSpread(_objectSpread({},e),{},{actions:(0,T.jsxs)(L.Z.Compact,{children:[(0,T.jsx)(o.ZP,{icon:(0,T.jsx)(I.Z,{}),onClick:function(){return m({lv1:"edit",type:"git-provider",git_provider_slug:e.slug})}}),(0,T.jsx)(z.Z,{title:"Are you sure to delete this git provider?",description:(0,T.jsx)("span",{className:"text-red-500",children:"Caution: this is permanent and cannot be rolled back."}),onConfirm:function(){return j(e._id)},okText:"Yes",cancelText:"No",children:(0,T.jsx)(o.ZP,{icon:(0,T.jsx)(W.Z,{})})})]})})}))||[],b=(0,l.useRef)(null),Z=(0,E.Z)(b);return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)("div",{className:"h-full flex-auto overflow-hidden",ref:b,children:(0,T.jsx)(B.Z,{sticky:!0,size:"small",loading:"loading"===a,columns:Y,dataSource:v,scroll:{x:1200,y:void 0!==(null==Z?void 0:Z.height)?Z.height-140:void 0},pagination:{pageSize:H,total:p,position:["bottomCenter"]},onChange:function(e){var t=e.current;t&&r(t)}})})})},V=n(6761),Q=n(1071),git=function(){var e=(0,l.useState)(),t=e[0],n=e[1],r=(0,l.useState)(!1),d=r[0],p=r[1],showConnectModal=function(e){n(e),p(!0)};return s.Z,T.Fragment,i.Z,T.Fragment,(0,T.jsx)(c.Wk,{children:(0,T.jsxs)(V.o,{meta:(0,T.jsx)(Q.h,{title:"Git Providers",description:"The collection of GIT Providers for your team."}),children:[(0,T.jsx)(u.V,{title:"Git Providers",breadcrumbs:[{name:"Workspace"}],actions:[(0,T.jsx)(o.ZP,{icon:(0,T.jsx)(s.Z,{className:"align-middle"}),type:"default",onClick:function(){return showConnectModal("bitbucket")},children:"Connect to Bitbucket"},"btn-bitbucket"),(0,T.jsx)(o.ZP,{icon:(0,T.jsx)(i.Z,{className:"align-middle"}),type:"default",onClick:function(){return showConnectModal("github")},children:"Connect to Github"},"btn-github")]}),(0,T.jsx)(GitProviderList,{}),(0,T.jsx)(a.Z,{open:d,onCancel:function(){p(!1)},footer:null,destroyOnClose:!0,children:t&&(0,T.jsx)(gits_GitProviderConnect,{provider:t})})]})})}},31208:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/git",function(){return n(86516)}])}},function(e){e.O(0,[3662,5877,8703,7206,3945,9774,2888,179],function(){return e(e.s=31208)}),_N_E=e.O()}]);