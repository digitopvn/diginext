(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5155],{21737:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/git",function(){return s(35091)}])},35091:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ee}});var l,n=s(11527),a=s(71369),i=s(44053),r=s(58699),o=s(99104),c=s(50959),d=s(14367),u=s(42149),x=s(70861),g=s(32105),p=s(38101),h=s(3513),m=s(17671),j=s(46457),v=s(97088),Z=s(476),f=s(48747),b=s(3748),k=s(5433),y=s(88571),w=s(32699),C=s(41507),S=s(91003),_=s(83103),N=s(50002),P=s(80042);let F=e=>{let{next:t}=e,[s]=(0,C.xP)(),l=async e=>{var l;console.log("Success:",e);let n=await s({type:"bitbucket",bitbucket_oauth:e});n&&t&&(null===(l=n.data)||void 0===l?void 0:l.slug)&&t(n.data.slug)},a=e=>{console.log("Failed:",e)};return(0,n.jsxs)(N.Z,{name:"app-password",labelCol:{span:6},wrapperCol:{span:18},style:{maxWidth:600},onFinish:l,onFinishFailed:a,autoComplete:"off",children:[(0,n.jsx)(N.Z.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"}],children:(0,n.jsx)(P.Z,{prefix:(0,n.jsx)(h.Z,{}),placeholder:"Username"})}),(0,n.jsx)(N.Z.Item,{label:"App password",name:"app_password",rules:[{required:!0,message:"Please input app password!"}],children:(0,n.jsx)(P.Z.Password,{prefix:(0,n.jsx)(S.Z,{})})}),(0,n.jsx)(N.Z.Item,{wrapperCol:{offset:6,span:18},children:(0,n.jsx)(r.ZP,{type:"primary",htmlType:"submit",icon:(0,n.jsx)(_.Z,{}),children:"Connect"})})]})},T=()=>{var e,t;let[s,l]=(0,c.useState)(0),[a,i]=(0,c.useState)(),r=(0,C.oR)({filter:{slug:a},enabled:void 0!==a}),[o]=(0,C.Ve)({filter:{slug:a}});return(0,n.jsxs)(n.Fragment,{children:[0===s&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j.Z.Title,{level:2,className:"text-center",children:"Bitbucket Connect"}),(0,n.jsxs)(v.Z,{children:["WITH APP PASSWORD"," ",(0,n.jsx)(j.Z.Link,{href:"https://support.atlassian.com/bitbucket-cloud/docs/app-passwords/",target:"_blank",children:(0,n.jsx)(x.Z,{})})]}),(0,n.jsx)(Z.Z,{className:"app-password",children:(0,n.jsx)(F,{next(e){console.log("providerSlug :>> ",e),i(e),l(1)}})})]}),1===s&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j.Z.Title,{level:2,className:"text-center",children:"Select bitbucket workspace"}),(0,n.jsxs)(Z.Z,{className:"org-select",children:["loading"===r.status&&(0,n.jsx)(g.Z,{}),"error"===r.status&&(0,n.jsx)(f.Z,{type:"error",message:(0,n.jsx)(n.Fragment,{children:(null===(e=r.data)||void 0===e?void 0:e.messages)||"Authenticated failed."})}),"success"===r.status&&(0,n.jsx)(b.Z,{style:{display:"block"},onSelect(e,t){var s,n;let a=null===(s=r.data)||void 0===s?void 0:s.list.find(e=>e.id===t.value);null===(n=o({name:"".concat(null==a?void 0:a.name.toUpperCase()," Github"),org:null==a?void 0:a.name,gitWorkspace:null==a?void 0:a.name,isOrg:null==a?void 0:a.is_org}))||void 0===n||n.then(e=>{if((0,w.isEmpty)(e.data))return;let t=(0,w.isArray)(e.data)?e.data[0]:e.data;if(console.log("gitProvider :>> ",t),!t){k.Z.error({message:"Oops...",description:"Unable to update Bitbucket git provider."});return}l(2)})},options:(null===(t=r.data)||void 0===t?void 0:t.list.map(e=>({value:e.id,label:e.name})))||[]})]})]}),2===s&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(j.Z.Title,{level:2,className:"text-center",children:[(0,n.jsx)(p.Z,{})," Congrats!"]}),(0,n.jsx)(Z.Z,{className:"org-select text-center",children:"You've connected your Bitbucket workspace successfully."})]}),(0,n.jsx)("br",{}),(0,n.jsx)(y.Z,{current:s,items:[{title:"Login",icon:(0,n.jsx)(h.Z,{})},{title:"Select org.",icon:(0,n.jsx)(m.Z,{})},{title:"Done",icon:(0,n.jsx)(p.Z,{})}]})]})},A=e=>{let{next:t}=e,[s]=(0,C.xP)(),l=async e=>{var l;console.log("Success:",e);let n=await s({type:"github",github_oauth:{personal_access_token:e.access_token}});n&&t&&(null===(l=n.data)||void 0===l?void 0:l.slug)&&t(n.data.slug)},a=e=>{console.log("Failed:",e)};return(0,n.jsxs)(N.Z,{name:"personal-access-token",style:{maxWidth:600},onFinish:l,onFinishFailed:a,autoComplete:"off",children:[(0,n.jsx)(N.Z.Item,{style:{width:"100%",display:"block"},name:"access_token",rules:[{required:!0,message:"Please input your personal access token."}],children:(0,n.jsx)(P.Z.Password,{style:{flex:1,marginRight:6},size:"large",prefix:(0,n.jsx)(S.Z,{}),placeholder:"Your personal access token",autoComplete:"off"})}),(0,n.jsx)(N.Z.Item,{children:(0,n.jsx)(r.ZP,{size:"large",type:"primary",htmlType:"submit",icon:(0,n.jsx)(_.Z,{}),children:"Connect"})})]})},I=()=>{var e,t;let[s,l]=(0,c.useState)(0),[a,i]=(0,c.useState)(),r=(0,C.oR)({filter:{slug:a},enabled:void 0!==a});console.log("orgs.data :>> ",r.data);let[o]=(0,C.Ve)({filter:{slug:a}});return(0,n.jsxs)(n.Fragment,{children:[0===s&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j.Z.Title,{level:2,className:"text-center",children:"Github Connect"}),(0,n.jsxs)(v.Z,{children:["WITH PERSONAL ACCESS TOKEN"," ",(0,n.jsx)(j.Z.Link,{href:"https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token",target:"_blank",children:(0,n.jsx)(x.Z,{})})]}),(0,n.jsx)(Z.Z,{className:"personal-access-token",children:(0,n.jsx)(A,{next(e){console.log("providerSlug :>> ",e),i(e),l(1)}})})]}),1===s&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j.Z.Title,{level:2,className:"text-center",children:"Select github organization"}),(0,n.jsxs)(Z.Z,{className:"org-select",children:["loading"===r.status&&(0,n.jsx)(g.Z,{}),"error"===r.status&&(0,n.jsx)(f.Z,{type:"error",message:(0,n.jsx)(n.Fragment,{children:(null===(e=r.data)||void 0===e?void 0:e.messages)||"Authenticated failed."})}),"success"===r.status&&(0,n.jsx)(b.Z,{style:{display:"block"},onSelect(e,t){var s,n;let a=null===(s=r.data)||void 0===s?void 0:s.list.find(e=>e.id===t.value);null===(n=o({name:"".concat(null==a?void 0:a.name.toUpperCase()," Github"),org:null==a?void 0:a.name,gitWorkspace:null==a?void 0:a.name,isOrg:null==a?void 0:a.is_org}))||void 0===n||n.then(e=>{if((0,w.isEmpty)(e.data))return;let t=(0,w.isArray)(e.data)?e.data[0]:e.data;if(console.log("gitProvider :>> ",t),!t){k.Z.error({message:"Oops...",description:"Can't update git provider."});return}l(2)})},options:(null===(t=r.data)||void 0===t?void 0:t.list.map(e=>({value:e.id,label:e.name})))||[]})]})]}),2===s&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(j.Z.Title,{level:2,className:"text-center",children:[(0,n.jsx)(p.Z,{})," Congrats!"]}),(0,n.jsx)(Z.Z,{className:"org-select text-center",children:"You've connected your Github organization successfully."})]}),(0,n.jsx)("br",{}),(0,n.jsx)(y.Z,{current:s,items:[{title:"Login",icon:(0,n.jsx)(h.Z,{})},{title:"Select org.",icon:(0,n.jsx)(m.Z,{})},{title:"Done",icon:(0,n.jsx)(p.Z,{})}]})]})},O=e=>{let{provider:t}=e;return"bitbucket"===t?(0,n.jsx)(T,{}):(0,n.jsx)(I,{})};var W=s(35396),E=s(13740),G=s(30388),z=s(36865),L=s(61663),R=s(5489),U=s(74637),q=s.n(U),B=s(51959),X=s(8462),Y=s(55915);let D=s(64814),H=s(54498);q().extend(H),q().extend(D);let V=[{title:"Name",width:70,dataIndex:"name",key:"name",fixed:"left",filterSearch:!0,filters:[{text:"goon",value:"goon"}],onFilter:(e,t)=>!t.name||t.name.indexOf(e.toString())>-1},{title:"Host",dataIndex:"host",key:"host",width:50},{title:"Namespace",width:50,dataIndex:"gitWorkspace",key:"gitWorkspace",render(e,t){var s;return(0,n.jsx)(r.ZP,{type:"link",style:{padding:0},href:null===(s=t.repo)||void 0===s?void 0:s.url,target:"_blank",children:e})},filterSearch:!0,filters:[{text:"goon",value:"goon"}],onFilter:(e,t)=>!t.gitWorkspace||t.gitWorkspace.indexOf(e.toString())>-1},{title:"Created by",dataIndex:"owner",key:"owner",width:50,filterSearch:!0,filters:[{text:"goon",value:"goon"}],onFilter:(e,t)=>!t.owner||(t.owner.name||"").toLowerCase().indexOf(e.toString())>-1,render:(e,t)=>(0,n.jsx)(n.Fragment,{children:t.owner.name})},{title:"Created at",dataIndex:"createdAt",key:"createdAt",width:50,render:e=>(0,n.jsx)(B.q,{date:e}),sorter:(e,t)=>q()(e.createdAt).diff(q()(t.createdAt))},{title:"Action",key:"action",width:50,fixed:"right",render:(e,t)=>t.actions}],K=null!==(l=Y.XL.tableConfig.defaultPageSize)&&void 0!==l?l:20,J=()=>{let[e,t]=(0,c.useState)(1),{data:s,status:l}=(0,C.y3)({filter:{verified:!0},populate:"owner",pagination:{page:e,size:K}}),{list:a,pagination:i}=s||{},{total_items:o}=i||{},[d]=(0,C.CX)(),[u,{setQuery:x}]=(0,X.o)(),g=async e=>{let t=await d({_id:e});(null==t?void 0:t.status)&&k.Z.success({message:"Item deleted successfully."})},p=(null==a?void 0:a.map(e=>({...e,actions:(0,n.jsxs)(z.Z.Compact,{children:[(0,n.jsx)(r.ZP,{icon:(0,n.jsx)(W.Z,{}),onClick:()=>x({lv1:"edit",type:"git-provider",git_provider_slug:e.slug})}),(0,n.jsx)(L.Z,{title:"Are you sure to delete this git provider?",description:(0,n.jsx)("span",{className:"text-red-500",children:"Caution: this is permanent and cannot be rolled back."}),onConfirm:()=>g(e._id),okText:"Yes",cancelText:"No",children:(0,n.jsx)(r.ZP,{icon:(0,n.jsx)(E.Z,{})})})]})})))||[],h=e=>{let{current:s}=e;s&&t(s)},m=(0,c.useRef)(null),j=(0,G.Z)(m);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"h-full flex-auto overflow-hidden",ref:m,children:(0,n.jsx)(R.Z,{sticky:!0,size:"small",loading:"loading"===l,columns:V,dataSource:p,scroll:{x:1200,y:void 0!==(null==j?void 0:j.height)?j.height-140:void 0},pagination:{pageSize:K,total:o,position:["bottomCenter"]},onChange:h})})})};var M=s(70011),Q=s(77736);let $=()=>{let[e,t]=(0,c.useState)(),[s,l]=(0,c.useState)(!1),x=e=>{t(e),l(!0)},g=()=>{l(!1)};return a.Z,n.Fragment,i.Z,n.Fragment,(0,n.jsx)(d.Wk,{children:(0,n.jsxs)(M.o,{meta:(0,n.jsx)(Q.h,{title:"Git Providers",description:"The collection of GIT Providers for your team."}),children:[(0,n.jsx)(u.V,{title:"Git Providers",breadcrumbs:[{name:"Workspace"}],actions:[(0,n.jsx)(r.ZP,{icon:(0,n.jsx)(a.Z,{className:"align-middle"}),type:"default",onClick:()=>x("bitbucket"),children:"Connect to Bitbucket"},"btn-bitbucket"),(0,n.jsx)(r.ZP,{icon:(0,n.jsx)(i.Z,{className:"align-middle"}),type:"default",onClick:()=>x("github"),children:"Connect to Github"},"btn-github")]}),(0,n.jsx)(J,{}),(0,n.jsx)(o.Z,{open:s,onCancel:g,footer:null,destroyOnClose:!0,children:e&&(0,n.jsx)(O,{provider:e})})]})})};var ee=$}},function(e){e.O(0,[8201,2967,6517,8584,6329,2728,9774,2888,179],function(){return e(e.s=21737)}),_N_E=e.O()}]);