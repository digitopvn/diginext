(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[722],{84765:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var a=n(45645),l=n(50959),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},r=n(94590),o=function(e,t){return l.createElement(r.Z,(0,a.Z)((0,a.Z)({},e),{},{ref:t,icon:i}))};o.displayName="MoreOutlined";var d=l.forwardRef(o)},5433:function(e,t,n){"use strict";var a=n(71746),l=n(50959),i=n(72096),r=n(19589),o=n(89107);let d=null,s=e=>e(),u=[],c={},v=l.forwardRef((e,t)=>{let[n,a]=l.useState(),[r,d]=l.useState(),[s,u]=l.useState(),[v,m]=l.useState(),[f,p]=l.useState(),[x,h]=l.useState(),[g,y]=(0,o.k)({prefixCls:n,getContainer:()=>r,maxCount:s,rtl:v,top:f,bottom:x}),j=(0,i.w6)(),w=j.getRootPrefixCls(),S=j.getIconPrefixCls(),b=()=>{let{prefixCls:e,container:t,maxCount:n,rtl:l,top:r,bottom:o}=function(){let{prefixCls:e,getContainer:t,rtl:n,maxCount:a,top:l,bottom:r}=c,o=null!=e?e:(0,i.w6)().getPrefixCls("notification"),d=(null==t?void 0:t())||document.body;return{prefixCls:o,container:d,rtl:n,maxCount:a,top:l,bottom:r}}();a(e),d(t),u(n),m(l),p(r),h(o)};return l.useEffect(b,[]),l.useImperativeHandle(t,()=>{let e=Object.assign({},g);return Object.keys(e).forEach(t=>{e[t]=function(){return b(),g[t].apply(g,arguments)}}),{instance:e,sync:b}}),l.createElement(i.ZP,{prefixCls:w,iconPrefixCls:S},y)});function m(){if(!d){let e=document.createDocumentFragment(),t={fragment:e};d=t,s(()=>{(0,a.s)(l.createElement(v,{ref:e=>{let{instance:n,sync:a}=e||{};Promise.resolve().then(()=>{!t.instance&&n&&(t.instance=n,t.sync=a,m())})}}),e)});return}d.instance&&(u.forEach(e=>{switch(e.type){case"open":s(()=>{d.instance.open(Object.assign(Object.assign({},c),e.config))});break;case"destroy":s(()=>{null==d||d.instance.destroy(e.key)})}}),u=[])}function f(e){u.push({type:"open",config:e}),m()}let p={open:f,destroy:function(e){u.push({type:"destroy",key:e}),m()},config:function(e){c=Object.assign(Object.assign({},c),e),s(()=>{var e;null===(e=null==d?void 0:d.sync)||void 0===e||e.call(d)})},useNotification:o.Z,_InternalPanelDoNotUseOrYouWillBeFired:r.ZP},x=p;["success","info","warning","error"].forEach(e=>{x[e]=t=>f(Object.assign(Object.assign({},t),{type:e}))}),t.Z=x},36486:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/monitor/deployment",function(){return n(8147)}])},8147:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return P}});var a=n(11527),l=n(77665),i=n(84765),r=n(67918);n(5433);var o=n(58699),d=n(85273),s=n(88158),u=n(31620),c=n(40083),v=n(74637),m=n.n(v),f=n(32699),p=n(62973),x=n.n(p),h=n(50959),g=n(58828),y=n(22859);let j=e=>(0,y.wz)(["monitor-deployment","list"],"/api/v1/monitor/deployments",e);var w=n(24483),S=n(59823),b=n(44064),k=n(10340),Z=n(65438);let C=n(64814),I=n(54498);m().extend(I),m().extend(C);let N=()=>{var e,t;let{responsive:n}=(0,Z.Jl)(),{data:l,status:v}=(0,g.x7)(),{list:p=[]}=l||{},[y,C]=(0,h.useState)(0),[I,N]=(0,h.useState)(1),{data:O,status:R}=j({filter:{clusterShortName:""}}),{list:E,pagination:P}=O||{},{total_items:A=null!==(e=null==E?void 0:E.length)&&void 0!==e?e:0}=P||{},[_]=(0,w.kZ)(),[F,{setQuery:M}]=(0,k.o)(),z=(e,t)=>{var n,a;let{current:l}=e;C(null!==(a=null===(n=t.currentDataSource)||void 0===n?void 0:n.length)&&void 0!==a?a:0),l&&N(l)};(0,h.useEffect)(()=>C(null!==(t=null==E?void 0:E.length)&&void 0!==t?t:0),[E]);let T=(null==E?void 0:E.map((e,t)=>({...e,key:"ns-".concat(t),actions:[(0,a.jsx)(o.ZP,{size:"small",icon:(0,a.jsx)(i.Z,{})},"more-btn")]})))||[],D=null==E?void 0:E.map(e=>{var t,n;return{text:(null===(t=e.metadata)||void 0===t?void 0:t.name)||"",value:(null===(n=e.metadata)||void 0===n?void 0:n.name)||""}}).filter(e=>""!==e.value).filter((e,t,n)=>t===n.findIndex(t=>t.text===e.text)),W=null==E?void 0:E.map(e=>{var t,n;return{text:(null===(t=e.metadata)||void 0===t?void 0:t.namespace)||"",value:(null===(n=e.metadata)||void 0===n?void 0:n.namespace)||""}}).filter(e=>""!==e.value).filter((e,t,n)=>t===n.findIndex(t=>t.text===e.text)),B=[{title:"Name",width:60,dataIndex:"name",key:"name",fixed:(null==n?void 0:n.md)?"left":void 0,filterSearch:!0,render:(e,t)=>{var n;return null===(n=t.metadata)||void 0===n?void 0:n.name},filters:D,onFilter:(e,t)=>{var n,a;return null===(n=t.metadata)||void 0===n||!n.name||(null===(a=t.metadata)||void 0===a?void 0:a.name.indexOf(e.toString()))>-1}},{title:"Pods",dataIndex:"pods",key:"pods",width:15,render:(e,t)=>{var n,l,i,r,o,s,u,c,v,m;let f=null!==(v=null!==(s=null===(n=t.status)||void 0===n?void 0:n.availableReplicas)&&void 0!==s?s:null===(l=t.status)||void 0===l?void 0:l.readyReplicas)&&void 0!==v?v:(null!==(u=null===(i=t.status)||void 0===i?void 0:i.replicas)&&void 0!==u?u:0)-(null!==(c=null===(r=t.status)||void 0===r?void 0:r.unavailableReplicas)&&void 0!==c?c:0),p=null!==(m=null===(o=t.status)||void 0===o?void 0:o.replicas)&&void 0!==m?m:0;return(0,a.jsxs)(d.Z,{color:0===f?"error":f<p?"warning":"default",children:[f,"/",p]})},filterSearch:!0,filters:[{text:"Ready",value:"ready"},{text:"Partial",value:"partial"},{text:"Failed",value:"failed"}],onFilter:(e,t)=>{var n,a,l,i,r,o,d,s,u,c;let v=null!==(u=null!==(o=null===(n=t.status)||void 0===n?void 0:n.availableReplicas)&&void 0!==o?o:null===(a=t.status)||void 0===a?void 0:a.readyReplicas)&&void 0!==u?u:(null!==(d=null===(l=t.status)||void 0===l?void 0:l.replicas)&&void 0!==d?d:0)-(null!==(s=null===(i=t.status)||void 0===i?void 0:i.unavailableReplicas)&&void 0!==s?s:0),m=null!==(c=null===(r=t.status)||void 0===r?void 0:r.replicas)&&void 0!==c?c:0;return"failed"===e?0===v:"partial"===e?v>0&&v<m:v===m}},{title:"CPU",dataIndex:"cpu",key:"cpu",width:17,render:(e,t)=>{var n,l;let i=(0,f.toInteger)(null===(n=t.cpuAvg)||void 0===n?void 0:n.replace("m",""))||0,r=(0,f.toInteger)(null===(l=t.cpuCapacity)||void 0===l?void 0:l.replace("m",""))||0;return 0===r?(0,a.jsx)(s.Z,{overlay:(0,a.jsxs)(a.Fragment,{children:["Recommend: ",t.cpuRecommend]}),children:(0,a.jsx)(d.Z,{color:0===r?"default":i>.8*r?"warning":"success",children:t.cpuAvg})}):(0,a.jsx)(d.Z,{color:0===r?"default":i>.8*r?"warning":"success",children:t.cpuAvg})},sorter:(e,t)=>{var n,a;return(0,f.toInteger)(null===(n=e.cpuAvg)||void 0===n?void 0:n.replace("m",""))-(0,f.toInteger)(null===(a=t.cpuAvg)||void 0===a?void 0:a.replace("m",""))}},{title:"MEM",dataIndex:"memory",key:"memory",width:17,render:(e,t)=>{var n,l;let i=(0,f.toInteger)(null===(n=t.memoryAvg)||void 0===n?void 0:n.replace("Mi",""))||0,r=(0,f.toInteger)(null===(l=t.memoryCapacity)||void 0===l?void 0:l.replace("Mi",""))||0;return 0===r?(0,a.jsx)(s.Z,{overlay:(0,a.jsxs)(a.Fragment,{children:["Recommend: ",t.memoryRecommend]}),children:(0,a.jsx)(d.Z,{color:0===r?"default":i>.8*r?"warning":"success",children:t.memoryAvg})}):(0,a.jsx)(d.Z,{color:0===r?"default":i>.8*r?"warning":"success",children:t.memoryAvg})},sorter:(e,t)=>{var n,a;return(0,f.toInteger)(null===(n=e.memoryAvg)||void 0===n?void 0:n.replace("Mi",""))-(0,f.toInteger)(null===(a=t.memoryAvg)||void 0===a?void 0:a.replace("Mi",""))}},{title:"Namespace",dataIndex:"namespace",key:"namespace",width:30,render:(e,t)=>{var n;return(0,a.jsx)(x(),{href:"#",children:null===(n=t.metadata)||void 0===n?void 0:n.namespace})},filterSearch:!0,filters:W,onFilter:(e,t)=>{var n,a;return null===(n=t.metadata)||void 0===n||!n.namespace||(null===(a=t.metadata)||void 0===a?void 0:a.namespace.indexOf(e.toString()))>-1}},{title:"Cluster",dataIndex:"clusterShortName",key:"clusterShortName",width:30,render:e=>(0,a.jsx)(x(),{href:"#",children:e}),filterSearch:!0,filters:p.map(e=>({text:e.shortName||"",value:e.shortName||""})),onFilter:(e,t)=>!t.clusterShortName||t.clusterShortName.indexOf(e.toString())>-1},{title:"Created at",dataIndex:"createdAt",key:"createdAt",width:30,render:(e,t)=>{var n;return(0,a.jsx)(S.q,{date:null===(n=t.metadata)||void 0===n?void 0:n.creationTimestamp})},sorter:(e,t)=>{var n,a;return m()(null===(n=e.metadata)||void 0===n?void 0:n.creationTimestamp).diff(m()(null===(a=t.metadata)||void 0===a?void 0:a.creationTimestamp))}},{title:(0,a.jsx)(u.Z.Text,{className:"text-xs md:text-sm",children:"Action"}),key:"action",fixed:"right",width:(null==n||n.md,12),render:(e,t)=>t.actions}],U=(0,h.useRef)(null),X=(0,r.Z)(U);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.V,{title:"Deployments (".concat(y,")"),breadcrumbs:[{name:"Workspace"}],actions:[]}),(0,a.jsx)("div",{className:"flex-auto overflow-auto",ref:U,children:(0,a.jsx)(c.Z,{sticky:!0,loading:"loading"===R,size:"small",columns:B,dataSource:T,scroll:{x:1e3,y:void 0!==(null==X?void 0:X.height)?X.height-100:void 0},pagination:{pageSize:200,position:["bottomCenter"]},onChange:(e,t,n,a)=>z(e,a)})})]})};var O=n(42789),R=n(13179);let E=()=>(0,a.jsx)(l.Wk,{children:(0,a.jsx)(O.o,{meta:(0,a.jsx)(R.h,{title:"Deployments",description:"List of deployments."}),children:(0,a.jsx)(N,{})})});var P=E}},function(e){e.O(0,[201,967,422,160,774,888,179],function(){return e(e.s=36486)}),_N_E=e.O()}]);