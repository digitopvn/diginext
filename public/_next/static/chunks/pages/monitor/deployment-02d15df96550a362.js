(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5722],{84765:function(e,t,a){"use strict";a.d(t,{Z:function(){return o}});var l=a(30001),i=a(50959),n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M456 231a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0zm0 280a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"more",theme:"outlined"},r=a(94590),d=function(e,t){return i.createElement(r.Z,(0,l.Z)((0,l.Z)({},e),{},{ref:t,icon:n}))};d.displayName="MoreOutlined";var o=i.forwardRef(d)},10757:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/monitor/deployment",function(){return a(25291)}])},25291:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return E}});var l=a(11527),i=a(2154),n=a(84765),r=a(30388);a(5433);var d=a(58699),o=a(85273),u=a(88158),s=a(46457),v=a(5489),c=a(74637),m=a.n(c),p=a(32699),x=a(47725),f=a.n(x),h=a(50959),g=a(73621),y=a(19005);let j=e=>(0,y.wz)(["monitor-deployment","list"],"/api/v1/monitor/deployments",e);var w=a(22820),k=a(58012),I=a(97591),N=a(49309),S=a(90400);let Z=a(64814),A=a(54498);m().extend(A),m().extend(Z);let R=()=>{var e,t;let{responsive:a}=(0,S.Jl)(),{data:i,status:c}=(0,g.x7)(),{list:x=[]}=i||{},[y,Z]=(0,h.useState)(0),[A,R]=(0,h.useState)(1),{data:_,status:b}=j({filter:{clusterShortName:""}}),{list:C,pagination:E}=_||{},{total_items:F=null!==(e=null==C?void 0:C.length)&&void 0!==e?e:0}=E||{},[M]=(0,w.kZ)(),[z,{setQuery:O}]=(0,N.o)(),P=(e,t)=>{var a,l;let{current:i}=e;Z(null!==(l=null===(a=t.currentDataSource)||void 0===a?void 0:a.length)&&void 0!==l?l:0),i&&R(i)};(0,h.useEffect)(()=>Z(null!==(t=null==C?void 0:C.length)&&void 0!==t?t:0),[C]);let T=(null==C?void 0:C.map((e,t)=>({...e,key:"ns-".concat(t),actions:[(0,l.jsx)(d.ZP,{size:"small",icon:(0,l.jsx)(n.Z,{})},"more-btn")]})))||[],D=null==C?void 0:C.map(e=>{var t,a;return{text:(null===(t=e.metadata)||void 0===t?void 0:t.name)||"",value:(null===(a=e.metadata)||void 0===a?void 0:a.name)||""}}).filter(e=>""!==e.value).filter((e,t,a)=>t===a.findIndex(t=>t.text===e.text)),W=null==C?void 0:C.map(e=>{var t,a;return{text:(null===(t=e.metadata)||void 0===t?void 0:t.namespace)||"",value:(null===(a=e.metadata)||void 0===a?void 0:a.namespace)||""}}).filter(e=>""!==e.value).filter((e,t,a)=>t===a.findIndex(t=>t.text===e.text)),X=[{title:"Name",width:60,dataIndex:"name",key:"name",fixed:(null==a?void 0:a.md)?"left":void 0,filterSearch:!0,render(e,t){var a;return null===(a=t.metadata)||void 0===a?void 0:a.name},filters:D,onFilter(e,t){var a,l;return null===(a=t.metadata)||void 0===a||!a.name||(null===(l=t.metadata)||void 0===l?void 0:l.name.indexOf(e.toString()))>-1}},{title:"Pods",dataIndex:"pods",key:"pods",width:15,render(e,t){var a,i,n,r,d,u,s,v,c,m;let p=null!==(c=null!==(u=null===(a=t.status)||void 0===a?void 0:a.availableReplicas)&&void 0!==u?u:null===(i=t.status)||void 0===i?void 0:i.readyReplicas)&&void 0!==c?c:(null!==(s=null===(n=t.status)||void 0===n?void 0:n.replicas)&&void 0!==s?s:0)-(null!==(v=null===(r=t.status)||void 0===r?void 0:r.unavailableReplicas)&&void 0!==v?v:0),x=null!==(m=null===(d=t.status)||void 0===d?void 0:d.replicas)&&void 0!==m?m:0;return(0,l.jsxs)(o.Z,{color:0===p?"error":p<x?"warning":"default",children:[p,"/",x]})},filterSearch:!0,filters:[{text:"Ready",value:"ready"},{text:"Partial",value:"partial"},{text:"Failed",value:"failed"}],onFilter(e,t){var a,l,i,n,r,d,o,u,s,v;let c=null!==(s=null!==(d=null===(a=t.status)||void 0===a?void 0:a.availableReplicas)&&void 0!==d?d:null===(l=t.status)||void 0===l?void 0:l.readyReplicas)&&void 0!==s?s:(null!==(o=null===(i=t.status)||void 0===i?void 0:i.replicas)&&void 0!==o?o:0)-(null!==(u=null===(n=t.status)||void 0===n?void 0:n.unavailableReplicas)&&void 0!==u?u:0),m=null!==(v=null===(r=t.status)||void 0===r?void 0:r.replicas)&&void 0!==v?v:0;return"failed"===e?0===c:"partial"===e?c>0&&c<m:c===m}},{title:"CPU",dataIndex:"cpu",key:"cpu",width:17,render(e,t){var a,i;let n=(0,p.toInteger)(null===(a=t.cpuAvg)||void 0===a?void 0:a.replace("m",""))||0,r=(0,p.toInteger)(null===(i=t.cpuCapacity)||void 0===i?void 0:i.replace("m",""))||0;return 0===r?(0,l.jsx)(u.Z,{overlay:(0,l.jsxs)(l.Fragment,{children:["Recommend: ",t.cpuRecommend]}),children:(0,l.jsx)(o.Z,{color:0===r?"default":n>.8*r?"warning":"success",children:t.cpuAvg})}):(0,l.jsx)(o.Z,{color:0===r?"default":n>.8*r?"warning":"success",children:t.cpuAvg})},sorter(e,t){var a,l;return(0,p.toInteger)(null===(a=e.cpuAvg)||void 0===a?void 0:a.replace("m",""))-(0,p.toInteger)(null===(l=t.cpuAvg)||void 0===l?void 0:l.replace("m",""))}},{title:"MEM",dataIndex:"memory",key:"memory",width:17,render(e,t){var a,i;let n=(0,p.toInteger)(null===(a=t.memoryAvg)||void 0===a?void 0:a.replace("Mi",""))||0,r=(0,p.toInteger)(null===(i=t.memoryCapacity)||void 0===i?void 0:i.replace("Mi",""))||0;return 0===r?(0,l.jsx)(u.Z,{overlay:(0,l.jsxs)(l.Fragment,{children:["Recommend: ",t.memoryRecommend]}),children:(0,l.jsx)(o.Z,{color:0===r?"default":n>.8*r?"warning":"success",children:t.memoryAvg})}):(0,l.jsx)(o.Z,{color:0===r?"default":n>.8*r?"warning":"success",children:t.memoryAvg})},sorter(e,t){var a,l;return(0,p.toInteger)(null===(a=e.memoryAvg)||void 0===a?void 0:a.replace("Mi",""))-(0,p.toInteger)(null===(l=t.memoryAvg)||void 0===l?void 0:l.replace("Mi",""))}},{title:"Namespace",dataIndex:"namespace",key:"namespace",width:30,render(e,t){var a;return(0,l.jsx)(f(),{href:"#",children:null===(a=t.metadata)||void 0===a?void 0:a.namespace})},filterSearch:!0,filters:W,onFilter(e,t){var a,l;return null===(a=t.metadata)||void 0===a||!a.namespace||(null===(l=t.metadata)||void 0===l?void 0:l.namespace.indexOf(e.toString()))>-1}},{title:"Cluster",dataIndex:"clusterShortName",key:"clusterShortName",width:30,render:e=>(0,l.jsx)(f(),{href:"#",children:e}),filterSearch:!0,filters:x.map(e=>({text:e.shortName||"",value:e.shortName||""})),onFilter:(e,t)=>!t.clusterShortName||t.clusterShortName.indexOf(e.toString())>-1},{title:"Created at",dataIndex:"createdAt",key:"createdAt",width:30,render(e,t){var a;return(0,l.jsx)(k.q,{date:null===(a=t.metadata)||void 0===a?void 0:a.creationTimestamp})},sorter(e,t){var a,l;return m()(null===(a=e.metadata)||void 0===a?void 0:a.creationTimestamp).diff(m()(null===(l=t.metadata)||void 0===l?void 0:l.creationTimestamp))}},{title:(0,l.jsx)(s.Z.Text,{className:"text-xs md:text-sm",children:"Action"}),key:"action",fixed:"right",width:(null==a||a.md,12),render:(e,t)=>t.actions}],q=(0,h.useRef)(null),B=(0,r.Z)(q);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(I.V,{title:"Deployments (".concat(y,")"),breadcrumbs:[{name:"Workspace"}],actions:[]}),(0,l.jsx)("div",{className:"flex-auto overflow-auto",ref:q,children:(0,l.jsx)(v.Z,{sticky:!0,loading:"loading"===b,size:"small",columns:X,dataSource:T,scroll:{x:1e3,y:void 0!==(null==B?void 0:B.height)?B.height-140:void 0},pagination:{pageSize:200,position:["bottomCenter"]},onChange:(e,t,a,l)=>P(e,l)})})]})};var _=a(33923),b=a(24810);let C=()=>(0,l.jsx)(i.Wk,{children:(0,l.jsx)(_.o,{meta:(0,l.jsx)(b.h,{title:"Deployments",description:"List of deployments."}),children:(0,l.jsx)(R,{})})});var E=C}},function(e){e.O(0,[8201,2967,9033,1079,9774,2888,179],function(){return e(e.s=10757)}),_N_E=e.O()}]);