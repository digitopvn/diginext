(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{4408:function(e,i,n){"use strict";n.d(i,{Hg:function(){return useWorkspaceInviteApi},av:function(){return useWorkspaceCreateApi},d1:function(){return useTestWorkspaceUploadApi},hv:function(){return useWorkspaceUpdateApi}});var r=n(11778),useWorkspaceCreateApi=function(e){return(0,r.FF)(["workspaces"],"/api/v1/workspace",e)},useWorkspaceUpdateApi=function(e){return(0,r.yt)(["workspaces"],"/api/v1/workspace",e)},useWorkspaceInviteApi=function(e){return(0,r.FF)(["workspaces","invite"],"/api/v1/workspace/invite",e)},useTestWorkspaceUploadApi=function(){return(0,r.FF)(["workspaces","test-upload"],"/api/v1/workspace/test-cloud-storage")}},18785:function(e,i,n){"use strict";n.r(i),n.d(i,{default:function(){return settings}});var r=n(22598),s=n(90447),t=n(28280),l=n(86738),o=n(73318),a=n(85893),DestroyButton=function(){return(0,a.jsx)(l.Z,{title:"Are you sure?",description:"This action cannot be undone.",placement:"bottomRight",children:(0,a.jsx)(o.ZP,{type:"default",danger:!0,icon:(0,a.jsx)(t.Z,{className:"align-middle"}),children:"Destroy"})})},c=n(50029),d=n(16835),u=n(87794),p=n.n(u),v=n(14364),m=n(78957),g=n(71471),h=n(72269),j=n(67294),x=n(4408),f=n(14829),workspaces_WorkspacePrivacySwitch=function(){var e,i=v.Z.useApp(),n=(0,f.c)(),r=(0,j.useState)(null==n?void 0:n.public),s=r[0],t=r[1],l=(0,x.hv)({filter:{_id:null==n?void 0:n._id}}),o=(0,d.Z)(l,2),u=o[0],Z=o[1],b=(e=(0,c.Z)(p().mark(function _callee(e){var r;return p().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,u({public:e});case 2:null!=(r=s.sent)&&r.status&&(t(e),i.notification.success({message:"Congrats!",description:'Made "'.concat(null==n?void 0:n.name,'" workspace ').concat(e?"PUBLIC":"PRIVATE"," successfully.")}));case 4:case"end":return s.stop()}},_callee)})),function(i){return e.apply(this,arguments)});return(0,a.jsxs)(m.Z,{direction:"horizontal",size:6,children:[(0,a.jsx)(g.Z.Title,{level:5,style:{marginBottom:0},children:"Public"}),(0,a.jsx)(h.Z,{checked:s,onChange:b,loading:"loading"===Z})]})},Z=n(51423),b=n(96074),y=n(2487),k=n(27484),w=n.n(k),_=n(74040),A=n(11778),P=n(95696),I=n(59499),S=n(79090),F=n(8232),W=n(39249),O=n(1604);function ownKeys(e,i){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);i&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function _objectSpread(e){for(var i=1;i<arguments.length;i++){var n=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(n),!0).forEach(function(i){(0,I.Z)(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}O.Ry({enabled:O.O7(),model:O.Z_().optional(),apiBaseUrl:O.Z_().url({message:"Invalid URL format"}).optional(),apiKey:O.Z_().optional()});var WorkspaceAiApiForm=function(){var e,i,n,r,s,t,l,u,m,g,Z=(0,f.c)(),b=v.Z.useApp().message,y=F.Z.useForm(),k=(0,d.Z)(y,1)[0],w=(0,j.useState)(null!==(i=null==Z?void 0:null===(n=Z.settings)||void 0===n?void 0:null===(r=n.ai)||void 0===r?void 0:r.enabled)&&void 0!==i&&i),_=w[0],A=w[1],P=(0,x.hv)({filter:{_id:null==Z?void 0:Z._id},enabled:!!(null!=Z&&Z._id)}),I=(0,d.Z)(P,2),O=I[0],C=I[1],E=(e=(0,c.Z)(p().mark(function _callee(e){return p().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log("WorkspaceAiApiForm > handleSubmit > values :>>",e),i.prev=1,i.next=4,null==O?void 0:O({"settings.ai":_objectSpread(_objectSpread({},e),{},{enabled:_})});case 4:b.success("AI API settings updated successfully"),i.next=11;break;case 7:i.prev=7,i.t0=i.catch(1),console.error(i.t0),b.error("Failed to update AI API settings");case 11:case"end":return i.stop()}},_callee,null,[[1,7]])})),function(i){return e.apply(this,arguments)});return(0,a.jsx)("div",{children:(0,a.jsxs)(F.Z,{form:k,labelCol:{span:8},wrapperCol:{span:16},className:"max-w-xl",onFinish:E,initialValues:{model:null==Z?void 0:null===(s=Z.settings)||void 0===s?void 0:null===(t=s.ai)||void 0===t?void 0:t.model,apiBaseUrl:null==Z?void 0:null===(l=Z.settings)||void 0===l?void 0:null===(u=l.ai)||void 0===u?void 0:u.apiBaseUrl,apiKey:null==Z?void 0:null===(m=Z.settings)||void 0===m?void 0:null===(g=m.ai)||void 0===g?void 0:g.apiKey},children:[(0,a.jsx)(F.Z.Item,{name:"enabled",label:"Enable AI",children:(0,a.jsx)(h.Z,{checked:_,onChange:function(e){return A(e)}})}),(0,a.jsx)(F.Z.Item,{name:"model",label:"AI Model",rules:[function(e){return e.getFieldValue,{validator:function(e,i){return _?i?Promise.resolve():Promise.reject(Error("AI Model is required when enabled")):Promise.resolve()}}}],children:(0,a.jsx)(W.Z,{placeholder:"Enter AI model (e.g., gpt-3.5-turbo)",disabled:!_})}),(0,a.jsx)(F.Z.Item,{name:"apiBaseUrl",label:"API Base URL",rules:[{type:"url",message:"Invalid URL format"},function(e){return e.getFieldValue,{validator:function(e,i){return _?i?Promise.resolve():Promise.reject(Error("API Base URL is required when enabled")):Promise.resolve()}}}],children:(0,a.jsx)(W.Z,{placeholder:"https://api.openai.com/v1",disabled:!_})}),(0,a.jsx)(F.Z.Item,{name:"apiKey",label:"API Key",rules:[function(e){return e.getFieldValue,{validator:function(e,i){return _?i?Promise.resolve():Promise.reject(Error("API Key is required when enabled")):Promise.resolve()}}}],children:(0,a.jsx)(W.Z,{type:"password",placeholder:"Enter your AI API key",disabled:!_})}),(0,a.jsx)(F.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,a.jsx)(o.ZP,{type:"primary",htmlType:"submit",children:"loading"===C?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{})," Saving..."]}):"Save"})})]})})},C=n(65217),E=["cloudflare","aws_s3","do_space","google"],WorkspaceStorageForm=function(){var e,i,n,r,s,t,l,u,m,g,h,Z,b,y,k,w,_,A,P=(0,f.c)(),I=v.Z.useApp().message,O=F.Z.useForm(),K=(0,d.Z)(O,1)[0],U=(0,x.hv)({filter:{_id:null==P?void 0:P._id},enabled:!!(null!=P&&P._id)}),q=(0,d.Z)(U,2),B=q[0],V=q[1],R=(0,x.d1)(),T=(0,d.Z)(R,2);T[0],T[1];var D=(e=(0,c.Z)(p().mark(function _callee(e){return p().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log(e),i.prev=1,i.next=4,null==B?void 0:B({"settings.cloud_storage":e});case 4:I.success("Cloud storage updated successfully"),i.next=11;break;case 7:i.prev=7,i.t0=i.catch(1),console.error(i.t0),I.error("Failed to update cloud storage");case 11:case"end":return i.stop()}},_callee,null,[[1,7]])})),function(i){return e.apply(this,arguments)});return(0,j.useEffect)(function(){},[]),(0,a.jsx)("div",{children:(0,a.jsxs)(F.Z,{form:K,labelCol:{span:8},wrapperCol:{span:16},className:"max-w-xl",onFinish:D,onFinishFailed:function(e){console.log("Failed:",e)},children:[(0,a.jsx)(F.Z.Item,{label:"Cloud Storage",name:"provider",rules:[{required:!0,message:"Cloud Storage is required"}],initialValue:null==P?void 0:null===(i=P.settings)||void 0===i?void 0:null===(n=i.cloud_storage)||void 0===n?void 0:n.provider,children:(0,a.jsx)(C.Z,{options:E.map(function(e){return{label:e,value:e}})})}),(0,a.jsx)(F.Z.Item,{label:"Access Key",name:"accessKey",rules:[{required:!0,message:"Access Key is required"}],initialValue:null==P?void 0:null===(r=P.settings)||void 0===r?void 0:null===(s=r.cloud_storage)||void 0===s?void 0:s.accessKey,children:(0,a.jsx)(W.Z,{type:"password"})}),(0,a.jsx)(F.Z.Item,{label:"Secret Key",name:"secretKey",rules:[{required:!0,message:"Secret Key is required"}],initialValue:null==P?void 0:null===(t=P.settings)||void 0===t?void 0:null===(l=t.cloud_storage)||void 0===l?void 0:l.secretKey,children:(0,a.jsx)(W.Z,{type:"password"})}),(0,a.jsx)(F.Z.Item,{label:"Bucket",name:"bucket",rules:[{required:!0,message:"Bucket is required"}],initialValue:null==P?void 0:null===(u=P.settings)||void 0===u?void 0:null===(m=u.cloud_storage)||void 0===m?void 0:m.bucket,children:(0,a.jsx)(W.Z,{})}),(0,a.jsx)(F.Z.Item,{label:"Region",name:"region",initialValue:null==P?void 0:null===(g=P.settings)||void 0===g?void 0:null===(h=g.cloud_storage)||void 0===h?void 0:h.region,children:(0,a.jsx)(W.Z,{})}),(0,a.jsx)(F.Z.Item,{label:"Origin Endpoint",name:"endpoint",rules:[{required:!0,message:"Origin Endpoint is required"}],initialValue:null==P?void 0:null===(Z=P.settings)||void 0===Z?void 0:null===(b=Z.cloud_storage)||void 0===b?void 0:b.endpoint,children:(0,a.jsx)(W.Z,{})}),(0,a.jsx)(F.Z.Item,{label:"Base URL",name:"baseUrl",rules:[{required:!0,message:"Base URL is required"}],initialValue:null==P?void 0:null===(y=P.settings)||void 0===y?void 0:null===(k=y.cloud_storage)||void 0===k?void 0:k.baseUrl,children:(0,a.jsx)(W.Z,{})}),(0,a.jsx)(F.Z.Item,{label:"Base Path",name:"basePath",initialValue:null!==(w=null==P?void 0:null===(_=P.settings)||void 0===_?void 0:null===(A=_.cloud_storage)||void 0===A?void 0:A.basePath)&&void 0!==w?w:"",children:(0,a.jsx)(W.Z,{})}),(0,a.jsx)(F.Z.Item,{wrapperCol:{offset:8,span:16},children:(0,a.jsx)(o.ZP,{type:"primary",htmlType:"submit",children:"loading"===V?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{})," Saving..."]}):"Save"})})]})})},K=n(56176),U=n(84110);w().extend(U),w().extend(K);var WorkspaceSettings=function(){var e=(0,f.c)(),i=(0,A.wz)(["users","list"],"/api/v1/api_key",void 0).data,n=(i=void 0===i?{list:[]}:i).list,r=void 0===n?[]:n;return(0,_.sc)().data,(0,a.jsxs)("div",{className:"px-4 py-6",children:[(0,a.jsxs)(g.Z.Title,{children:[null==e?void 0:e.name," Workspace"]}),(0,a.jsx)(Z.Z,{title:"DX_KEY",children:(0,a.jsx)("div",{children:(0,a.jsx)(P.Z,{mode:"inline",value:(null==e?void 0:e.dx_key)||""})},"dx-key")}),(0,a.jsx)(b.Z,{dashed:!0}),r.length>0&&(0,a.jsx)(y.Z,{dataSource:r,renderItem:function(e,i){var n=e.name,r=(e.email,e.token),s=(r=void 0===r?{access_token:""}:r).access_token;return(0,a.jsx)(Z.Z,{title:n,children:(0,a.jsx)("div",{children:(0,a.jsx)(P.Z,{type:"password",mode:"inline",value:s})},"api-key-".concat(s))})}}),(0,a.jsx)(b.Z,{dashed:!0}),(0,a.jsx)(Z.Z,{title:"CLOUD STORAGE",children:(0,a.jsx)("div",{children:(0,a.jsx)(WorkspaceStorageForm,{})},"cloud-storage")}),(0,a.jsx)(b.Z,{dashed:!0}),(0,a.jsx)(Z.Z,{title:"AI API",children:(0,a.jsx)("div",{children:(0,a.jsx)(WorkspaceAiApiForm,{})},"ai-api")})]})},q=n(6761),B=n(1071),settings=function(){return(0,a.jsx)(r.Wk,{children:(0,a.jsxs)(q.o,{meta:(0,a.jsx)(B.h,{title:"Settings",description:"Workspace's configuration."}),children:[(0,a.jsx)(s.V,{title:"Workspace Settings",breadcrumbs:[{name:"Workspace"}],actions:[(0,a.jsx)(workspaces_WorkspacePrivacySwitch,{},"workspace-privacy-switch"),(0,a.jsx)(DestroyButton,{},"destroy-workspace-button")]}),(0,a.jsx)(WorkspaceSettings,{})]})})}},14829:function(e,i,n){"use strict";n.d(i,{c:function(){return useWorkspace}});var r=n(16835),s=n(22598),useWorkspace=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=(0,s.aC)(),i=(0,r.Z)(e,1)[0];return null==i?void 0:i.activeWorkspace}},52837:function(e,i,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings",function(){return n(18785)}])}},function(e){e.O(0,[3662,5877,631,3945,9774,2888,179],function(){return e(e.s=52837)}),_N_E=e.O()}]);