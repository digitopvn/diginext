(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3755],{92810:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var n=a(30001),i=a(50959),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M536.1 273H488c-4.4 0-8 3.6-8 8v275.3c0 2.6 1.2 5 3.3 6.5l165.3 120.7c3.6 2.6 8.6 1.9 11.2-1.7l28.6-39c2.7-3.7 1.9-8.7-1.7-11.2L544.1 528.5V281c0-4.4-3.6-8-8-8zm219.8 75.2l156.8 38.3c5 1.2 9.9-2.6 9.9-7.7l.8-161.5c0-6.7-7.7-10.5-12.9-6.3L752.9 334.1a8 8 0 003 14.1zm167.7 301.1l-56.7-19.5a8 8 0 00-10.1 4.8c-1.9 5.1-3.9 10.1-6 15.1-17.8 42.1-43.3 80-75.9 112.5a353 353 0 01-112.5 75.9 352.18 352.18 0 01-137.7 27.8c-47.8 0-94.1-9.3-137.7-27.8a353 353 0 01-112.5-75.9c-32.5-32.5-58-70.4-75.9-112.5A353.44 353.44 0 01171 512c0-47.8 9.3-94.2 27.8-137.8 17.8-42.1 43.3-80 75.9-112.5a353 353 0 01112.5-75.9C430.6 167.3 477 158 524.8 158s94.1 9.3 137.7 27.8A353 353 0 01775 261.7c10.2 10.3 19.8 21 28.6 32.3l59.8-46.8C784.7 146.6 662.2 81.9 524.6 82 285 82.1 92.6 276.7 95 516.4 97.4 751.9 288.9 942 524.8 942c185.5 0 343.5-117.6 403.7-282.3 1.5-4.2-.7-8.9-4.9-10.4z"}}]},name:"history",theme:"outlined"},l=a(94590),c=function(e,t){return i.createElement(l.Z,(0,n.Z)((0,n.Z)({},e),{},{ref:t,icon:s}))};c.displayName="HistoryOutlined";var r=i.forwardRef(c)},28709:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/infrastructure/database",function(){return a(40761)}])},40761:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return L}});var n,i=a(11527),s=a(2154),l=a(58254),c=a(30001),r=a(50959),d={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M945 412H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h256c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM811 548H689c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h122c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM477.3 322.5H434c-6.2 0-11.2 5-11.2 11.2v248c0 3.6 1.7 6.9 4.6 9l148.9 108.6c5 3.6 12 2.6 15.6-2.4l25.7-35.1v-.1c3.6-5 2.5-12-2.5-15.6l-126.7-91.6V333.7c.1-6.2-5-11.2-11.1-11.2z"}},{tag:"path",attrs:{d:"M804.8 673.9H747c-5.6 0-10.9 2.9-13.9 7.7a321 321 0 01-44.5 55.7 317.17 317.17 0 01-101.3 68.3c-39.3 16.6-81 25-124 25-43.1 0-84.8-8.4-124-25-37.9-16-72-39-101.3-68.3s-52.3-63.4-68.3-101.3c-16.6-39.2-25-80.9-25-124 0-43.1 8.4-84.7 25-124 16-37.9 39-72 68.3-101.3 29.3-29.3 63.4-52.3 101.3-68.3 39.2-16.6 81-25 124-25 43.1 0 84.8 8.4 124 25 37.9 16 72 39 101.3 68.3a321 321 0 0144.5 55.7c3 4.8 8.3 7.7 13.9 7.7h57.8c6.9 0 11.3-7.2 8.2-13.3-65.2-129.7-197.4-214-345-215.7-216.1-2.7-395.6 174.2-396 390.1C71.6 727.5 246.9 903 463.2 903c149.5 0 283.9-84.6 349.8-215.8a9.18 9.18 0 00-8.2-13.3z"}}]},name:"field-time",theme:"outlined"},o=a(94590),u=function(e,t){return r.createElement(o.Z,(0,c.Z)((0,c.Z)({},e),{},{ref:t,icon:d}))};u.displayName="FieldTimeOutlined";var h=r.forwardRef(u),x=a(92810),f=a(13740),m=a(78177),p=a(30388),v=a(58699),b=a(85273),k=a(46457),Z=a(5433),g=a(36865),j=a(88158),y=a(61663),w=a(5489),_=a(74637),C=a.n(_),N=a(32699),E=a(64718),A=a(58012),P=a(97591),z=a(49309),O=a(90400),S=a(13557);let T=a(64814),B=a(54498);C().extend(B),C().extend(T);let I=null!==(n=S.XL.tableConfig.defaultPageSize)&&void 0!==n?n:20,H=()=>{let{responsive:e}=(0,O.Jl)(),[t,a]=(0,r.useState)(1),{data:n,status:s}=(0,E.EF)({populate:"owner,autoBackup",pagination:{page:t,size:I}}),{list:c,pagination:d}=n||{},{total_items:o}=d||{},[u]=(0,E.QB)(),[_]=(0,E.Tf)(),[S]=(0,E.ij)(),[T]=(0,E.O2)(),[B,{setQuery:H}]=(0,z.o)(),D=[{title:"Name",width:50,dataIndex:"name",key:"name",render:(e,t)=>(0,i.jsx)(v.ZP,{type:"link",onClick:()=>H({lv1:"edit",type:"database",database:t.slug}),style:{overflowWrap:"break-word",whiteSpace:"pre-wrap",textAlign:"left"},children:e}),fixed:(null==e?void 0:e.md)?"left":void 0,filterSearch:!0,filters:[{text:"goon",value:"goon"}],onFilter:(e,t)=>!t.name||t.name.indexOf(e.toString())>-1},{title:"Type",dataIndex:"type",key:"type",width:20,render:(e,t)=>(0,i.jsx)(b.Z,{children:e})},{title:"Verified",dataIndex:"verified",key:"verified",width:20,render:(e,t)=>t.verified?(0,i.jsx)(b.Z,{color:"success",children:"YES"}):(0,i.jsx)(b.Z,{color:"error",children:"NO"})},{title:"Auto-backup",dataIndex:"auto-backup",key:"auto-backup",width:20,render:(e,t)=>(0,N.isEmpty)(t.autoBackup)?(0,i.jsx)(b.Z,{color:"error",children:"NO"}):t.autoBackup.active?(0,i.jsx)(b.Z,{color:"success",children:"YES"}):(0,i.jsx)(b.Z,{color:"volcano",children:"STOPPED"})},{title:"Created by",dataIndex:"owner",key:"owner",width:30,render:(e,t)=>(0,i.jsx)(i.Fragment,{children:null==t?void 0:t.owner.name})},{title:"Created at",dataIndex:"createdAt",key:"createdAt",width:25,render:e=>(0,i.jsx)(A.q,{date:e}),sorter:(e,t)=>C()(e.createdAt).diff(C()(t.createdAt))},{title:(0,i.jsx)(k.Z.Text,{className:"text-xs md:text-sm",children:"Action"}),key:"action",fixed:"right",width:(null==e?void 0:e.md)?30:26,render:(e,t)=>t.actions}],F=async e=>{e||Z.Z.error({message:"Unable to backup."});let t=await _({_id:e});(null==t?void 0:t.status)&&Z.Z.success({message:"Database has been backed up successfully."})},M=async e=>{e||Z.Z.error({message:"Unable to auto backup."});let t=await T({_id:e});(null==t?void 0:t.status)&&Z.Z.success({message:"Database has been enabled auto-backup."})},L=async e=>{e||Z.Z.error({message:"Unable to delete this item."});let t=await u({_id:e});(null==t?void 0:t.status)&&Z.Z.success({message:"Item deleted successfully."})},R=e=>{let{current:t}=e;t&&a(t)},V=(null==c?void 0:c.map((e,t)=>({...e,actions:(0,i.jsxs)(g.Z.Compact,{children:[(0,i.jsx)(j.Z,{overlay:"Run backup",children:(0,i.jsx)(v.ZP,{icon:(0,i.jsx)(l.Z,{}),onClick:()=>F(null==e?void 0:e._id)})}),(0,i.jsx)(j.Z,{overlay:"Enable auto-backup",children:(0,i.jsx)(v.ZP,{icon:(0,i.jsx)(h,{}),onClick:()=>M(null==e?void 0:e._id)})}),(0,i.jsx)(j.Z,{overlay:"Backup history",children:(0,i.jsx)(v.ZP,{icon:(0,i.jsx)(x.Z,{}),onClick:()=>H({lv1:"db_backups",database:null==e?void 0:e.slug})})}),(0,i.jsx)(y.Z,{title:"Are you sure to delete this item?",description:(0,i.jsx)("span",{className:"text-red-500",children:"Caution: this is permanent and cannot be rolled back."}),onConfirm:()=>L(e._id),okText:"Yes",cancelText:"No",children:(0,i.jsx)(v.ZP,{icon:(0,i.jsx)(f.Z,{})})})]})})))||[],U=(0,r.useRef)(null),W=(0,p.Z)(U);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(P.V,{title:"Databases (".concat(null!=o?o:"-",")"),breadcrumbs:[{name:"Workspace"}],actions:[(0,i.jsx)(v.ZP,{type:"default",icon:(0,i.jsx)(m.Z,{className:"align-middle"}),onClick:()=>H({lv1:"new",type:"database"}),children:"Add"},"workspace-setting-btn")]}),(0,i.jsx)("div",{className:"h-full flex-auto overflow-hidden",ref:U,children:(0,i.jsx)(w.Z,{sticky:!0,size:"small",loading:"loading"===s,columns:D,dataSource:V,scroll:{x:1e3,y:void 0!==(null==W?void 0:W.height)?W.height-140:void 0},pagination:{pageSize:I,total:o,position:["bottomCenter"]},onChange:R})})]})};var D=a(26697),F=a(24810);let M=()=>(0,i.jsx)(s.Wk,{children:(0,i.jsx)(D.o,{meta:(0,i.jsx)(F.h,{title:"Databases",description:"List of cloud databases."}),children:(0,i.jsx)(H,{})})});var L=M}},function(e){e.O(0,[8201,2967,1187,7655,9774,2888,179],function(){return e(e.s=28709)}),_N_E=e.O()}]);