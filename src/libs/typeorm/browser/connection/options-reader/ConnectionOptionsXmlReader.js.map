{"version":3,"sources":["../browser/src/connection/options-reader/ConnectionOptionsXmlReader.ts"],"names":[],"mappings":"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","file":"ConnectionOptionsXmlReader.js","sourcesContent":["import { parseString as xmlParser } from \"xml2js\"\nimport { PlatformTools } from \"../../platform/PlatformTools\"\nimport { DataSourceOptions } from \"../../data-source/DataSourceOptions\"\n\n/**\n * Reads connection options defined in the xml file.\n *\n * @deprecated\n */\nexport class ConnectionOptionsXmlReader {\n    // -------------------------------------------------------------------------\n    // Public Methods\n    // -------------------------------------------------------------------------\n\n    /**\n     * Reads connection options from given xml file.\n     */\n    async read(path: string): Promise<DataSourceOptions[]> {\n        const xml = await this.readXml(path)\n        return (xml.connection as any[]).map((connection) => {\n            return {\n                name: connection.$.name,\n                type: connection.$.type,\n                url: connection.url ? connection.url[0] : undefined,\n                host: connection.host ? connection.host[0] : undefined,\n                port:\n                    connection.port && connection.port[0]\n                        ? parseInt(connection.port[0])\n                        : undefined,\n                username: connection.username\n                    ? connection.username[0]\n                    : undefined,\n                password: connection.password\n                    ? connection.password[0]\n                    : undefined,\n                database: connection.database\n                    ? connection.database[0]\n                    : undefined,\n                sid: connection.sid ? connection.sid[0] : undefined,\n                extra: connection.extra ? connection.extra[0] : undefined,\n                synchronize: connection.synchronize\n                    ? connection.synchronize[0]\n                    : undefined,\n                entities: connection.entities\n                    ? connection.entities[0].entity\n                    : [],\n                subscribers: connection.subscribers\n                    ? connection.subscribers[0].entity\n                    : [],\n                logging: connection.logging[0]\n                    ? connection.logging[0].split(\",\")\n                    : undefined,\n            }\n        })\n    }\n\n    // -------------------------------------------------------------------------\n    // Protected Methods\n    // -------------------------------------------------------------------------\n\n    /**\n     * Reads xml file contents and returns them in a promise.\n     */\n    protected readXml(path: string): Promise<any> {\n        const xmlOptions = { trim: true, explicitRoot: false }\n        return new Promise((ok, fail) => {\n            xmlParser(\n                PlatformTools.readFileSync(path),\n                xmlOptions,\n                (err: any, result: any) => (err ? fail(err) : ok(result)),\n            )\n        })\n    }\n}\n"],"sourceRoot":"../.."}